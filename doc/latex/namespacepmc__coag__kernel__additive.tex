\hypertarget{namespacepmc__coag__kernel__additive}{}\section{pmc\+\_\+coag\+\_\+kernel\+\_\+additive Module Reference}
\label{namespacepmc__coag__kernel__additive}\index{pmc\+\_\+coag\+\_\+kernel\+\_\+additive@{pmc\+\_\+coag\+\_\+kernel\+\_\+additive}}


Additive coagulation kernel.  


\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacepmc__coag__kernel__additive_a104dc134e55b7e9c4271f754feb593c0}{kernel\+\_\+additive}} (aero\+\_\+particle\+\_\+1, aero\+\_\+particle\+\_\+2, aero\+\_\+data, env\+\_\+state, k)
\begin{DoxyCompactList}\small\item\em Additive coagulation kernel. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__coag__kernel__additive_a3dee17def226de61de0ca4074f77c86e}{kernel\+\_\+additive\+\_\+minmax}} (v1, v2, aero\+\_\+data, env\+\_\+state, k\+\_\+min, k\+\_\+max)
\begin{DoxyCompactList}\small\item\em Minimum and maximum values of the additive kernel. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__coag__kernel__additive_a18a49b373123a332e3e5a91c6f88b6b1}{soln\+\_\+additive\+\_\+exp}} (bin\+\_\+grid, aero\+\_\+data, time, num\+\_\+conc, radius\+\_\+at\+\_\+mean\+\_\+vol, env\+\_\+state, aero\+\_\+binned)
\begin{DoxyCompactList}\small\item\em Exact solution with the additive coagulation kernel and exponential initial condition. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__coag__kernel__additive_ad76a37daef190b75b015ac1441f32e17}{bessi1}} (x, r)
\begin{DoxyCompactList}\small\item\em Modified Bessel function of the first kind $ I_1(x) $. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__coag__kernel__additive_a033edc5451a3797e4d922139dd6dad0f}{calci1}} (arg, result, jint)
\begin{DoxyCompactList}\small\item\em Calculates modified Bessel functions of the first kind $ I_1(x) $. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
real(kind=dp), parameter \mbox{\hyperlink{namespacepmc__coag__kernel__additive_a79283f915c3f96c35594e8e701137c15}{beta\+\_\+1}} = 1000d0
\begin{DoxyCompactList}\small\item\em Scaling coefficient for constant kernel. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Additive coagulation kernel. 

\subsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacepmc__coag__kernel__additive_ad76a37daef190b75b015ac1441f32e17}\label{namespacepmc__coag__kernel__additive_ad76a37daef190b75b015ac1441f32e17}} 
\index{pmc\+\_\+coag\+\_\+kernel\+\_\+additive@{pmc\+\_\+coag\+\_\+kernel\+\_\+additive}!bessi1@{bessi1}}
\index{bessi1@{bessi1}!pmc\+\_\+coag\+\_\+kernel\+\_\+additive@{pmc\+\_\+coag\+\_\+kernel\+\_\+additive}}
\subsubsection{\texorpdfstring{bessi1()}{bessi1()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+coag\+\_\+kernel\+\_\+additive\+::bessi1 (\begin{DoxyParamCaption}\item[{real(kind=dp), intent(in)}]{x,  }\item[{real(kind=dp), intent(out)}]{r }\end{DoxyParamCaption})}



Modified Bessel function of the first kind $ I_1(x) $. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em x} & Function argument.\\
\hline
\mbox{\tt out}  & {\em r} & Function value. \\
\hline
\end{DoxyParams}


Definition at line 173 of file coag\+\_\+kernel\+\_\+additive.\+F90.

\mbox{\Hypertarget{namespacepmc__coag__kernel__additive_a033edc5451a3797e4d922139dd6dad0f}\label{namespacepmc__coag__kernel__additive_a033edc5451a3797e4d922139dd6dad0f}} 
\index{pmc\+\_\+coag\+\_\+kernel\+\_\+additive@{pmc\+\_\+coag\+\_\+kernel\+\_\+additive}!calci1@{calci1}}
\index{calci1@{calci1}!pmc\+\_\+coag\+\_\+kernel\+\_\+additive@{pmc\+\_\+coag\+\_\+kernel\+\_\+additive}}
\subsubsection{\texorpdfstring{calci1()}{calci1()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+coag\+\_\+kernel\+\_\+additive\+::calci1 (\begin{DoxyParamCaption}\item[{real ( kind = 8 )}]{arg,  }\item[{real ( kind = 8 )}]{result,  }\item[{integer ( kind = 4 )}]{jint }\end{DoxyParamCaption})}



Calculates modified Bessel functions of the first kind $ I_1(x) $. 



Definition at line 187 of file coag\+\_\+kernel\+\_\+additive.\+F90.

\mbox{\Hypertarget{namespacepmc__coag__kernel__additive_a104dc134e55b7e9c4271f754feb593c0}\label{namespacepmc__coag__kernel__additive_a104dc134e55b7e9c4271f754feb593c0}} 
\index{pmc\+\_\+coag\+\_\+kernel\+\_\+additive@{pmc\+\_\+coag\+\_\+kernel\+\_\+additive}!kernel\+\_\+additive@{kernel\+\_\+additive}}
\index{kernel\+\_\+additive@{kernel\+\_\+additive}!pmc\+\_\+coag\+\_\+kernel\+\_\+additive@{pmc\+\_\+coag\+\_\+kernel\+\_\+additive}}
\subsubsection{\texorpdfstring{kernel\+\_\+additive()}{kernel\_additive()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+coag\+\_\+kernel\+\_\+additive\+::kernel\+\_\+additive (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__particle_1_1aero__particle__t}{aero\+\_\+particle\+\_\+t}}), intent(in)}]{aero\+\_\+particle\+\_\+1,  }\item[{type(\mbox{\hyperlink{structpmc__aero__particle_1_1aero__particle__t}{aero\+\_\+particle\+\_\+t}}), intent(in)}]{aero\+\_\+particle\+\_\+2,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data,  }\item[{type(\mbox{\hyperlink{structpmc__env__state_1_1env__state__t}{env\+\_\+state\+\_\+t}}), intent(in)}]{env\+\_\+state,  }\item[{real(kind=dp), intent(out)}]{k }\end{DoxyParamCaption})}



Additive coagulation kernel. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em aero\+\_\+particle\+\_\+1} & First particle.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+particle\+\_\+2} & Second particle.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\mbox{\tt in}  & {\em env\+\_\+state} & Environment state.\\
\hline
\mbox{\tt out}  & {\em k} & Coagulation kernel. \\
\hline
\end{DoxyParams}


Definition at line 32 of file coag\+\_\+kernel\+\_\+additive.\+F90.

\mbox{\Hypertarget{namespacepmc__coag__kernel__additive_a3dee17def226de61de0ca4074f77c86e}\label{namespacepmc__coag__kernel__additive_a3dee17def226de61de0ca4074f77c86e}} 
\index{pmc\+\_\+coag\+\_\+kernel\+\_\+additive@{pmc\+\_\+coag\+\_\+kernel\+\_\+additive}!kernel\+\_\+additive\+\_\+minmax@{kernel\+\_\+additive\+\_\+minmax}}
\index{kernel\+\_\+additive\+\_\+minmax@{kernel\+\_\+additive\+\_\+minmax}!pmc\+\_\+coag\+\_\+kernel\+\_\+additive@{pmc\+\_\+coag\+\_\+kernel\+\_\+additive}}
\subsubsection{\texorpdfstring{kernel\+\_\+additive\+\_\+minmax()}{kernel\_additive\_minmax()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+coag\+\_\+kernel\+\_\+additive\+::kernel\+\_\+additive\+\_\+minmax (\begin{DoxyParamCaption}\item[{real(kind=dp), intent(in)}]{v1,  }\item[{real(kind=dp), intent(in)}]{v2,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data,  }\item[{type(\mbox{\hyperlink{structpmc__env__state_1_1env__state__t}{env\+\_\+state\+\_\+t}}), intent(in)}]{env\+\_\+state,  }\item[{real(kind=dp), intent(out)}]{k\+\_\+min,  }\item[{real(kind=dp), intent(out)}]{k\+\_\+max }\end{DoxyParamCaption})}



Minimum and maximum values of the additive kernel. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em v1} & Volume of first particle.\\
\hline
\mbox{\tt in}  & {\em v2} & Volume of second particle.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\mbox{\tt in}  & {\em env\+\_\+state} & Environment state.\\
\hline
\mbox{\tt out}  & {\em k\+\_\+min} & Coagulation kernel minimum value.\\
\hline
\mbox{\tt out}  & {\em k\+\_\+max} & Coagulation kernel maximum value. \\
\hline
\end{DoxyParams}


Definition at line 53 of file coag\+\_\+kernel\+\_\+additive.\+F90.

\mbox{\Hypertarget{namespacepmc__coag__kernel__additive_a18a49b373123a332e3e5a91c6f88b6b1}\label{namespacepmc__coag__kernel__additive_a18a49b373123a332e3e5a91c6f88b6b1}} 
\index{pmc\+\_\+coag\+\_\+kernel\+\_\+additive@{pmc\+\_\+coag\+\_\+kernel\+\_\+additive}!soln\+\_\+additive\+\_\+exp@{soln\+\_\+additive\+\_\+exp}}
\index{soln\+\_\+additive\+\_\+exp@{soln\+\_\+additive\+\_\+exp}!pmc\+\_\+coag\+\_\+kernel\+\_\+additive@{pmc\+\_\+coag\+\_\+kernel\+\_\+additive}}
\subsubsection{\texorpdfstring{soln\+\_\+additive\+\_\+exp()}{soln\_additive\_exp()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+coag\+\_\+kernel\+\_\+additive\+::soln\+\_\+additive\+\_\+exp (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__bin__grid_1_1bin__grid__t}{bin\+\_\+grid\+\_\+t}}), intent(in)}]{bin\+\_\+grid,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data,  }\item[{real(kind=dp), intent(in)}]{time,  }\item[{real(kind=dp), intent(in)}]{num\+\_\+conc,  }\item[{real(kind=dp), intent(in)}]{radius\+\_\+at\+\_\+mean\+\_\+vol,  }\item[{type(\mbox{\hyperlink{structpmc__env__state_1_1env__state__t}{env\+\_\+state\+\_\+t}}), intent(in)}]{env\+\_\+state,  }\item[{type(\mbox{\hyperlink{structpmc__aero__binned_1_1aero__binned__t}{aero\+\_\+binned\+\_\+t}}), intent(inout)}]{aero\+\_\+binned }\end{DoxyParamCaption})}



Exact solution with the additive coagulation kernel and exponential initial condition. 

Given input paramaters $R$ and $N_0$ we let the mean volume be $v_\mu = \frac{4\pi}{3} R^3$ and define the rescaled times $\tau = N_0 v_\mu \beta_1 t$ and $T = 1 - e^{-\tau}$, where $\beta_1$ is the fixed kernel scaling parameter. Then the solution is \[ n(D,t) \ {\rm d}\ln D = \frac{\pi}{2} D^3 \frac{N_0}{v} \frac{1 - T}{\sqrt{T}} \exp\left(-(1 + T) \frac{v}{v_\mu}\right) I_1\left(2 \frac{v}{v_\mu} \sqrt{T}\right) {\rm d}\ln D \] where $I_1(x)$ is the \href{http://en.wikipedia.org/wiki/Bessel_function}{\tt modified Bessel function of the first kind} and $v = \frac{\pi}{6} D^3$.

For small $x$ we have $I_1(x) \approx \frac{x}{2}$, so this solution has initial condition \[ n(D,t) \ {\rm d}\ln D = \frac{\pi}{2} D^3 \frac{N_0}{v_\mu} \exp\left(-\frac{v}{v_\mu}\right) {\rm d}\ln D \]


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em bin\+\_\+grid} & Bin grid.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\mbox{\tt in}  & {\em time} & Current time.\\
\hline
\mbox{\tt in}  & {\em num\+\_\+conc} & Particle number concentration (\#/m$^\wedge$3).\\
\hline
\mbox{\tt in}  & {\em radius\+\_\+at\+\_\+mean\+\_\+vol} & Mean init radius (m).\\
\hline
\mbox{\tt in}  & {\em env\+\_\+state} & Environment state.\\
\hline
\mbox{\tt in,out}  & {\em aero\+\_\+binned} & Output state. \\
\hline
\end{DoxyParams}


Definition at line 103 of file coag\+\_\+kernel\+\_\+additive.\+F90.



\subsection{Variable Documentation}
\mbox{\Hypertarget{namespacepmc__coag__kernel__additive_a79283f915c3f96c35594e8e701137c15}\label{namespacepmc__coag__kernel__additive_a79283f915c3f96c35594e8e701137c15}} 
\index{pmc\+\_\+coag\+\_\+kernel\+\_\+additive@{pmc\+\_\+coag\+\_\+kernel\+\_\+additive}!beta\+\_\+1@{beta\+\_\+1}}
\index{beta\+\_\+1@{beta\+\_\+1}!pmc\+\_\+coag\+\_\+kernel\+\_\+additive@{pmc\+\_\+coag\+\_\+kernel\+\_\+additive}}
\subsubsection{\texorpdfstring{beta\+\_\+1}{beta\_1}}
{\footnotesize\ttfamily real(kind=dp), parameter pmc\+\_\+coag\+\_\+kernel\+\_\+additive\+::beta\+\_\+1 = 1000d0}



Scaling coefficient for constant kernel. 



Definition at line 23 of file coag\+\_\+kernel\+\_\+additive.\+F90.

