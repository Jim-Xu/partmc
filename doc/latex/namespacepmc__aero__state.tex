\hypertarget{namespacepmc__aero__state}{}\section{pmc\+\_\+aero\+\_\+state Module Reference}
\label{namespacepmc__aero__state}\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}


The \mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}} structure and assocated subroutines.  


\subsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
type \mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}
\begin{DoxyCompactList}\small\item\em The current collection of aerosol particles. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
elemental integer function \mbox{\hyperlink{namespacepmc__aero__state_a94155bf7fa94e7c3ab722a5a1dacac98}{aero\+\_\+state\+\_\+n\+\_\+part}} (aero\+\_\+state)
\begin{DoxyCompactList}\small\item\em Return the current number of particles. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_ade0790e3c1fbf87ed303a8ab22de32e3}{aero\+\_\+state\+\_\+copy\+\_\+weight}} (aero\+\_\+state\+\_\+from, aero\+\_\+state\+\_\+to)
\begin{DoxyCompactList}\small\item\em Copies weighting information for an {\ttfamily aero\+\_\+state}. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_ae949175272a73f61c851a2ac4a58c712}{aero\+\_\+state\+\_\+set\+\_\+weight}} (aero\+\_\+state, aero\+\_\+data, weight\+\_\+type, exponent)
\begin{DoxyCompactList}\small\item\em Sets the weighting functions for an {\ttfamily aero\+\_\+state}. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_a82d688a836cb8ed88c46dd010247d3c1}{aero\+\_\+state\+\_\+set\+\_\+n\+\_\+part\+\_\+ideal}} (aero\+\_\+state, n\+\_\+part)
\begin{DoxyCompactList}\small\item\em Set the ideal number of particles to the given value. The {\ttfamily aero\+\_\+state\%awa} must be already set correctly. \end{DoxyCompactList}\item 
integer function \mbox{\hyperlink{namespacepmc__aero__state_a070d20781c622419c7823654680595b4}{aero\+\_\+state\+\_\+weight\+\_\+class\+\_\+for\+\_\+source}} (aero\+\_\+state, source)
\begin{DoxyCompactList}\small\item\em Determine the appropriate weight class for a source. \end{DoxyCompactList}\item 
integer function \mbox{\hyperlink{namespacepmc__aero__state_a9bfa000bf19e64be5f1cf5aeebabe535}{aero\+\_\+state\+\_\+total\+\_\+particles}} (aero\+\_\+state, i\+\_\+group, i\+\_\+class)
\begin{DoxyCompactList}\small\item\em Returns the total number of particles in an aerosol distribution. \end{DoxyCompactList}\item 
integer function \mbox{\hyperlink{namespacepmc__aero__state_a38cf96ea2f1a3ee938bda68e93975cae}{aero\+\_\+state\+\_\+total\+\_\+particles\+\_\+all\+\_\+procs}} (aero\+\_\+state, i\+\_\+group, i\+\_\+class)
\begin{DoxyCompactList}\small\item\em Returns the total number of particles across all processes. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_a748f903f70f90956fc02765c46f5e541}{aero\+\_\+state\+\_\+zero}} (aero\+\_\+state)
\begin{DoxyCompactList}\small\item\em Resets an aero\+\_\+state to have zero particles per bin. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_a473f49b7a4680623facd70a44576b7e8}{aero\+\_\+state\+\_\+add\+\_\+particle}} (aero\+\_\+state, aero\+\_\+particle, aero\+\_\+data, allow\+\_\+resort)
\begin{DoxyCompactList}\small\item\em Add the given particle. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_a87d926e9b2ca5930053d449d771efcee}{aero\+\_\+state\+\_\+remove\+\_\+particle\+\_\+no\+\_\+info}} (aero\+\_\+state, i\+\_\+part)
\begin{DoxyCompactList}\small\item\em Remove the given particle without recording it. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_ad28b72502e5bb9caa40eac383d9bb22e}{aero\+\_\+state\+\_\+remove\+\_\+particle\+\_\+with\+\_\+info}} (aero\+\_\+state, i\+\_\+part, aero\+\_\+info)
\begin{DoxyCompactList}\small\item\em Remove the given particle and record the removal. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_ac19bda6a4cd1c2a3ea9f6cadf9dc9bb6}{aero\+\_\+state\+\_\+remove\+\_\+particle}} (aero\+\_\+state, i\+\_\+part, record\+\_\+removal, aero\+\_\+info)
\begin{DoxyCompactList}\small\item\em Remove the given particle and possibly record the removal. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_aabf1b375475462cc54740039ad556a83}{aero\+\_\+state\+\_\+remove\+\_\+rand\+\_\+particle\+\_\+from\+\_\+bin}} (aero\+\_\+state, i\+\_\+bin, i\+\_\+class, aero\+\_\+particle)
\begin{DoxyCompactList}\small\item\em Remove a randomly chosen particle from the given bin and return it. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_a4f965b4eaeeec1b01e2299016a3680cf}{aero\+\_\+state\+\_\+dup\+\_\+particle}} (aero\+\_\+state, aero\+\_\+data, i\+\_\+part, n\+\_\+part\+\_\+mean, random\+\_\+weight\+\_\+group)
\begin{DoxyCompactList}\small\item\em Add copies or remove a particle, with a given mean number of resulting particles. \end{DoxyCompactList}\item 
real(kind=dp) function \mbox{\hyperlink{namespacepmc__aero__state_a6e14396858e4011e0b36ebc5cd653bc2}{aero\+\_\+state\+\_\+particle\+\_\+num\+\_\+conc}} (aero\+\_\+state, aero\+\_\+particle, aero\+\_\+data)
\begin{DoxyCompactList}\small\item\em The number concentration of a single particle (m$^\wedge$\{-\/3\}). \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_a08e7e95e0c08167046e3238693096dee}{aero\+\_\+state\+\_\+num\+\_\+conc\+\_\+for\+\_\+reweight}} (aero\+\_\+state, aero\+\_\+data, reweight\+\_\+num\+\_\+conc)
\begin{DoxyCompactList}\small\item\em Save the correct number concentrations for later use by \mbox{\hyperlink{namespacepmc__aero__state_a38c69c82e0dbc601557ff505d0513ba6}{aero\+\_\+state\+\_\+reweight()}}. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_a38c69c82e0dbc601557ff505d0513ba6}{aero\+\_\+state\+\_\+reweight}} (aero\+\_\+state, aero\+\_\+data, reweight\+\_\+num\+\_\+conc)
\begin{DoxyCompactList}\small\item\em Reweight all particles after their constituent volumes have been altered. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_ad9c12bba90caa58b86882ebfe4a4335c}{aero\+\_\+state\+\_\+add}} (aero\+\_\+state, aero\+\_\+state\+\_\+delta, aero\+\_\+data)
\begin{DoxyCompactList}\small\item\em {\ttfamily aero\+\_\+state += aero\+\_\+state\+\_\+delta}, including combining the weights, so the new concentration is the weighted average of the two concentrations. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_a9960460ba28e89f4f253dcbdb482fff7}{aero\+\_\+state\+\_\+add\+\_\+particles}} (aero\+\_\+state, aero\+\_\+state\+\_\+delta, aero\+\_\+data)
\begin{DoxyCompactList}\small\item\em {\ttfamily aero\+\_\+state += aero\+\_\+state\+\_\+delta}, with the weight of {\ttfamily aero\+\_\+state} left unchanged, so the new concentration is the sum of the two concentrations, computed with {\ttfamily aero\+\_\+state\%awa}. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_af3652445ddd2485a544cc426b3248481}{aero\+\_\+state\+\_\+prepare\+\_\+weight\+\_\+for\+\_\+add}} (aero\+\_\+state, aero\+\_\+data, i\+\_\+group, i\+\_\+class, n\+\_\+add, allow\+\_\+doubling, allow\+\_\+halving)
\begin{DoxyCompactList}\small\item\em Change the weight if necessary to ensure that the addition of about {\ttfamily n\+\_\+add} computational particles will give the correct final particle number. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_a28368fd18fc170709b6809de1930037d}{aero\+\_\+state\+\_\+add\+\_\+aero\+\_\+dist\+\_\+sample}} (aero\+\_\+state, aero\+\_\+data, aero\+\_\+dist, sample\+\_\+prop, create\+\_\+time, allow\+\_\+doubling, allow\+\_\+halving, n\+\_\+part\+\_\+add)
\begin{DoxyCompactList}\small\item\em Generates a Poisson sample of an {\ttfamily aero\+\_\+dist}, adding to {\ttfamily aero\+\_\+state}, with the given sample proportion. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_ab4369f9cfc8e1fdc80c6cd2aced773c9}{aero\+\_\+state\+\_\+rand\+\_\+particle}} (aero\+\_\+state, i\+\_\+part)
\begin{DoxyCompactList}\small\item\em Choose a random particle from the aero\+\_\+state. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_a45e47d79732741df0dacf15d65d7b4a7}{aero\+\_\+state\+\_\+sample\+\_\+particles}} (aero\+\_\+state\+\_\+from, aero\+\_\+state\+\_\+to, aero\+\_\+data, sample\+\_\+prob, removal\+\_\+action)
\begin{DoxyCompactList}\small\item\em Generates a random sample by removing particles from aero\+\_\+state\+\_\+from and adding them to aero\+\_\+state\+\_\+to, which must be already allocated (and should have its weight set). \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_a1ccf923e3212b8800371ebd59156ff8f}{aero\+\_\+state\+\_\+sample}} (aero\+\_\+state\+\_\+from, aero\+\_\+state\+\_\+to, aero\+\_\+data, sample\+\_\+prob, removal\+\_\+action)
\begin{DoxyCompactList}\small\item\em Generates a random sample by removing particles from aero\+\_\+state\+\_\+from and adding them to aero\+\_\+state\+\_\+to, transfering weight as well. This is the equivalent of \mbox{\hyperlink{namespacepmc__aero__state_ad9c12bba90caa58b86882ebfe4a4335c}{aero\+\_\+state\+\_\+add()}}. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_a5535ba7076130a468b1b71a36b64e408}{aero\+\_\+state\+\_\+to\+\_\+binned}} (bin\+\_\+grid, aero\+\_\+data, aero\+\_\+state, aero\+\_\+binned)
\begin{DoxyCompactList}\small\item\em Create binned number and mass arrays. \end{DoxyCompactList}\item 
integer function, dimension(\mbox{\hyperlink{namespacepmc__aero__state_a94155bf7fa94e7c3ab722a5a1dacac98}{aero\+\_\+state\+\_\+n\+\_\+part}}(aero\+\_\+state)) \mbox{\hyperlink{namespacepmc__aero__state_a4c0671e83504e6bd71735b876c78ec2f}{aero\+\_\+state\+\_\+ids}} (aero\+\_\+state)
\begin{DoxyCompactList}\small\item\em Returns the I\+Ds of all particles. \end{DoxyCompactList}\item 
real(kind=dp) function, dimension(\mbox{\hyperlink{namespacepmc__aero__state_a94155bf7fa94e7c3ab722a5a1dacac98}{aero\+\_\+state\+\_\+n\+\_\+part}}(aero\+\_\+state)) \mbox{\hyperlink{namespacepmc__aero__state_a95c9f58cc1ce505a24fe1cb88eef1918}{aero\+\_\+state\+\_\+diameters}} (aero\+\_\+state, aero\+\_\+data)
\begin{DoxyCompactList}\small\item\em Returns the diameters of all particles. \end{DoxyCompactList}\item 
real(kind=dp) function, dimension(\mbox{\hyperlink{namespacepmc__aero__state_a94155bf7fa94e7c3ab722a5a1dacac98}{aero\+\_\+state\+\_\+n\+\_\+part}}(aero\+\_\+state)) \mbox{\hyperlink{namespacepmc__aero__state_a575abf5653d2e972e8eb66a7a30ab187}{aero\+\_\+state\+\_\+dry\+\_\+diameters}} (aero\+\_\+state, aero\+\_\+data)
\begin{DoxyCompactList}\small\item\em Returns the dry diameters of all particles. \end{DoxyCompactList}\item 
real(kind=dp) function, dimension( \mbox{\hyperlink{namespacepmc__aero__state_a94155bf7fa94e7c3ab722a5a1dacac98}{aero\+\_\+state\+\_\+n\+\_\+part}}(aero\+\_\+state)) \mbox{\hyperlink{namespacepmc__aero__state_a5ddd78918027552f0815529f4c0128fb}{aero\+\_\+state\+\_\+mobility\+\_\+diameters}} (aero\+\_\+state, aero\+\_\+data, env\+\_\+state)
\begin{DoxyCompactList}\small\item\em Returns the mobility diameters of all particles. \end{DoxyCompactList}\item 
real(kind=dp) function, dimension(\mbox{\hyperlink{namespacepmc__aero__state_a94155bf7fa94e7c3ab722a5a1dacac98}{aero\+\_\+state\+\_\+n\+\_\+part}}(aero\+\_\+state)) \mbox{\hyperlink{namespacepmc__aero__state_a94804b9cdd9effc574cfb0cc178f329b}{aero\+\_\+state\+\_\+volumes}} (aero\+\_\+state, aero\+\_\+data, include, exclude)
\begin{DoxyCompactList}\small\item\em Returns the volumes of all particles. \end{DoxyCompactList}\item 
real(kind=dp) function, dimension(\mbox{\hyperlink{namespacepmc__aero__state_a94155bf7fa94e7c3ab722a5a1dacac98}{aero\+\_\+state\+\_\+n\+\_\+part}}(aero\+\_\+state)) \mbox{\hyperlink{namespacepmc__aero__state_ae9fa229a50576c4bce900bcb21c4e73c}{aero\+\_\+state\+\_\+masses}} (aero\+\_\+state, aero\+\_\+data, include, exclude)
\begin{DoxyCompactList}\small\item\em Returns the masses of all particles. \end{DoxyCompactList}\item 
real(kind=dp) function, dimension(\mbox{\hyperlink{namespacepmc__aero__state_a94155bf7fa94e7c3ab722a5a1dacac98}{aero\+\_\+state\+\_\+n\+\_\+part}}(aero\+\_\+state)) \mbox{\hyperlink{namespacepmc__aero__state_a31dd92148979397fc0b7bc5fd056a064}{aero\+\_\+state\+\_\+num\+\_\+concs}} (aero\+\_\+state, aero\+\_\+data)
\begin{DoxyCompactList}\small\item\em Returns the number concentrations of all particles. \end{DoxyCompactList}\item 
real(kind=dp) function \mbox{\hyperlink{namespacepmc__aero__state_a6e7b882b542eb7dd907ec490ea45c29b}{aero\+\_\+state\+\_\+total\+\_\+num\+\_\+conc}} (aero\+\_\+state, aero\+\_\+data)
\begin{DoxyCompactList}\small\item\em Returns the total number concentration. \end{DoxyCompactList}\item 
real(kind=dp) function, dimension(\mbox{\hyperlink{namespacepmc__aero__state_a94155bf7fa94e7c3ab722a5a1dacac98}{aero\+\_\+state\+\_\+n\+\_\+part}}(aero\+\_\+state)) \mbox{\hyperlink{namespacepmc__aero__state_a0bf5046e0ca5be2e39b436d6c7b3a4cb}{aero\+\_\+state\+\_\+mass\+\_\+entropies}} (aero\+\_\+state, aero\+\_\+data, include, exclude, group)
\begin{DoxyCompactList}\small\item\em Returns the mass-\/entropies of all particles. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_a370d03980bec87029d569a9b9116740d}{aero\+\_\+state\+\_\+mixing\+\_\+state\+\_\+metrics}} (aero\+\_\+state, aero\+\_\+data, d\+\_\+alpha, d\+\_\+gamma, chi, include, exclude, group)
\begin{DoxyCompactList}\small\item\em Returns the mixing state metrics of the population. \end{DoxyCompactList}\item 
real(kind=dp) function, dimension(\mbox{\hyperlink{namespacepmc__aero__state_a94155bf7fa94e7c3ab722a5a1dacac98}{aero\+\_\+state\+\_\+n\+\_\+part}}(aero\+\_\+state)) \mbox{\hyperlink{namespacepmc__aero__state_a24a909f4a78590222a3d1f940e2e6863}{aero\+\_\+state\+\_\+approx\+\_\+crit\+\_\+rel\+\_\+humids}} (aero\+\_\+state, aero\+\_\+data, env\+\_\+state)
\begin{DoxyCompactList}\small\item\em Returns the approximate critical relative humidity for all particles (1). \end{DoxyCompactList}\item 
real(kind=dp) function, dimension(\mbox{\hyperlink{namespacepmc__aero__state_a94155bf7fa94e7c3ab722a5a1dacac98}{aero\+\_\+state\+\_\+n\+\_\+part}}(aero\+\_\+state)) \mbox{\hyperlink{namespacepmc__aero__state_a1618326e97d290803c642af677073d9c}{aero\+\_\+state\+\_\+crit\+\_\+rel\+\_\+humids}} (aero\+\_\+state, aero\+\_\+data, env\+\_\+state)
\begin{DoxyCompactList}\small\item\em Returns the critical relative humidity for all particles (1). \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_a9618d3e95a4e97e71b154586a2c8bc25}{aero\+\_\+state\+\_\+to\+\_\+binned\+\_\+dry}} (bin\+\_\+grid, aero\+\_\+data, aero\+\_\+state, aero\+\_\+binned)
\begin{DoxyCompactList}\small\item\em Does the same thing as aero\+\_\+state\+\_\+to\+\_\+bin() but based on dry radius. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_a061271c7cf7c3592bb385c1b7bfbedfc}{aero\+\_\+state\+\_\+double}} (aero\+\_\+state, aero\+\_\+data, i\+\_\+group, i\+\_\+class)
\begin{DoxyCompactList}\small\item\em Doubles number of particles in the given weight group. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_ac5109f61fd1f0631a218a410154da5c1}{aero\+\_\+state\+\_\+halve}} (aero\+\_\+state, i\+\_\+group, i\+\_\+class)
\begin{DoxyCompactList}\small\item\em Remove approximately half of the particles in the given weight group. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_a166b2bd2407e5342dd3c5a45b0ba421e}{aero\+\_\+state\+\_\+rebalance}} (aero\+\_\+state, aero\+\_\+data, allow\+\_\+doubling, allow\+\_\+halving, initial\+\_\+state\+\_\+warning)
\begin{DoxyCompactList}\small\item\em Double or halve the particle population in each weight group to maintain close to {\ttfamily n\+\_\+part\+\_\+ideal} particles per process, allocated equally amongst the weight groups. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_ac4ca03b5c8c9684e8442edc2df12a020}{aero\+\_\+state\+\_\+scale\+\_\+weight}} (aero\+\_\+state, aero\+\_\+data, i\+\_\+group, i\+\_\+class, weight\+\_\+ratio, allow\+\_\+doubling, allow\+\_\+halving)
\begin{DoxyCompactList}\small\item\em Scale the weighting of the given group/class by the given ratio, altering particle number as necessary to preserve the number concentration. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_a3c40aa98c11c8dfe6e662f2bbd8672e9}{aero\+\_\+state\+\_\+mix}} (aero\+\_\+state, del\+\_\+t, mix\+\_\+timescale, aero\+\_\+data, specify\+\_\+prob\+\_\+transfer)
\begin{DoxyCompactList}\small\item\em Mix the aero\+\_\+states between all processes. Currently uses a simple all-\/to-\/all diffusion. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_ae546d85939653c1b2c7d52121d5f2bc6}{aero\+\_\+state\+\_\+mpi\+\_\+alltoall}} (send, recv)
\begin{DoxyCompactList}\small\item\em Do an M\+PI all-\/to-\/all transfer of aerosol states. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_ab056de58c6dda08da7f81ef695326c89}{aero\+\_\+state\+\_\+bin\+\_\+average\+\_\+comp}} (aero\+\_\+state, bin\+\_\+grid, aero\+\_\+data)
\begin{DoxyCompactList}\small\item\em Set each aerosol particle to have its original total volume, but species volume ratios given by the total species volume ratio within each bin. This preserves the (weighted) total species volume per bin as well as per-\/particle total volumes. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_a3a54c3ceabc9c8f2bb878555a6b4c98a}{aero\+\_\+state\+\_\+bin\+\_\+average\+\_\+size}} (aero\+\_\+state, bin\+\_\+grid, aero\+\_\+data, bin\+\_\+center, preserve\+\_\+number)
\begin{DoxyCompactList}\small\item\em Set each aerosol particle to have its original species ratios, but total volume given by the average volume of all particles within each bin. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_a7e64dc08790a4600076982a43fe76221}{aero\+\_\+state\+\_\+make\+\_\+dry}} (aero\+\_\+state, aero\+\_\+data)
\begin{DoxyCompactList}\small\item\em Make all particles dry (water set to zero). \end{DoxyCompactList}\item 
integer function \mbox{\hyperlink{namespacepmc__aero__state_a9f65a578f1f08ed22c56a96686743cfd}{pmc\+\_\+mpi\+\_\+pack\+\_\+size\+\_\+aero\+\_\+state}} (val)
\begin{DoxyCompactList}\small\item\em Determines the number of bytes required to pack the given value. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_a4123bbc6bc887c5d4b7a6feae25be534}{pmc\+\_\+mpi\+\_\+pack\+\_\+aero\+\_\+state}} (buffer, position, val)
\begin{DoxyCompactList}\small\item\em Packs the given value into the buffer, advancing position. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_a1fbfce661ac4cf88b383e88a44e0a9b6}{pmc\+\_\+mpi\+\_\+unpack\+\_\+aero\+\_\+state}} (buffer, position, val)
\begin{DoxyCompactList}\small\item\em Unpacks the given value from the buffer, advancing position. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_ac8b1291fc517ab1d3ffe9642ab577c6c}{aero\+\_\+state\+\_\+mpi\+\_\+gather}} (aero\+\_\+state, aero\+\_\+state\+\_\+total, aero\+\_\+data)
\begin{DoxyCompactList}\small\item\em Gathers data from all processes into one aero\+\_\+state on process 0. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_acb748f0c0c6c37180e896af05acb1c19}{aero\+\_\+state\+\_\+netcdf\+\_\+dim\+\_\+aero\+\_\+particle}} (aero\+\_\+state, \mbox{\hyperlink{fractal_8_f90_a4e89f3f850921ff84a6dfce8b166ad50}{ncid}}, dimid\+\_\+aero\+\_\+particle)
\begin{DoxyCompactList}\small\item\em Write the aero particle dimension to the given Net\+C\+DF file if it is not already present and in any case return the associated dimid. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_a7d32f436e51ba2ff96838b47e2169585}{aero\+\_\+state\+\_\+netcdf\+\_\+dim\+\_\+aero\+\_\+removed}} (aero\+\_\+state, \mbox{\hyperlink{fractal_8_f90_a4e89f3f850921ff84a6dfce8b166ad50}{ncid}}, dimid\+\_\+aero\+\_\+removed)
\begin{DoxyCompactList}\small\item\em Write the aero removed dimension to the given Net\+C\+DF file if it is not already present and in any case return the associated dimid. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_a2118eb683c0dc350e8f48a59ea8ed8ce}{aero\+\_\+state\+\_\+input\+\_\+netcdf}} (aero\+\_\+state, \mbox{\hyperlink{fractal_8_f90_a4e89f3f850921ff84a6dfce8b166ad50}{ncid}}, aero\+\_\+data)
\begin{DoxyCompactList}\small\item\em Read full state. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_a6626b0ca62809bfeb3137aba559963d1}{aero\+\_\+state\+\_\+sort}} (aero\+\_\+state, aero\+\_\+data, bin\+\_\+grid, all\+\_\+procs\+\_\+same)
\begin{DoxyCompactList}\small\item\em Sorts the particles if necessary. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__state_a9ce29f42aed338fe38218ecc4bbfa158}{aero\+\_\+state\+\_\+check}} (aero\+\_\+state, aero\+\_\+data)
\begin{DoxyCompactList}\small\item\em Check that aerosol state data is consistent. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
integer, parameter \mbox{\hyperlink{namespacepmc__aero__state_a585d061ace6ecfefa6eaadeb8efbeb5d}{aero\+\_\+state\+\_\+tag\+\_\+mix}} = 4987
\begin{DoxyCompactList}\small\item\em M\+PI tag for mixing particles between processes. \end{DoxyCompactList}\item 
integer, parameter \mbox{\hyperlink{namespacepmc__aero__state_a8016b38f6c38806de95b72ffaecbe212}{aero\+\_\+state\+\_\+tag\+\_\+gather}} = 4988
\begin{DoxyCompactList}\small\item\em M\+PI tag for gathering between processes. \end{DoxyCompactList}\item 
integer, parameter \mbox{\hyperlink{namespacepmc__aero__state_a47a81bec0174512abf54faf2673da5c3}{aero\+\_\+state\+\_\+tag\+\_\+scatter}} = 4989
\begin{DoxyCompactList}\small\item\em M\+PI tag for scattering between processes. \end{DoxyCompactList}\item 
integer, parameter \mbox{\hyperlink{namespacepmc__aero__state_afae976ee50ab7c0415628dd99a6feded}{aero\+\_\+state\+\_\+weight\+\_\+none}} = 1
\begin{DoxyCompactList}\small\item\em Single flat weighting scheme. \end{DoxyCompactList}\item 
integer, parameter \mbox{\hyperlink{namespacepmc__aero__state_a72b0c9b3118a486936fe3c50c4d908f6}{aero\+\_\+state\+\_\+weight\+\_\+flat}} = 2
\begin{DoxyCompactList}\small\item\em Single flat weighting scheme. \end{DoxyCompactList}\item 
integer, parameter \mbox{\hyperlink{namespacepmc__aero__state_a2c80e8cba61697786d2302e44cd041bd}{aero\+\_\+state\+\_\+weight\+\_\+power}} = 3
\begin{DoxyCompactList}\small\item\em Power-\/law weighting scheme. \end{DoxyCompactList}\item 
integer, parameter \mbox{\hyperlink{namespacepmc__aero__state_aa014d0549b2455e245bef4959b781af3}{aero\+\_\+state\+\_\+weight\+\_\+nummass}} = 4
\begin{DoxyCompactList}\small\item\em Coupled number/mass weighting scheme. \end{DoxyCompactList}\item 
integer, parameter \mbox{\hyperlink{namespacepmc__aero__state_af731fa16fa6f5f7dcb5dde7bc5118b5a}{aero\+\_\+state\+\_\+weight\+\_\+flat\+\_\+source}} = 5
\begin{DoxyCompactList}\small\item\em Flat weighting by source. \end{DoxyCompactList}\item 
integer, parameter \mbox{\hyperlink{namespacepmc__aero__state_a496284ecee4a72a18a45e67f5c17e610}{aero\+\_\+state\+\_\+weight\+\_\+power\+\_\+source}} = 6
\begin{DoxyCompactList}\small\item\em Power-\/law weighting by source. \end{DoxyCompactList}\item 
integer, parameter \mbox{\hyperlink{namespacepmc__aero__state_a22b883c1a2ba3797a44ab2a4104c9d2a}{aero\+\_\+state\+\_\+weight\+\_\+nummass\+\_\+source}} = 7
\begin{DoxyCompactList}\small\item\em Coupled number/mass weighting by source. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
The \mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}} structure and assocated subroutines. 

\subsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacepmc__aero__state_ad9c12bba90caa58b86882ebfe4a4335c}\label{namespacepmc__aero__state_ad9c12bba90caa58b86882ebfe4a4335c}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+add@{aero\+\_\+state\+\_\+add}}
\index{aero\+\_\+state\+\_\+add@{aero\+\_\+state\+\_\+add}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+add()}{aero\_state\_add()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+add (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(inout)}]{aero\+\_\+state,  }\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(in)}]{aero\+\_\+state\+\_\+delta,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data }\end{DoxyParamCaption})}



{\ttfamily aero\+\_\+state += aero\+\_\+state\+\_\+delta}, including combining the weights, so the new concentration is the weighted average of the two concentrations. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em aero\+\_\+state} & Aerosol state.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+state\+\_\+delta} & Increment.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data. \\
\hline
\end{DoxyParams}


Definition at line 625 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a28368fd18fc170709b6809de1930037d}\label{namespacepmc__aero__state_a28368fd18fc170709b6809de1930037d}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+add\+\_\+aero\+\_\+dist\+\_\+sample@{aero\+\_\+state\+\_\+add\+\_\+aero\+\_\+dist\+\_\+sample}}
\index{aero\+\_\+state\+\_\+add\+\_\+aero\+\_\+dist\+\_\+sample@{aero\+\_\+state\+\_\+add\+\_\+aero\+\_\+dist\+\_\+sample}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+add\+\_\+aero\+\_\+dist\+\_\+sample()}{aero\_state\_add\_aero\_dist\_sample()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+add\+\_\+aero\+\_\+dist\+\_\+sample (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(inout)}]{aero\+\_\+state,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data,  }\item[{type(\mbox{\hyperlink{structpmc__aero__dist_1_1aero__dist__t}{aero\+\_\+dist\+\_\+t}}), intent(in)}]{aero\+\_\+dist,  }\item[{real(kind=dp), intent(in)}]{sample\+\_\+prop,  }\item[{real(kind=dp), intent(in)}]{create\+\_\+time,  }\item[{logical, intent(in)}]{allow\+\_\+doubling,  }\item[{logical, intent(in)}]{allow\+\_\+halving,  }\item[{integer, intent(out), optional}]{n\+\_\+part\+\_\+add }\end{DoxyParamCaption})}



Generates a Poisson sample of an {\ttfamily aero\+\_\+dist}, adding to {\ttfamily aero\+\_\+state}, with the given sample proportion. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em aero\+\_\+state} & Aero state to add to.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aero data values.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+dist} & Distribution to sample.\\
\hline
\mbox{\tt in}  & {\em sample\+\_\+prop} & Fraction to sample (1).\\
\hline
\mbox{\tt in}  & {\em create\+\_\+time} & Creation time for new particles (s).\\
\hline
\mbox{\tt in}  & {\em allow\+\_\+doubling} & Whether to allow doubling of the population.\\
\hline
\mbox{\tt in}  & {\em allow\+\_\+halving} & Whether to allow halving of the population.\\
\hline
\mbox{\tt out}  & {\em n\+\_\+part\+\_\+add} & Number of particles added. \\
\hline
\end{DoxyParams}


Definition at line 716 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a473f49b7a4680623facd70a44576b7e8}\label{namespacepmc__aero__state_a473f49b7a4680623facd70a44576b7e8}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+add\+\_\+particle@{aero\+\_\+state\+\_\+add\+\_\+particle}}
\index{aero\+\_\+state\+\_\+add\+\_\+particle@{aero\+\_\+state\+\_\+add\+\_\+particle}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+add\+\_\+particle()}{aero\_state\_add\_particle()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+add\+\_\+particle (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(inout)}]{aero\+\_\+state,  }\item[{type(\mbox{\hyperlink{structpmc__aero__particle_1_1aero__particle__t}{aero\+\_\+particle\+\_\+t}}), intent(in)}]{aero\+\_\+particle,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data,  }\item[{logical, intent(in), optional}]{allow\+\_\+resort }\end{DoxyParamCaption})}



Add the given particle. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em aero\+\_\+state} & Aerosol state.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+particle} & Particle to add.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\mbox{\tt in}  & {\em allow\+\_\+resort} & Whether to allow a resort due to the add. \\
\hline
\end{DoxyParams}


Definition at line 337 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a9960460ba28e89f4f253dcbdb482fff7}\label{namespacepmc__aero__state_a9960460ba28e89f4f253dcbdb482fff7}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+add\+\_\+particles@{aero\+\_\+state\+\_\+add\+\_\+particles}}
\index{aero\+\_\+state\+\_\+add\+\_\+particles@{aero\+\_\+state\+\_\+add\+\_\+particles}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+add\+\_\+particles()}{aero\_state\_add\_particles()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+add\+\_\+particles (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(inout)}]{aero\+\_\+state,  }\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(in)}]{aero\+\_\+state\+\_\+delta,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data }\end{DoxyParamCaption})}



{\ttfamily aero\+\_\+state += aero\+\_\+state\+\_\+delta}, with the weight of {\ttfamily aero\+\_\+state} left unchanged, so the new concentration is the sum of the two concentrations, computed with {\ttfamily aero\+\_\+state\%awa}. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em aero\+\_\+state} & Aerosol state.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+state\+\_\+delta} & Increment.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data. \\
\hline
\end{DoxyParams}


Definition at line 644 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a24a909f4a78590222a3d1f940e2e6863}\label{namespacepmc__aero__state_a24a909f4a78590222a3d1f940e2e6863}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+approx\+\_\+crit\+\_\+rel\+\_\+humids@{aero\+\_\+state\+\_\+approx\+\_\+crit\+\_\+rel\+\_\+humids}}
\index{aero\+\_\+state\+\_\+approx\+\_\+crit\+\_\+rel\+\_\+humids@{aero\+\_\+state\+\_\+approx\+\_\+crit\+\_\+rel\+\_\+humids}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+approx\+\_\+crit\+\_\+rel\+\_\+humids()}{aero\_state\_approx\_crit\_rel\_humids()}}
{\footnotesize\ttfamily real(kind=dp) function, dimension(\mbox{\hyperlink{namespacepmc__aero__state_a94155bf7fa94e7c3ab722a5a1dacac98}{aero\+\_\+state\+\_\+n\+\_\+part}}(aero\+\_\+state)) pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+approx\+\_\+crit\+\_\+rel\+\_\+humids (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(in)}]{aero\+\_\+state,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data,  }\item[{type(\mbox{\hyperlink{structpmc__env__state_1_1env__state__t}{env\+\_\+state\+\_\+t}}), intent(in)}]{env\+\_\+state }\end{DoxyParamCaption})}



Returns the approximate critical relative humidity for all particles (1). 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em aero\+\_\+state} & Aerosol state.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\mbox{\tt in}  & {\em env\+\_\+state} & Environment state.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Return value. 
\end{DoxyReturn}


Definition at line 1381 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_ab056de58c6dda08da7f81ef695326c89}\label{namespacepmc__aero__state_ab056de58c6dda08da7f81ef695326c89}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+bin\+\_\+average\+\_\+comp@{aero\+\_\+state\+\_\+bin\+\_\+average\+\_\+comp}}
\index{aero\+\_\+state\+\_\+bin\+\_\+average\+\_\+comp@{aero\+\_\+state\+\_\+bin\+\_\+average\+\_\+comp}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+bin\+\_\+average\+\_\+comp()}{aero\_state\_bin\_average\_comp()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+bin\+\_\+average\+\_\+comp (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(inout)}]{aero\+\_\+state,  }\item[{type(\mbox{\hyperlink{structpmc__bin__grid_1_1bin__grid__t}{bin\+\_\+grid\+\_\+t}}), intent(in)}]{bin\+\_\+grid,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data }\end{DoxyParamCaption})}



Set each aerosol particle to have its original total volume, but species volume ratios given by the total species volume ratio within each bin. This preserves the (weighted) total species volume per bin as well as per-\/particle total volumes. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em aero\+\_\+state} & Aerosol state to average.\\
\hline
\mbox{\tt in}  & {\em bin\+\_\+grid} & Bin grid to average within.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data. \\
\hline
\end{DoxyParams}


Definition at line 1820 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a3a54c3ceabc9c8f2bb878555a6b4c98a}\label{namespacepmc__aero__state_a3a54c3ceabc9c8f2bb878555a6b4c98a}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+bin\+\_\+average\+\_\+size@{aero\+\_\+state\+\_\+bin\+\_\+average\+\_\+size}}
\index{aero\+\_\+state\+\_\+bin\+\_\+average\+\_\+size@{aero\+\_\+state\+\_\+bin\+\_\+average\+\_\+size}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+bin\+\_\+average\+\_\+size()}{aero\_state\_bin\_average\_size()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+bin\+\_\+average\+\_\+size (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(inout)}]{aero\+\_\+state,  }\item[{type(\mbox{\hyperlink{structpmc__bin__grid_1_1bin__grid__t}{bin\+\_\+grid\+\_\+t}}), intent(in)}]{bin\+\_\+grid,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data,  }\item[{logical, intent(in)}]{bin\+\_\+center,  }\item[{logical, intent(in)}]{preserve\+\_\+number }\end{DoxyParamCaption})}



Set each aerosol particle to have its original species ratios, but total volume given by the average volume of all particles within each bin. 

This does not preserve the total species volume per bin. If the {\ttfamily bin\+\_\+center} parameter is {\ttfamily }.true. then the particles in each bin are set to have the bin center volume, rather than the average volume of the particles in that bin.

If the weighting function is not constant (A\+E\+R\+O\+\_\+\+W\+E\+I\+G\+H\+T\+\_\+\+T\+Y\+P\+E\+\_\+\+N\+O\+NE) then the averaging can be performed in either a number-\/preserving way or in a volume-\/preserving way. The volume-\/preserving way does not preserve species volume ratios in gernal, but will do so if the particle population has already been composition-\/averaged.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em aero\+\_\+state} & Aerosol state to average.\\
\hline
\mbox{\tt in}  & {\em bin\+\_\+grid} & Bin grid to average within.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\mbox{\tt in}  & {\em bin\+\_\+center} & Whether to assign the bin center volume (rather than the average volume).\\
\hline
\mbox{\tt in}  & {\em preserve\+\_\+number} & Whether to use the number-\/preserving scheme (otherwise will use the volume-\/preserving scheme). This parameter has no effect if {\ttfamily bin\+\_\+center} is {\ttfamily }.true. \\
\hline
\end{DoxyParams}


Definition at line 1884 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a9ce29f42aed338fe38218ecc4bbfa158}\label{namespacepmc__aero__state_a9ce29f42aed338fe38218ecc4bbfa158}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+check@{aero\+\_\+state\+\_\+check}}
\index{aero\+\_\+state\+\_\+check@{aero\+\_\+state\+\_\+check}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+check()}{aero\_state\_check()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+check (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(in)}]{aero\+\_\+state,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data }\end{DoxyParamCaption})}



Check that aerosol state data is consistent. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em aero\+\_\+state} & Aerosol state to check.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data. \\
\hline
\end{DoxyParams}


Definition at line 2882 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_ade0790e3c1fbf87ed303a8ab22de32e3}\label{namespacepmc__aero__state_ade0790e3c1fbf87ed303a8ab22de32e3}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+copy\+\_\+weight@{aero\+\_\+state\+\_\+copy\+\_\+weight}}
\index{aero\+\_\+state\+\_\+copy\+\_\+weight@{aero\+\_\+state\+\_\+copy\+\_\+weight}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+copy\+\_\+weight()}{aero\_state\_copy\_weight()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+copy\+\_\+weight (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(in)}]{aero\+\_\+state\+\_\+from,  }\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(inout)}]{aero\+\_\+state\+\_\+to }\end{DoxyParamCaption})}



Copies weighting information for an {\ttfamily aero\+\_\+state}. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em aero\+\_\+state\+\_\+from} & Reference aerosol.\\
\hline
\mbox{\tt in,out}  & {\em aero\+\_\+state\+\_\+to} & Already allocated. \\
\hline
\end{DoxyParams}


Definition at line 157 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a1618326e97d290803c642af677073d9c}\label{namespacepmc__aero__state_a1618326e97d290803c642af677073d9c}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+crit\+\_\+rel\+\_\+humids@{aero\+\_\+state\+\_\+crit\+\_\+rel\+\_\+humids}}
\index{aero\+\_\+state\+\_\+crit\+\_\+rel\+\_\+humids@{aero\+\_\+state\+\_\+crit\+\_\+rel\+\_\+humids}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+crit\+\_\+rel\+\_\+humids()}{aero\_state\_crit\_rel\_humids()}}
{\footnotesize\ttfamily real(kind=dp) function, dimension(\mbox{\hyperlink{namespacepmc__aero__state_a94155bf7fa94e7c3ab722a5a1dacac98}{aero\+\_\+state\+\_\+n\+\_\+part}}(aero\+\_\+state)) pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+crit\+\_\+rel\+\_\+humids (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(in)}]{aero\+\_\+state,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data,  }\item[{type(\mbox{\hyperlink{structpmc__env__state_1_1env__state__t}{env\+\_\+state\+\_\+t}}), intent(in)}]{env\+\_\+state }\end{DoxyParamCaption})}



Returns the critical relative humidity for all particles (1). 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em aero\+\_\+state} & Aerosol state.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\mbox{\tt in}  & {\em env\+\_\+state} & Environment state.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Return value. 
\end{DoxyReturn}


Definition at line 1407 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a95c9f58cc1ce505a24fe1cb88eef1918}\label{namespacepmc__aero__state_a95c9f58cc1ce505a24fe1cb88eef1918}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+diameters@{aero\+\_\+state\+\_\+diameters}}
\index{aero\+\_\+state\+\_\+diameters@{aero\+\_\+state\+\_\+diameters}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+diameters()}{aero\_state\_diameters()}}
{\footnotesize\ttfamily real(kind=dp) function, dimension(\mbox{\hyperlink{namespacepmc__aero__state_a94155bf7fa94e7c3ab722a5a1dacac98}{aero\+\_\+state\+\_\+n\+\_\+part}}(aero\+\_\+state)) pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+diameters (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(in)}]{aero\+\_\+state,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data }\end{DoxyParamCaption})}



Returns the diameters of all particles. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em aero\+\_\+state} & Aerosol state.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Return diameters array (m). 
\end{DoxyReturn}


Definition at line 992 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a061271c7cf7c3592bb385c1b7bfbedfc}\label{namespacepmc__aero__state_a061271c7cf7c3592bb385c1b7bfbedfc}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+double@{aero\+\_\+state\+\_\+double}}
\index{aero\+\_\+state\+\_\+double@{aero\+\_\+state\+\_\+double}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+double()}{aero\_state\_double()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+double (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(inout)}]{aero\+\_\+state,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data,  }\item[{integer, intent(in)}]{i\+\_\+group,  }\item[{integer, intent(in)}]{i\+\_\+class }\end{DoxyParamCaption})}



Doubles number of particles in the given weight group. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em aero\+\_\+state} & Aerosol state.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\mbox{\tt in}  & {\em i\+\_\+group} & Weight group to double.\\
\hline
\mbox{\tt in}  & {\em i\+\_\+class} & Weight class to double. \\
\hline
\end{DoxyParams}


Definition at line 1472 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a575abf5653d2e972e8eb66a7a30ab187}\label{namespacepmc__aero__state_a575abf5653d2e972e8eb66a7a30ab187}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+dry\+\_\+diameters@{aero\+\_\+state\+\_\+dry\+\_\+diameters}}
\index{aero\+\_\+state\+\_\+dry\+\_\+diameters@{aero\+\_\+state\+\_\+dry\+\_\+diameters}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+dry\+\_\+diameters()}{aero\_state\_dry\_diameters()}}
{\footnotesize\ttfamily real(kind=dp) function, dimension(\mbox{\hyperlink{namespacepmc__aero__state_a94155bf7fa94e7c3ab722a5a1dacac98}{aero\+\_\+state\+\_\+n\+\_\+part}}(aero\+\_\+state)) pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+dry\+\_\+diameters (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(in)}]{aero\+\_\+state,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data }\end{DoxyParamCaption})}



Returns the dry diameters of all particles. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em aero\+\_\+state} & Aerosol state.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Return value (m). 
\end{DoxyReturn}


Definition at line 1010 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a4f965b4eaeeec1b01e2299016a3680cf}\label{namespacepmc__aero__state_a4f965b4eaeeec1b01e2299016a3680cf}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+dup\+\_\+particle@{aero\+\_\+state\+\_\+dup\+\_\+particle}}
\index{aero\+\_\+state\+\_\+dup\+\_\+particle@{aero\+\_\+state\+\_\+dup\+\_\+particle}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+dup\+\_\+particle()}{aero\_state\_dup\_particle()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+dup\+\_\+particle (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(inout)}]{aero\+\_\+state,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data,  }\item[{integer, intent(in)}]{i\+\_\+part,  }\item[{real(kind=dp), intent(in)}]{n\+\_\+part\+\_\+mean,  }\item[{logical, intent(in), optional}]{random\+\_\+weight\+\_\+group }\end{DoxyParamCaption})}



Add copies or remove a particle, with a given mean number of resulting particles. 

The particle number {\ttfamily i\+\_\+part} is either removed, or zero or more copies are added, with a random number of copies with the given mean {\ttfamily n\+\_\+part\+\_\+mean}. The final number of particles is either {\ttfamily floor(n\+\_\+part\+\_\+mean)} or {\ttfamily ceiling(n\+\_\+part\+\_\+mean)}, chosen randomly so the mean is {\ttfamily n\+\_\+part\+\_\+mean}.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em aero\+\_\+state} & Aerosol state.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\mbox{\tt in}  & {\em i\+\_\+part} & Particle number.\\
\hline
\mbox{\tt in}  & {\em n\+\_\+part\+\_\+mean} & Mean number of resulting particles.\\
\hline
\mbox{\tt in}  & {\em random\+\_\+weight\+\_\+group} & Whether particle copies should be placed in a randomly chosen weight group. \\
\hline
\end{DoxyParams}


Definition at line 460 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_ac5109f61fd1f0631a218a410154da5c1}\label{namespacepmc__aero__state_ac5109f61fd1f0631a218a410154da5c1}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+halve@{aero\+\_\+state\+\_\+halve}}
\index{aero\+\_\+state\+\_\+halve@{aero\+\_\+state\+\_\+halve}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+halve()}{aero\_state\_halve()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+halve (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(inout)}]{aero\+\_\+state,  }\item[{integer, intent(in)}]{i\+\_\+group,  }\item[{integer, intent(in)}]{i\+\_\+class }\end{DoxyParamCaption})}



Remove approximately half of the particles in the given weight group. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em aero\+\_\+state} & Aerosol state.\\
\hline
\mbox{\tt in}  & {\em i\+\_\+group} & Weight group to halve.\\
\hline
\mbox{\tt in}  & {\em i\+\_\+class} & Weight class to halve. \\
\hline
\end{DoxyParams}


Definition at line 1503 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a4c0671e83504e6bd71735b876c78ec2f}\label{namespacepmc__aero__state_a4c0671e83504e6bd71735b876c78ec2f}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+ids@{aero\+\_\+state\+\_\+ids}}
\index{aero\+\_\+state\+\_\+ids@{aero\+\_\+state\+\_\+ids}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+ids()}{aero\_state\_ids()}}
{\footnotesize\ttfamily integer function, dimension(\mbox{\hyperlink{namespacepmc__aero__state_a94155bf7fa94e7c3ab722a5a1dacac98}{aero\+\_\+state\+\_\+n\+\_\+part}}(aero\+\_\+state)) pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+ids (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(in)}]{aero\+\_\+state }\end{DoxyParamCaption})}



Returns the I\+Ds of all particles. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em aero\+\_\+state} & Aerosol state.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Return value. 
\end{DoxyReturn}


Definition at line 973 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a2118eb683c0dc350e8f48a59ea8ed8ce}\label{namespacepmc__aero__state_a2118eb683c0dc350e8f48a59ea8ed8ce}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+input\+\_\+netcdf@{aero\+\_\+state\+\_\+input\+\_\+netcdf}}
\index{aero\+\_\+state\+\_\+input\+\_\+netcdf@{aero\+\_\+state\+\_\+input\+\_\+netcdf}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+input\+\_\+netcdf()}{aero\_state\_input\_netcdf()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+input\+\_\+netcdf (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(inout)}]{aero\+\_\+state,  }\item[{integer, intent(in)}]{ncid,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data }\end{DoxyParamCaption})}



Read full state. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em aero\+\_\+state} & aero\+\_\+state to read.\\
\hline
\mbox{\tt in}  & {\em ncid} & Net\+C\+DF file ID, in data mode.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & aero\+\_\+data structure. \\
\hline
\end{DoxyParams}


Definition at line 2707 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a7e64dc08790a4600076982a43fe76221}\label{namespacepmc__aero__state_a7e64dc08790a4600076982a43fe76221}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+make\+\_\+dry@{aero\+\_\+state\+\_\+make\+\_\+dry}}
\index{aero\+\_\+state\+\_\+make\+\_\+dry@{aero\+\_\+state\+\_\+make\+\_\+dry}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+make\+\_\+dry()}{aero\_state\_make\_dry()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+make\+\_\+dry (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(inout)}]{aero\+\_\+state,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data }\end{DoxyParamCaption})}



Make all particles dry (water set to zero). 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em aero\+\_\+state} & Aerosol state to make dry.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data. \\
\hline
\end{DoxyParams}


Definition at line 2081 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a0bf5046e0ca5be2e39b436d6c7b3a4cb}\label{namespacepmc__aero__state_a0bf5046e0ca5be2e39b436d6c7b3a4cb}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+mass\+\_\+entropies@{aero\+\_\+state\+\_\+mass\+\_\+entropies}}
\index{aero\+\_\+state\+\_\+mass\+\_\+entropies@{aero\+\_\+state\+\_\+mass\+\_\+entropies}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+mass\+\_\+entropies()}{aero\_state\_mass\_entropies()}}
{\footnotesize\ttfamily real(kind=dp) function, dimension(\mbox{\hyperlink{namespacepmc__aero__state_a94155bf7fa94e7c3ab722a5a1dacac98}{aero\+\_\+state\+\_\+n\+\_\+part}}(aero\+\_\+state)) pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+mass\+\_\+entropies (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(in)}]{aero\+\_\+state,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data,  }\item[{character(len=$\ast$), dimension(\+:), optional}]{include,  }\item[{character(len=$\ast$), dimension(\+:), optional}]{exclude,  }\item[{character(len=$\ast$), dimension(\+:), optional}]{group }\end{DoxyParamCaption})}



Returns the mass-\/entropies of all particles. 

If {\ttfamily include} is specified then only those species are included in computing the entropy. If {\ttfamily exclude} is specified then all species except those species are included. If both {\ttfamily include} and {\ttfamily exclude} arguments are specified then only those species in {\ttfamily include} but not in {\ttfamily exclude} are included. If {\ttfamily group} is specified then the species are divided into two sets, given by those in the group and those not in the group. The entropy is then computed using the total mass of each set.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em aero\+\_\+state} & Aerosol state.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
 & {\em include} & Species names to include in the mass.\\
\hline
 & {\em exclude} & Species names to exclude in the mass.\\
\hline
 & {\em group} & Species names to group together.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Return value. 
\end{DoxyReturn}


Definition at line 1236 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_ae9fa229a50576c4bce900bcb21c4e73c}\label{namespacepmc__aero__state_ae9fa229a50576c4bce900bcb21c4e73c}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+masses@{aero\+\_\+state\+\_\+masses}}
\index{aero\+\_\+state\+\_\+masses@{aero\+\_\+state\+\_\+masses}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+masses()}{aero\_state\_masses()}}
{\footnotesize\ttfamily real(kind=dp) function, dimension(\mbox{\hyperlink{namespacepmc__aero__state_a94155bf7fa94e7c3ab722a5a1dacac98}{aero\+\_\+state\+\_\+n\+\_\+part}}(aero\+\_\+state)) pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+masses (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(in)}]{aero\+\_\+state,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data,  }\item[{character(len=$\ast$), dimension(\+:), intent(in), optional}]{include,  }\item[{character(len=$\ast$), dimension(\+:), intent(in), optional}]{exclude }\end{DoxyParamCaption})}



Returns the masses of all particles. 

If {\ttfamily include} is specified then only those species are included in computing the masses. If {\ttfamily exclude} is specified then all species except those species are included. If both {\ttfamily include} and {\ttfamily exclude} arguments are specified then only those species in {\ttfamily include} but not in {\ttfamily exclude} are included.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em aero\+\_\+state} & Aerosol state.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\mbox{\tt in}  & {\em include} & Species names to include in the mass.\\
\hline
\mbox{\tt in}  & {\em exclude} & Species names to exclude in the mass.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Return masses array (kg). 
\end{DoxyReturn}


Definition at line 1125 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a3c40aa98c11c8dfe6e662f2bbd8672e9}\label{namespacepmc__aero__state_a3c40aa98c11c8dfe6e662f2bbd8672e9}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+mix@{aero\+\_\+state\+\_\+mix}}
\index{aero\+\_\+state\+\_\+mix@{aero\+\_\+state\+\_\+mix}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+mix()}{aero\_state\_mix()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+mix (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(inout)}]{aero\+\_\+state,  }\item[{real(kind=dp), intent(in)}]{del\+\_\+t,  }\item[{real(kind=dp), intent(in)}]{mix\+\_\+timescale,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data,  }\item[{real(kind=dp), intent(in), optional}]{specify\+\_\+prob\+\_\+transfer }\end{DoxyParamCaption})}



Mix the aero\+\_\+states between all processes. Currently uses a simple all-\/to-\/all diffusion. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em aero\+\_\+state} & Aerosol state.\\
\hline
\mbox{\tt in}  & {\em del\+\_\+t} & Timestep (s).\\
\hline
\mbox{\tt in}  & {\em mix\+\_\+timescale} & Mixing timescale (s).\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aero data values.\\
\hline
\mbox{\tt in}  & {\em specify\+\_\+prob\+\_\+transfer} & Transfer probability of each particle (0 means no mixing, 1 means total mixing). \\
\hline
\end{DoxyParams}


Definition at line 1667 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a370d03980bec87029d569a9b9116740d}\label{namespacepmc__aero__state_a370d03980bec87029d569a9b9116740d}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+mixing\+\_\+state\+\_\+metrics@{aero\+\_\+state\+\_\+mixing\+\_\+state\+\_\+metrics}}
\index{aero\+\_\+state\+\_\+mixing\+\_\+state\+\_\+metrics@{aero\+\_\+state\+\_\+mixing\+\_\+state\+\_\+metrics}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+mixing\+\_\+state\+\_\+metrics()}{aero\_state\_mixing\_state\_metrics()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+mixing\+\_\+state\+\_\+metrics (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(in)}]{aero\+\_\+state,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data,  }\item[{real(kind=dp), intent(out)}]{d\+\_\+alpha,  }\item[{real(kind=dp), intent(out)}]{d\+\_\+gamma,  }\item[{real(kind=dp), intent(out)}]{chi,  }\item[{character(len=$\ast$), dimension(\+:), optional}]{include,  }\item[{character(len=$\ast$), dimension(\+:), optional}]{exclude,  }\item[{character(len=$\ast$), dimension(\+:), optional}]{group }\end{DoxyParamCaption})}



Returns the mixing state metrics of the population. 

If {\ttfamily include} is specified then only those species are included in computing the entropies. If {\ttfamily exclude} is specified then all species except those species are included. If both {\ttfamily include} and {\ttfamily exclude} arguments are specified then only those species in {\ttfamily include} but not in {\ttfamily exclude} are included. If {\ttfamily group} is specified then the species are divided into two sets, given by those in the group and those not in the group. The entropies are then computed using the total mass of each set.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em aero\+\_\+state} & Aerosol state.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\mbox{\tt out}  & {\em d\+\_\+alpha} & Average particle diversity.\\
\hline
\mbox{\tt out}  & {\em d\+\_\+gamma} & Bulk diversity.\\
\hline
\mbox{\tt out}  & {\em chi} & Mixing state index.\\
\hline
 & {\em include} & Species names to include in the mass.\\
\hline
 & {\em exclude} & Species names to exclude in the mass.\\
\hline
 & {\em group} & Species names to group together. \\
\hline
\end{DoxyParams}


Definition at line 1324 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a5ddd78918027552f0815529f4c0128fb}\label{namespacepmc__aero__state_a5ddd78918027552f0815529f4c0128fb}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+mobility\+\_\+diameters@{aero\+\_\+state\+\_\+mobility\+\_\+diameters}}
\index{aero\+\_\+state\+\_\+mobility\+\_\+diameters@{aero\+\_\+state\+\_\+mobility\+\_\+diameters}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+mobility\+\_\+diameters()}{aero\_state\_mobility\_diameters()}}
{\footnotesize\ttfamily real(kind=dp) function, dimension(          \mbox{\hyperlink{namespacepmc__aero__state_a94155bf7fa94e7c3ab722a5a1dacac98}{aero\+\_\+state\+\_\+n\+\_\+part}}(aero\+\_\+state)) pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+mobility\+\_\+diameters (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(in)}]{aero\+\_\+state,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data,  }\item[{type(\mbox{\hyperlink{structpmc__env__state_1_1env__state__t}{env\+\_\+state\+\_\+t}}), intent(in)}]{env\+\_\+state }\end{DoxyParamCaption})}



Returns the mobility diameters of all particles. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em aero\+\_\+state} & Aerosol state.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\mbox{\tt in}  & {\em env\+\_\+state} & Environment state.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Return value (m). 
\end{DoxyReturn}


Definition at line 1028 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_ae546d85939653c1b2c7d52121d5f2bc6}\label{namespacepmc__aero__state_ae546d85939653c1b2c7d52121d5f2bc6}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+mpi\+\_\+alltoall@{aero\+\_\+state\+\_\+mpi\+\_\+alltoall}}
\index{aero\+\_\+state\+\_\+mpi\+\_\+alltoall@{aero\+\_\+state\+\_\+mpi\+\_\+alltoall}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+mpi\+\_\+alltoall()}{aero\_state\_mpi\_alltoall()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+mpi\+\_\+alltoall (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), dimension(\+:), intent(in)}]{send,  }\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), dimension(size(send)), intent(inout)}]{recv }\end{DoxyParamCaption})}



Do an M\+PI all-\/to-\/all transfer of aerosol states. 

States without particles are not sent.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em send} & Array of aero\+\_\+states to send (one per process).\\
\hline
\mbox{\tt in,out}  & {\em recv} & Array of aero\+\_\+states to receives (one per process). \\
\hline
\end{DoxyParams}


Definition at line 1751 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_ac8b1291fc517ab1d3ffe9642ab577c6c}\label{namespacepmc__aero__state_ac8b1291fc517ab1d3ffe9642ab577c6c}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+mpi\+\_\+gather@{aero\+\_\+state\+\_\+mpi\+\_\+gather}}
\index{aero\+\_\+state\+\_\+mpi\+\_\+gather@{aero\+\_\+state\+\_\+mpi\+\_\+gather}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+mpi\+\_\+gather()}{aero\_state\_mpi\_gather()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+mpi\+\_\+gather (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(in)}]{aero\+\_\+state,  }\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(inout)}]{aero\+\_\+state\+\_\+total,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data }\end{DoxyParamCaption})}



Gathers data from all processes into one aero\+\_\+state on process 0. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em aero\+\_\+state} & Local aero\+\_\+state.\\
\hline
\mbox{\tt in,out}  & {\em aero\+\_\+state\+\_\+total} & Centralized aero\+\_\+state (only on process 0).\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aero data values. \\
\hline
\end{DoxyParams}


Definition at line 2182 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a94155bf7fa94e7c3ab722a5a1dacac98}\label{namespacepmc__aero__state_a94155bf7fa94e7c3ab722a5a1dacac98}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+n\+\_\+part@{aero\+\_\+state\+\_\+n\+\_\+part}}
\index{aero\+\_\+state\+\_\+n\+\_\+part@{aero\+\_\+state\+\_\+n\+\_\+part}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+n\+\_\+part()}{aero\_state\_n\_part()}}
{\footnotesize\ttfamily elemental integer function pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+n\+\_\+part (\begin{DoxyParamCaption}\item[{class(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(in)}]{aero\+\_\+state }\end{DoxyParamCaption})}



Return the current number of particles. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em aero\+\_\+state} & Aerosol state. \\
\hline
\end{DoxyParams}


Definition at line 87 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_acb748f0c0c6c37180e896af05acb1c19}\label{namespacepmc__aero__state_acb748f0c0c6c37180e896af05acb1c19}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+netcdf\+\_\+dim\+\_\+aero\+\_\+particle@{aero\+\_\+state\+\_\+netcdf\+\_\+dim\+\_\+aero\+\_\+particle}}
\index{aero\+\_\+state\+\_\+netcdf\+\_\+dim\+\_\+aero\+\_\+particle@{aero\+\_\+state\+\_\+netcdf\+\_\+dim\+\_\+aero\+\_\+particle}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+netcdf\+\_\+dim\+\_\+aero\+\_\+particle()}{aero\_state\_netcdf\_dim\_aero\_particle()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+netcdf\+\_\+dim\+\_\+aero\+\_\+particle (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(in)}]{aero\+\_\+state,  }\item[{integer, intent(in)}]{ncid,  }\item[{integer, intent(out)}]{dimid\+\_\+aero\+\_\+particle }\end{DoxyParamCaption})}



Write the aero particle dimension to the given Net\+C\+DF file if it is not already present and in any case return the associated dimid. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em aero\+\_\+state} & aero\+\_\+state structure.\\
\hline
\mbox{\tt in}  & {\em ncid} & Net\+C\+DF file ID, in data mode.\\
\hline
\mbox{\tt out}  & {\em dimid\+\_\+aero\+\_\+particle} & Dimid of the aero particle dimension. \\
\hline
\end{DoxyParams}


Definition at line 2256 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a7d32f436e51ba2ff96838b47e2169585}\label{namespacepmc__aero__state_a7d32f436e51ba2ff96838b47e2169585}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+netcdf\+\_\+dim\+\_\+aero\+\_\+removed@{aero\+\_\+state\+\_\+netcdf\+\_\+dim\+\_\+aero\+\_\+removed}}
\index{aero\+\_\+state\+\_\+netcdf\+\_\+dim\+\_\+aero\+\_\+removed@{aero\+\_\+state\+\_\+netcdf\+\_\+dim\+\_\+aero\+\_\+removed}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+netcdf\+\_\+dim\+\_\+aero\+\_\+removed()}{aero\_state\_netcdf\_dim\_aero\_removed()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+netcdf\+\_\+dim\+\_\+aero\+\_\+removed (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(in)}]{aero\+\_\+state,  }\item[{integer, intent(in)}]{ncid,  }\item[{integer, intent(out)}]{dimid\+\_\+aero\+\_\+removed }\end{DoxyParamCaption})}



Write the aero removed dimension to the given Net\+C\+DF file if it is not already present and in any case return the associated dimid. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em aero\+\_\+state} & aero\+\_\+state structure.\\
\hline
\mbox{\tt in}  & {\em ncid} & Net\+C\+DF file ID, in data mode.\\
\hline
\mbox{\tt out}  & {\em dimid\+\_\+aero\+\_\+removed} & Dimid of the aero removed dimension. \\
\hline
\end{DoxyParams}


Definition at line 2297 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a08e7e95e0c08167046e3238693096dee}\label{namespacepmc__aero__state_a08e7e95e0c08167046e3238693096dee}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+num\+\_\+conc\+\_\+for\+\_\+reweight@{aero\+\_\+state\+\_\+num\+\_\+conc\+\_\+for\+\_\+reweight}}
\index{aero\+\_\+state\+\_\+num\+\_\+conc\+\_\+for\+\_\+reweight@{aero\+\_\+state\+\_\+num\+\_\+conc\+\_\+for\+\_\+reweight}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+num\+\_\+conc\+\_\+for\+\_\+reweight()}{aero\_state\_num\_conc\_for\_reweight()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+num\+\_\+conc\+\_\+for\+\_\+reweight (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(in)}]{aero\+\_\+state,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data,  }\item[{real(kind=dp), dimension(\mbox{\hyperlink{namespacepmc__aero__state_a94155bf7fa94e7c3ab722a5a1dacac98}{aero\+\_\+state\+\_\+n\+\_\+part}}(aero\+\_\+state)), intent(out)}]{reweight\+\_\+num\+\_\+conc }\end{DoxyParamCaption})}



Save the correct number concentrations for later use by \mbox{\hyperlink{namespacepmc__aero__state_a38c69c82e0dbc601557ff505d0513ba6}{aero\+\_\+state\+\_\+reweight()}}. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em aero\+\_\+state} & Aerosol state.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\mbox{\tt out}  & {\em reweight\+\_\+num\+\_\+conc} & Number concentrations for later use by \mbox{\hyperlink{namespacepmc__aero__state_a38c69c82e0dbc601557ff505d0513ba6}{aero\+\_\+state\+\_\+reweight()}}. \\
\hline
\end{DoxyParams}


Definition at line 530 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a31dd92148979397fc0b7bc5fd056a064}\label{namespacepmc__aero__state_a31dd92148979397fc0b7bc5fd056a064}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+num\+\_\+concs@{aero\+\_\+state\+\_\+num\+\_\+concs}}
\index{aero\+\_\+state\+\_\+num\+\_\+concs@{aero\+\_\+state\+\_\+num\+\_\+concs}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+num\+\_\+concs()}{aero\_state\_num\_concs()}}
{\footnotesize\ttfamily real(kind=dp) function, dimension(\mbox{\hyperlink{namespacepmc__aero__state_a94155bf7fa94e7c3ab722a5a1dacac98}{aero\+\_\+state\+\_\+n\+\_\+part}}(aero\+\_\+state)) pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+num\+\_\+concs (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(in)}]{aero\+\_\+state,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data }\end{DoxyParamCaption})}



Returns the number concentrations of all particles. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em aero\+\_\+state} & Aerosol state.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Return number concentrations array (m$^\wedge$\{-\/3\}). 
\end{DoxyReturn}


Definition at line 1182 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a6e14396858e4011e0b36ebc5cd653bc2}\label{namespacepmc__aero__state_a6e14396858e4011e0b36ebc5cd653bc2}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+particle\+\_\+num\+\_\+conc@{aero\+\_\+state\+\_\+particle\+\_\+num\+\_\+conc}}
\index{aero\+\_\+state\+\_\+particle\+\_\+num\+\_\+conc@{aero\+\_\+state\+\_\+particle\+\_\+num\+\_\+conc}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+particle\+\_\+num\+\_\+conc()}{aero\_state\_particle\_num\_conc()}}
{\footnotesize\ttfamily real(kind=dp) function pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+particle\+\_\+num\+\_\+conc (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(in)}]{aero\+\_\+state,  }\item[{type(\mbox{\hyperlink{structpmc__aero__particle_1_1aero__particle__t}{aero\+\_\+particle\+\_\+t}}), intent(in)}]{aero\+\_\+particle,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data }\end{DoxyParamCaption})}



The number concentration of a single particle (m$^\wedge$\{-\/3\}). 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em aero\+\_\+state} & Aerosol state containing the particle.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+particle} & Aerosol particle.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data. \\
\hline
\end{DoxyParams}


Definition at line 510 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_af3652445ddd2485a544cc426b3248481}\label{namespacepmc__aero__state_af3652445ddd2485a544cc426b3248481}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+prepare\+\_\+weight\+\_\+for\+\_\+add@{aero\+\_\+state\+\_\+prepare\+\_\+weight\+\_\+for\+\_\+add}}
\index{aero\+\_\+state\+\_\+prepare\+\_\+weight\+\_\+for\+\_\+add@{aero\+\_\+state\+\_\+prepare\+\_\+weight\+\_\+for\+\_\+add}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+prepare\+\_\+weight\+\_\+for\+\_\+add()}{aero\_state\_prepare\_weight\_for\_add()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+prepare\+\_\+weight\+\_\+for\+\_\+add (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(inout)}]{aero\+\_\+state,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data,  }\item[{integer, intent(in)}]{i\+\_\+group,  }\item[{integer, intent(in)}]{i\+\_\+class,  }\item[{real(kind=dp), intent(in)}]{n\+\_\+add,  }\item[{logical, intent(in)}]{allow\+\_\+doubling,  }\item[{logical, intent(in)}]{allow\+\_\+halving }\end{DoxyParamCaption})}



Change the weight if necessary to ensure that the addition of about {\ttfamily n\+\_\+add} computational particles will give the correct final particle number. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em aero\+\_\+state} & Aero state to add to.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\mbox{\tt in}  & {\em i\+\_\+group} & Weight group number to add to.\\
\hline
\mbox{\tt in}  & {\em i\+\_\+class} & Weight class number to add to.\\
\hline
\mbox{\tt in}  & {\em n\+\_\+add} & Approximate number of particles to be added at current weighting.\\
\hline
\mbox{\tt in}  & {\em allow\+\_\+doubling} & Whether to allow doubling of the population.\\
\hline
\mbox{\tt in}  & {\em allow\+\_\+halving} & Whether to allow halving of the population. \\
\hline
\end{DoxyParams}


Definition at line 670 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_ab4369f9cfc8e1fdc80c6cd2aced773c9}\label{namespacepmc__aero__state_ab4369f9cfc8e1fdc80c6cd2aced773c9}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+rand\+\_\+particle@{aero\+\_\+state\+\_\+rand\+\_\+particle}}
\index{aero\+\_\+state\+\_\+rand\+\_\+particle@{aero\+\_\+state\+\_\+rand\+\_\+particle}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+rand\+\_\+particle()}{aero\_state\_rand\_particle()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+rand\+\_\+particle (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(in)}]{aero\+\_\+state,  }\item[{integer, intent(out)}]{i\+\_\+part }\end{DoxyParamCaption})}



Choose a random particle from the aero\+\_\+state. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em aero\+\_\+state} & Original state.\\
\hline
\mbox{\tt out}  & {\em i\+\_\+part} & Chosen random particle number. \\
\hline
\end{DoxyParams}


Definition at line 787 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a166b2bd2407e5342dd3c5a45b0ba421e}\label{namespacepmc__aero__state_a166b2bd2407e5342dd3c5a45b0ba421e}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+rebalance@{aero\+\_\+state\+\_\+rebalance}}
\index{aero\+\_\+state\+\_\+rebalance@{aero\+\_\+state\+\_\+rebalance}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+rebalance()}{aero\_state\_rebalance()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+rebalance (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(inout)}]{aero\+\_\+state,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data,  }\item[{logical, intent(in)}]{allow\+\_\+doubling,  }\item[{logical, intent(in)}]{allow\+\_\+halving,  }\item[{logical, intent(in)}]{initial\+\_\+state\+\_\+warning }\end{DoxyParamCaption})}



Double or halve the particle population in each weight group to maintain close to {\ttfamily n\+\_\+part\+\_\+ideal} particles per process, allocated equally amongst the weight groups. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em aero\+\_\+state} & Aerosol state.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\mbox{\tt in}  & {\em allow\+\_\+doubling} & Whether to allow doubling of the population.\\
\hline
\mbox{\tt in}  & {\em allow\+\_\+halving} & Whether to allow halving of the population.\\
\hline
\mbox{\tt in}  & {\em initial\+\_\+state\+\_\+warning} & Whether to warn due to initial state doubling/halving. \\
\hline
\end{DoxyParams}


Definition at line 1537 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_ac19bda6a4cd1c2a3ea9f6cadf9dc9bb6}\label{namespacepmc__aero__state_ac19bda6a4cd1c2a3ea9f6cadf9dc9bb6}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+remove\+\_\+particle@{aero\+\_\+state\+\_\+remove\+\_\+particle}}
\index{aero\+\_\+state\+\_\+remove\+\_\+particle@{aero\+\_\+state\+\_\+remove\+\_\+particle}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+remove\+\_\+particle()}{aero\_state\_remove\_particle()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+remove\+\_\+particle (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(inout)}]{aero\+\_\+state,  }\item[{integer, intent(in)}]{i\+\_\+part,  }\item[{logical, intent(in)}]{record\+\_\+removal,  }\item[{type(\mbox{\hyperlink{structpmc__aero__info_1_1aero__info__t}{aero\+\_\+info\+\_\+t}}), intent(in)}]{aero\+\_\+info }\end{DoxyParamCaption})}



Remove the given particle and possibly record the removal. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em aero\+\_\+state} & Aerosol state.\\
\hline
\mbox{\tt in}  & {\em i\+\_\+part} & Index of particle to remove.\\
\hline
\mbox{\tt in}  & {\em record\+\_\+removal} & Whether to record the removal in the aero\+\_\+info\+\_\+array.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+info} & Removal info. \\
\hline
\end{DoxyParams}


Definition at line 399 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a87d926e9b2ca5930053d449d771efcee}\label{namespacepmc__aero__state_a87d926e9b2ca5930053d449d771efcee}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+remove\+\_\+particle\+\_\+no\+\_\+info@{aero\+\_\+state\+\_\+remove\+\_\+particle\+\_\+no\+\_\+info}}
\index{aero\+\_\+state\+\_\+remove\+\_\+particle\+\_\+no\+\_\+info@{aero\+\_\+state\+\_\+remove\+\_\+particle\+\_\+no\+\_\+info}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+remove\+\_\+particle\+\_\+no\+\_\+info()}{aero\_state\_remove\_particle\_no\_info()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+remove\+\_\+particle\+\_\+no\+\_\+info (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(inout)}]{aero\+\_\+state,  }\item[{integer, intent(in)}]{i\+\_\+part }\end{DoxyParamCaption})}



Remove the given particle without recording it. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em aero\+\_\+state} & Aerosol state.\\
\hline
\mbox{\tt in}  & {\em i\+\_\+part} & Index of particle to remove. \\
\hline
\end{DoxyParams}


Definition at line 360 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_ad28b72502e5bb9caa40eac383d9bb22e}\label{namespacepmc__aero__state_ad28b72502e5bb9caa40eac383d9bb22e}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+remove\+\_\+particle\+\_\+with\+\_\+info@{aero\+\_\+state\+\_\+remove\+\_\+particle\+\_\+with\+\_\+info}}
\index{aero\+\_\+state\+\_\+remove\+\_\+particle\+\_\+with\+\_\+info@{aero\+\_\+state\+\_\+remove\+\_\+particle\+\_\+with\+\_\+info}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+remove\+\_\+particle\+\_\+with\+\_\+info()}{aero\_state\_remove\_particle\_with\_info()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+remove\+\_\+particle\+\_\+with\+\_\+info (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(inout)}]{aero\+\_\+state,  }\item[{integer, intent(in)}]{i\+\_\+part,  }\item[{type(\mbox{\hyperlink{structpmc__aero__info_1_1aero__info__t}{aero\+\_\+info\+\_\+t}}), intent(in)}]{aero\+\_\+info }\end{DoxyParamCaption})}



Remove the given particle and record the removal. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em aero\+\_\+state} & Aerosol state.\\
\hline
\mbox{\tt in}  & {\em i\+\_\+part} & Index of particle to remove.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+info} & Removal info. \\
\hline
\end{DoxyParams}


Definition at line 380 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_aabf1b375475462cc54740039ad556a83}\label{namespacepmc__aero__state_aabf1b375475462cc54740039ad556a83}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+remove\+\_\+rand\+\_\+particle\+\_\+from\+\_\+bin@{aero\+\_\+state\+\_\+remove\+\_\+rand\+\_\+particle\+\_\+from\+\_\+bin}}
\index{aero\+\_\+state\+\_\+remove\+\_\+rand\+\_\+particle\+\_\+from\+\_\+bin@{aero\+\_\+state\+\_\+remove\+\_\+rand\+\_\+particle\+\_\+from\+\_\+bin}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+remove\+\_\+rand\+\_\+particle\+\_\+from\+\_\+bin()}{aero\_state\_remove\_rand\_particle\_from\_bin()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+remove\+\_\+rand\+\_\+particle\+\_\+from\+\_\+bin (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(inout)}]{aero\+\_\+state,  }\item[{integer, intent(in)}]{i\+\_\+bin,  }\item[{integer, intent(in)}]{i\+\_\+class,  }\item[{type(\mbox{\hyperlink{structpmc__aero__particle_1_1aero__particle__t}{aero\+\_\+particle\+\_\+t}}), intent(inout)}]{aero\+\_\+particle }\end{DoxyParamCaption})}



Remove a randomly chosen particle from the given bin and return it. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em aero\+\_\+state} & Aerosol state.\\
\hline
\mbox{\tt in}  & {\em i\+\_\+bin} & Bin number to remove particle from.\\
\hline
\mbox{\tt in}  & {\em i\+\_\+class} & Weight class to remove particle from.\\
\hline
\mbox{\tt in,out}  & {\em aero\+\_\+particle} & Removed particle. \\
\hline
\end{DoxyParams}


Definition at line 424 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a38c69c82e0dbc601557ff505d0513ba6}\label{namespacepmc__aero__state_a38c69c82e0dbc601557ff505d0513ba6}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+reweight@{aero\+\_\+state\+\_\+reweight}}
\index{aero\+\_\+state\+\_\+reweight@{aero\+\_\+state\+\_\+reweight}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+reweight()}{aero\_state\_reweight()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+reweight (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(inout)}]{aero\+\_\+state,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data,  }\item[{real(kind=dp), dimension(\mbox{\hyperlink{namespacepmc__aero__state_a94155bf7fa94e7c3ab722a5a1dacac98}{aero\+\_\+state\+\_\+n\+\_\+part}}(aero\+\_\+state)), intent(in)}]{reweight\+\_\+num\+\_\+conc }\end{DoxyParamCaption})}



Reweight all particles after their constituent volumes have been altered. 

The pattern for use should be like\+: 
\begin{DoxyPre}
 call aero\_state\_num\_conc\_for\_reweight(aero\_state, aero\_data,
      reweight\_num\_conc)
 ... alter particle species volumes in aero\_state ...
 call aero\_state\_reweight(aero\_state, aero\_data, reweight\_num\_conc)
 \end{DoxyPre}



\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em aero\+\_\+state} & Aerosol state.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\mbox{\tt in}  & {\em reweight\+\_\+num\+\_\+conc} & Number concentrations previously computed by \mbox{\hyperlink{namespacepmc__aero__state_a08e7e95e0c08167046e3238693096dee}{aero\+\_\+state\+\_\+num\+\_\+conc\+\_\+for\+\_\+reweight()}}. \\
\hline
\end{DoxyParams}


Definition at line 562 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a1ccf923e3212b8800371ebd59156ff8f}\label{namespacepmc__aero__state_a1ccf923e3212b8800371ebd59156ff8f}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+sample@{aero\+\_\+state\+\_\+sample}}
\index{aero\+\_\+state\+\_\+sample@{aero\+\_\+state\+\_\+sample}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+sample()}{aero\_state\_sample()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+sample (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(inout)}]{aero\+\_\+state\+\_\+from,  }\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(inout)}]{aero\+\_\+state\+\_\+to,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data,  }\item[{real(kind=dp), intent(in)}]{sample\+\_\+prob,  }\item[{integer, intent(in)}]{removal\+\_\+action }\end{DoxyParamCaption})}



Generates a random sample by removing particles from aero\+\_\+state\+\_\+from and adding them to aero\+\_\+state\+\_\+to, transfering weight as well. This is the equivalent of \mbox{\hyperlink{namespacepmc__aero__state_ad9c12bba90caa58b86882ebfe4a4335c}{aero\+\_\+state\+\_\+add()}}. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em aero\+\_\+state\+\_\+from} & Original state.\\
\hline
\mbox{\tt in,out}  & {\em aero\+\_\+state\+\_\+to} & Destination state (previous contents will be lost).\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\mbox{\tt in}  & {\em sample\+\_\+prob} & Probability of sampling each particle.\\
\hline
\mbox{\tt in}  & {\em removal\+\_\+action} & Action for removal (see \mbox{\hyperlink{namespacepmc__aero__info}{pmc\+\_\+aero\+\_\+info}} module for action parameters). Set to A\+E\+R\+O\+\_\+\+I\+N\+F\+O\+\_\+\+N\+O\+NE to not log removal. \\
\hline
\end{DoxyParams}


Definition at line 883 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a45e47d79732741df0dacf15d65d7b4a7}\label{namespacepmc__aero__state_a45e47d79732741df0dacf15d65d7b4a7}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+sample\+\_\+particles@{aero\+\_\+state\+\_\+sample\+\_\+particles}}
\index{aero\+\_\+state\+\_\+sample\+\_\+particles@{aero\+\_\+state\+\_\+sample\+\_\+particles}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+sample\+\_\+particles()}{aero\_state\_sample\_particles()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+sample\+\_\+particles (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(inout)}]{aero\+\_\+state\+\_\+from,  }\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(inout)}]{aero\+\_\+state\+\_\+to,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data,  }\item[{real(kind=dp), intent(in)}]{sample\+\_\+prob,  }\item[{integer, intent(in)}]{removal\+\_\+action }\end{DoxyParamCaption})}



Generates a random sample by removing particles from aero\+\_\+state\+\_\+from and adding them to aero\+\_\+state\+\_\+to, which must be already allocated (and should have its weight set). 

None of the weights are altered by this sampling, making this the equivalent of \mbox{\hyperlink{namespacepmc__aero__state_a9960460ba28e89f4f253dcbdb482fff7}{aero\+\_\+state\+\_\+add\+\_\+particles()}}.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em aero\+\_\+state\+\_\+from} & Original state.\\
\hline
\mbox{\tt in,out}  & {\em aero\+\_\+state\+\_\+to} & Destination state.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\mbox{\tt in}  & {\em sample\+\_\+prob} & Probability of sampling each particle.\\
\hline
\mbox{\tt in}  & {\em removal\+\_\+action} & Action for removal (see \mbox{\hyperlink{namespacepmc__aero__info}{pmc\+\_\+aero\+\_\+info}} module for action parameters). Set to A\+E\+R\+O\+\_\+\+I\+N\+F\+O\+\_\+\+N\+O\+NE to not log removal. \\
\hline
\end{DoxyParams}


Definition at line 808 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_ac4ca03b5c8c9684e8442edc2df12a020}\label{namespacepmc__aero__state_ac4ca03b5c8c9684e8442edc2df12a020}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+scale\+\_\+weight@{aero\+\_\+state\+\_\+scale\+\_\+weight}}
\index{aero\+\_\+state\+\_\+scale\+\_\+weight@{aero\+\_\+state\+\_\+scale\+\_\+weight}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+scale\+\_\+weight()}{aero\_state\_scale\_weight()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+scale\+\_\+weight (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(inout)}]{aero\+\_\+state,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data,  }\item[{integer, intent(in)}]{i\+\_\+group,  }\item[{integer, intent(in)}]{i\+\_\+class,  }\item[{real(kind=dp), intent(in)}]{weight\+\_\+ratio,  }\item[{logical, intent(in)}]{allow\+\_\+doubling,  }\item[{logical, intent(in)}]{allow\+\_\+halving }\end{DoxyParamCaption})}



Scale the weighting of the given group/class by the given ratio, altering particle number as necessary to preserve the number concentration. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em aero\+\_\+state} & Aerosol state.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\mbox{\tt in}  & {\em i\+\_\+group} & Weight group number.\\
\hline
\mbox{\tt in}  & {\em i\+\_\+class} & Weight class number.\\
\hline
\mbox{\tt in}  & {\em weight\+\_\+ratio} & Ratio of {\ttfamily new\+\_\+weight / old\+\_\+weight}.\\
\hline
\mbox{\tt in}  & {\em allow\+\_\+doubling} & Whether to allow doubling of the population.\\
\hline
\mbox{\tt in}  & {\em allow\+\_\+halving} & Whether to allow halving of the population. \\
\hline
\end{DoxyParams}


Definition at line 1604 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a82d688a836cb8ed88c46dd010247d3c1}\label{namespacepmc__aero__state_a82d688a836cb8ed88c46dd010247d3c1}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+set\+\_\+n\+\_\+part\+\_\+ideal@{aero\+\_\+state\+\_\+set\+\_\+n\+\_\+part\+\_\+ideal}}
\index{aero\+\_\+state\+\_\+set\+\_\+n\+\_\+part\+\_\+ideal@{aero\+\_\+state\+\_\+set\+\_\+n\+\_\+part\+\_\+ideal}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+set\+\_\+n\+\_\+part\+\_\+ideal()}{aero\_state\_set\_n\_part\_ideal()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+set\+\_\+n\+\_\+part\+\_\+ideal (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(inout)}]{aero\+\_\+state,  }\item[{real(kind=dp), intent(in)}]{n\+\_\+part }\end{DoxyParamCaption})}



Set the ideal number of particles to the given value. The {\ttfamily aero\+\_\+state\%awa} must be already set correctly. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em aero\+\_\+state} & Aerosol state (with {\ttfamily aero\+\_\+state\%awa} set).\\
\hline
\mbox{\tt in}  & {\em n\+\_\+part} & Ideal total number of particles. \\
\hline
\end{DoxyParams}


Definition at line 217 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_ae949175272a73f61c851a2ac4a58c712}\label{namespacepmc__aero__state_ae949175272a73f61c851a2ac4a58c712}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+set\+\_\+weight@{aero\+\_\+state\+\_\+set\+\_\+weight}}
\index{aero\+\_\+state\+\_\+set\+\_\+weight@{aero\+\_\+state\+\_\+set\+\_\+weight}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+set\+\_\+weight()}{aero\_state\_set\_weight()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+set\+\_\+weight (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(inout)}]{aero\+\_\+state,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data,  }\item[{integer, intent(in)}]{weight\+\_\+type,  }\item[{real(kind=dp), intent(in), optional}]{exponent }\end{DoxyParamCaption})}



Sets the weighting functions for an {\ttfamily aero\+\_\+state}. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em aero\+\_\+state} & Aerosol to set the weights on.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\mbox{\tt in}  & {\em weight\+\_\+type} & Type of weighting scheme to use.\\
\hline
\mbox{\tt in}  & {\em exponent} & Exponent for power-\/law weighting (only used if {\ttfamily weight\+\_\+type} is {\ttfamily A\+E\+R\+O\+\_\+\+S\+T\+A\+T\+E\+\_\+\+W\+E\+I\+G\+H\+T\+\_\+\+P\+O\+W\+ER}). \\
\hline
\end{DoxyParams}


Definition at line 172 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a6626b0ca62809bfeb3137aba559963d1}\label{namespacepmc__aero__state_a6626b0ca62809bfeb3137aba559963d1}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+sort@{aero\+\_\+state\+\_\+sort}}
\index{aero\+\_\+state\+\_\+sort@{aero\+\_\+state\+\_\+sort}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+sort()}{aero\_state\_sort()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+sort (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(inout)}]{aero\+\_\+state,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data,  }\item[{type(\mbox{\hyperlink{structpmc__bin__grid_1_1bin__grid__t}{bin\+\_\+grid\+\_\+t}}), intent(in), optional}]{bin\+\_\+grid,  }\item[{logical, intent(in), optional}]{all\+\_\+procs\+\_\+same }\end{DoxyParamCaption})}



Sorts the particles if necessary. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em aero\+\_\+state} & Aerosol state to sort.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\mbox{\tt in}  & {\em bin\+\_\+grid} & Bin grid.\\
\hline
\mbox{\tt in}  & {\em all\+\_\+procs\+\_\+same} & Whether all processors should use the same bin grid. \\
\hline
\end{DoxyParams}


Definition at line 2861 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a5535ba7076130a468b1b71a36b64e408}\label{namespacepmc__aero__state_a5535ba7076130a468b1b71a36b64e408}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+to\+\_\+binned@{aero\+\_\+state\+\_\+to\+\_\+binned}}
\index{aero\+\_\+state\+\_\+to\+\_\+binned@{aero\+\_\+state\+\_\+to\+\_\+binned}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+to\+\_\+binned()}{aero\_state\_to\_binned()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+to\+\_\+binned (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__bin__grid_1_1bin__grid__t}{bin\+\_\+grid\+\_\+t}}), intent(in)}]{bin\+\_\+grid,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data,  }\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(in)}]{aero\+\_\+state,  }\item[{type(\mbox{\hyperlink{structpmc__aero__binned_1_1aero__binned__t}{aero\+\_\+binned\+\_\+t}}), intent(inout)}]{aero\+\_\+binned }\end{DoxyParamCaption})}



Create binned number and mass arrays. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em bin\+\_\+grid} & Bin grid.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+state} & Aerosol state.\\
\hline
\mbox{\tt in,out}  & {\em aero\+\_\+binned} & Binned distributions. \\
\hline
\end{DoxyParams}


Definition at line 934 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a9618d3e95a4e97e71b154586a2c8bc25}\label{namespacepmc__aero__state_a9618d3e95a4e97e71b154586a2c8bc25}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+to\+\_\+binned\+\_\+dry@{aero\+\_\+state\+\_\+to\+\_\+binned\+\_\+dry}}
\index{aero\+\_\+state\+\_\+to\+\_\+binned\+\_\+dry@{aero\+\_\+state\+\_\+to\+\_\+binned\+\_\+dry}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+to\+\_\+binned\+\_\+dry()}{aero\_state\_to\_binned\_dry()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+to\+\_\+binned\+\_\+dry (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__bin__grid_1_1bin__grid__t}{bin\+\_\+grid\+\_\+t}}), intent(in)}]{bin\+\_\+grid,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data,  }\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(in)}]{aero\+\_\+state,  }\item[{type(\mbox{\hyperlink{structpmc__aero__binned_1_1aero__binned__t}{aero\+\_\+binned\+\_\+t}}), intent(inout)}]{aero\+\_\+binned }\end{DoxyParamCaption})}



Does the same thing as aero\+\_\+state\+\_\+to\+\_\+bin() but based on dry radius. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em bin\+\_\+grid} & Bin grid.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+state} & Aerosol state.\\
\hline
\mbox{\tt in,out}  & {\em aero\+\_\+binned} & Binned distributions. \\
\hline
\end{DoxyParams}


Definition at line 1432 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a6e7b882b542eb7dd907ec490ea45c29b}\label{namespacepmc__aero__state_a6e7b882b542eb7dd907ec490ea45c29b}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+total\+\_\+num\+\_\+conc@{aero\+\_\+state\+\_\+total\+\_\+num\+\_\+conc}}
\index{aero\+\_\+state\+\_\+total\+\_\+num\+\_\+conc@{aero\+\_\+state\+\_\+total\+\_\+num\+\_\+conc}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+total\+\_\+num\+\_\+conc()}{aero\_state\_total\_num\_conc()}}
{\footnotesize\ttfamily real(kind=dp) function pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+total\+\_\+num\+\_\+conc (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(in)}]{aero\+\_\+state,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data }\end{DoxyParamCaption})}



Returns the total number concentration. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em aero\+\_\+state} & Aerosol state.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data. \\
\hline
\end{DoxyParams}


Definition at line 1205 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a9bfa000bf19e64be5f1cf5aeebabe535}\label{namespacepmc__aero__state_a9bfa000bf19e64be5f1cf5aeebabe535}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+total\+\_\+particles@{aero\+\_\+state\+\_\+total\+\_\+particles}}
\index{aero\+\_\+state\+\_\+total\+\_\+particles@{aero\+\_\+state\+\_\+total\+\_\+particles}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+total\+\_\+particles()}{aero\_state\_total\_particles()}}
{\footnotesize\ttfamily integer function pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+total\+\_\+particles (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(in)}]{aero\+\_\+state,  }\item[{integer, intent(in), optional}]{i\+\_\+group,  }\item[{integer, intent(in), optional}]{i\+\_\+class }\end{DoxyParamCaption})}



Returns the total number of particles in an aerosol distribution. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em aero\+\_\+state} & Aerosol state.\\
\hline
\mbox{\tt in}  & {\em i\+\_\+group} & Weight group.\\
\hline
\mbox{\tt in}  & {\em i\+\_\+class} & Weight class. \\
\hline
\end{DoxyParams}


Definition at line 263 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a38cf96ea2f1a3ee938bda68e93975cae}\label{namespacepmc__aero__state_a38cf96ea2f1a3ee938bda68e93975cae}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+total\+\_\+particles\+\_\+all\+\_\+procs@{aero\+\_\+state\+\_\+total\+\_\+particles\+\_\+all\+\_\+procs}}
\index{aero\+\_\+state\+\_\+total\+\_\+particles\+\_\+all\+\_\+procs@{aero\+\_\+state\+\_\+total\+\_\+particles\+\_\+all\+\_\+procs}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+total\+\_\+particles\+\_\+all\+\_\+procs()}{aero\_state\_total\_particles\_all\_procs()}}
{\footnotesize\ttfamily integer function pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+total\+\_\+particles\+\_\+all\+\_\+procs (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(in)}]{aero\+\_\+state,  }\item[{integer, intent(in), optional}]{i\+\_\+group,  }\item[{integer, intent(in), optional}]{i\+\_\+class }\end{DoxyParamCaption})}



Returns the total number of particles across all processes. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em aero\+\_\+state} & Aerosol state.\\
\hline
\mbox{\tt in}  & {\em i\+\_\+group} & Weight group.\\
\hline
\mbox{\tt in}  & {\em i\+\_\+class} & Weight class. \\
\hline
\end{DoxyParams}


Definition at line 302 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a94804b9cdd9effc574cfb0cc178f329b}\label{namespacepmc__aero__state_a94804b9cdd9effc574cfb0cc178f329b}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+volumes@{aero\+\_\+state\+\_\+volumes}}
\index{aero\+\_\+state\+\_\+volumes@{aero\+\_\+state\+\_\+volumes}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+volumes()}{aero\_state\_volumes()}}
{\footnotesize\ttfamily real(kind=dp) function, dimension(\mbox{\hyperlink{namespacepmc__aero__state_a94155bf7fa94e7c3ab722a5a1dacac98}{aero\+\_\+state\+\_\+n\+\_\+part}}(aero\+\_\+state)) pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+volumes (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(in)}]{aero\+\_\+state,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in), optional}]{aero\+\_\+data,  }\item[{character(len=$\ast$), dimension(\+:), intent(in), optional}]{include,  }\item[{character(len=$\ast$), dimension(\+:), intent(in), optional}]{exclude }\end{DoxyParamCaption})}



Returns the volumes of all particles. 

If {\ttfamily include} is specified then only those species are included in computing the volumes. If {\ttfamily exclude} is specified then all species except those species are included. If both {\ttfamily include} and {\ttfamily exclude} arguments are specified then only those species in {\ttfamily include} but not in {\ttfamily exclude} are included.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em aero\+\_\+state} & Aerosol state.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\mbox{\tt in}  & {\em include} & Species names to include in the mass.\\
\hline
\mbox{\tt in}  & {\em exclude} & Species names to exclude in the mass.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Return volumes array (m$^\wedge$3). 
\end{DoxyReturn}


Definition at line 1060 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a070d20781c622419c7823654680595b4}\label{namespacepmc__aero__state_a070d20781c622419c7823654680595b4}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+weight\+\_\+class\+\_\+for\+\_\+source@{aero\+\_\+state\+\_\+weight\+\_\+class\+\_\+for\+\_\+source}}
\index{aero\+\_\+state\+\_\+weight\+\_\+class\+\_\+for\+\_\+source@{aero\+\_\+state\+\_\+weight\+\_\+class\+\_\+for\+\_\+source}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+weight\+\_\+class\+\_\+for\+\_\+source()}{aero\_state\_weight\_class\_for\_source()}}
{\footnotesize\ttfamily integer function pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+weight\+\_\+class\+\_\+for\+\_\+source (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(in)}]{aero\+\_\+state,  }\item[{integer, intent(in)}]{source }\end{DoxyParamCaption})}



Determine the appropriate weight class for a source. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em aero\+\_\+state} & Aerosol state.\\
\hline
\mbox{\tt in}  & {\em source} & Source to find the class for. \\
\hline
\end{DoxyParams}


Definition at line 239 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a748f903f70f90956fc02765c46f5e541}\label{namespacepmc__aero__state_a748f903f70f90956fc02765c46f5e541}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+zero@{aero\+\_\+state\+\_\+zero}}
\index{aero\+\_\+state\+\_\+zero@{aero\+\_\+state\+\_\+zero}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+zero()}{aero\_state\_zero()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+zero (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(inout)}]{aero\+\_\+state }\end{DoxyParamCaption})}



Resets an aero\+\_\+state to have zero particles per bin. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em aero\+\_\+state} & State to zero. \\
\hline
\end{DoxyParams}


Definition at line 320 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a4123bbc6bc887c5d4b7a6feae25be534}\label{namespacepmc__aero__state_a4123bbc6bc887c5d4b7a6feae25be534}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!pmc\+\_\+mpi\+\_\+pack\+\_\+aero\+\_\+state@{pmc\+\_\+mpi\+\_\+pack\+\_\+aero\+\_\+state}}
\index{pmc\+\_\+mpi\+\_\+pack\+\_\+aero\+\_\+state@{pmc\+\_\+mpi\+\_\+pack\+\_\+aero\+\_\+state}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{pmc\+\_\+mpi\+\_\+pack\+\_\+aero\+\_\+state()}{pmc\_mpi\_pack\_aero\_state()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::pmc\+\_\+mpi\+\_\+pack\+\_\+aero\+\_\+state (\begin{DoxyParamCaption}\item[{character, dimension(\+:), intent(inout)}]{buffer,  }\item[{integer, intent(inout)}]{position,  }\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(in)}]{val }\end{DoxyParamCaption})}



Packs the given value into the buffer, advancing position. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em buffer} & Memory buffer.\\
\hline
\mbox{\tt in,out}  & {\em position} & Current buffer position.\\
\hline
\mbox{\tt in}  & {\em val} & Value to pack. \\
\hline
\end{DoxyParams}


Definition at line 2129 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a9f65a578f1f08ed22c56a96686743cfd}\label{namespacepmc__aero__state_a9f65a578f1f08ed22c56a96686743cfd}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!pmc\+\_\+mpi\+\_\+pack\+\_\+size\+\_\+aero\+\_\+state@{pmc\+\_\+mpi\+\_\+pack\+\_\+size\+\_\+aero\+\_\+state}}
\index{pmc\+\_\+mpi\+\_\+pack\+\_\+size\+\_\+aero\+\_\+state@{pmc\+\_\+mpi\+\_\+pack\+\_\+size\+\_\+aero\+\_\+state}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{pmc\+\_\+mpi\+\_\+pack\+\_\+size\+\_\+aero\+\_\+state()}{pmc\_mpi\_pack\_size\_aero\_state()}}
{\footnotesize\ttfamily integer function pmc\+\_\+aero\+\_\+state\+::pmc\+\_\+mpi\+\_\+pack\+\_\+size\+\_\+aero\+\_\+state (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(in)}]{val }\end{DoxyParamCaption})}



Determines the number of bytes required to pack the given value. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em val} & Value to pack. \\
\hline
\end{DoxyParams}


Definition at line 2110 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a1fbfce661ac4cf88b383e88a44e0a9b6}\label{namespacepmc__aero__state_a1fbfce661ac4cf88b383e88a44e0a9b6}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!pmc\+\_\+mpi\+\_\+unpack\+\_\+aero\+\_\+state@{pmc\+\_\+mpi\+\_\+unpack\+\_\+aero\+\_\+state}}
\index{pmc\+\_\+mpi\+\_\+unpack\+\_\+aero\+\_\+state@{pmc\+\_\+mpi\+\_\+unpack\+\_\+aero\+\_\+state}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{pmc\+\_\+mpi\+\_\+unpack\+\_\+aero\+\_\+state()}{pmc\_mpi\_unpack\_aero\_state()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+aero\+\_\+state\+::pmc\+\_\+mpi\+\_\+unpack\+\_\+aero\+\_\+state (\begin{DoxyParamCaption}\item[{character, dimension(\+:), intent(inout)}]{buffer,  }\item[{integer, intent(inout)}]{position,  }\item[{type(\mbox{\hyperlink{structpmc__aero__state_1_1aero__state__t}{aero\+\_\+state\+\_\+t}}), intent(inout)}]{val }\end{DoxyParamCaption})}



Unpacks the given value from the buffer, advancing position. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em buffer} & Memory buffer.\\
\hline
\mbox{\tt in,out}  & {\em position} & Current buffer position.\\
\hline
\mbox{\tt in,out}  & {\em val} & Value to pack. \\
\hline
\end{DoxyParams}


Definition at line 2155 of file aero\+\_\+state.\+F90.



\subsection{Variable Documentation}
\mbox{\Hypertarget{namespacepmc__aero__state_a8016b38f6c38806de95b72ffaecbe212}\label{namespacepmc__aero__state_a8016b38f6c38806de95b72ffaecbe212}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+tag\+\_\+gather@{aero\+\_\+state\+\_\+tag\+\_\+gather}}
\index{aero\+\_\+state\+\_\+tag\+\_\+gather@{aero\+\_\+state\+\_\+tag\+\_\+gather}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+tag\+\_\+gather}{aero\_state\_tag\_gather}}
{\footnotesize\ttfamily integer, parameter pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+tag\+\_\+gather = 4988}



M\+PI tag for gathering between processes. 



Definition at line 34 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a585d061ace6ecfefa6eaadeb8efbeb5d}\label{namespacepmc__aero__state_a585d061ace6ecfefa6eaadeb8efbeb5d}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+tag\+\_\+mix@{aero\+\_\+state\+\_\+tag\+\_\+mix}}
\index{aero\+\_\+state\+\_\+tag\+\_\+mix@{aero\+\_\+state\+\_\+tag\+\_\+mix}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+tag\+\_\+mix}{aero\_state\_tag\_mix}}
{\footnotesize\ttfamily integer, parameter pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+tag\+\_\+mix = 4987}



M\+PI tag for mixing particles between processes. 



Definition at line 32 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a47a81bec0174512abf54faf2673da5c3}\label{namespacepmc__aero__state_a47a81bec0174512abf54faf2673da5c3}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+tag\+\_\+scatter@{aero\+\_\+state\+\_\+tag\+\_\+scatter}}
\index{aero\+\_\+state\+\_\+tag\+\_\+scatter@{aero\+\_\+state\+\_\+tag\+\_\+scatter}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+tag\+\_\+scatter}{aero\_state\_tag\_scatter}}
{\footnotesize\ttfamily integer, parameter pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+tag\+\_\+scatter = 4989}



M\+PI tag for scattering between processes. 



Definition at line 36 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a72b0c9b3118a486936fe3c50c4d908f6}\label{namespacepmc__aero__state_a72b0c9b3118a486936fe3c50c4d908f6}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+weight\+\_\+flat@{aero\+\_\+state\+\_\+weight\+\_\+flat}}
\index{aero\+\_\+state\+\_\+weight\+\_\+flat@{aero\+\_\+state\+\_\+weight\+\_\+flat}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+weight\+\_\+flat}{aero\_state\_weight\_flat}}
{\footnotesize\ttfamily integer, parameter pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+weight\+\_\+flat = 2}



Single flat weighting scheme. 



Definition at line 41 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_af731fa16fa6f5f7dcb5dde7bc5118b5a}\label{namespacepmc__aero__state_af731fa16fa6f5f7dcb5dde7bc5118b5a}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+weight\+\_\+flat\+\_\+source@{aero\+\_\+state\+\_\+weight\+\_\+flat\+\_\+source}}
\index{aero\+\_\+state\+\_\+weight\+\_\+flat\+\_\+source@{aero\+\_\+state\+\_\+weight\+\_\+flat\+\_\+source}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+weight\+\_\+flat\+\_\+source}{aero\_state\_weight\_flat\_source}}
{\footnotesize\ttfamily integer, parameter pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+weight\+\_\+flat\+\_\+source = 5}



Flat weighting by source. 



Definition at line 47 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_afae976ee50ab7c0415628dd99a6feded}\label{namespacepmc__aero__state_afae976ee50ab7c0415628dd99a6feded}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+weight\+\_\+none@{aero\+\_\+state\+\_\+weight\+\_\+none}}
\index{aero\+\_\+state\+\_\+weight\+\_\+none@{aero\+\_\+state\+\_\+weight\+\_\+none}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+weight\+\_\+none}{aero\_state\_weight\_none}}
{\footnotesize\ttfamily integer, parameter pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+weight\+\_\+none = 1}



Single flat weighting scheme. 



Definition at line 39 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_aa014d0549b2455e245bef4959b781af3}\label{namespacepmc__aero__state_aa014d0549b2455e245bef4959b781af3}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+weight\+\_\+nummass@{aero\+\_\+state\+\_\+weight\+\_\+nummass}}
\index{aero\+\_\+state\+\_\+weight\+\_\+nummass@{aero\+\_\+state\+\_\+weight\+\_\+nummass}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+weight\+\_\+nummass}{aero\_state\_weight\_nummass}}
{\footnotesize\ttfamily integer, parameter pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+weight\+\_\+nummass = 4}



Coupled number/mass weighting scheme. 



Definition at line 45 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a22b883c1a2ba3797a44ab2a4104c9d2a}\label{namespacepmc__aero__state_a22b883c1a2ba3797a44ab2a4104c9d2a}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+weight\+\_\+nummass\+\_\+source@{aero\+\_\+state\+\_\+weight\+\_\+nummass\+\_\+source}}
\index{aero\+\_\+state\+\_\+weight\+\_\+nummass\+\_\+source@{aero\+\_\+state\+\_\+weight\+\_\+nummass\+\_\+source}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+weight\+\_\+nummass\+\_\+source}{aero\_state\_weight\_nummass\_source}}
{\footnotesize\ttfamily integer, parameter pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+weight\+\_\+nummass\+\_\+source = 7}



Coupled number/mass weighting by source. 



Definition at line 51 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a2c80e8cba61697786d2302e44cd041bd}\label{namespacepmc__aero__state_a2c80e8cba61697786d2302e44cd041bd}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+weight\+\_\+power@{aero\+\_\+state\+\_\+weight\+\_\+power}}
\index{aero\+\_\+state\+\_\+weight\+\_\+power@{aero\+\_\+state\+\_\+weight\+\_\+power}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+weight\+\_\+power}{aero\_state\_weight\_power}}
{\footnotesize\ttfamily integer, parameter pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+weight\+\_\+power = 3}



Power-\/law weighting scheme. 



Definition at line 43 of file aero\+\_\+state.\+F90.

\mbox{\Hypertarget{namespacepmc__aero__state_a496284ecee4a72a18a45e67f5c17e610}\label{namespacepmc__aero__state_a496284ecee4a72a18a45e67f5c17e610}} 
\index{pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}!aero\+\_\+state\+\_\+weight\+\_\+power\+\_\+source@{aero\+\_\+state\+\_\+weight\+\_\+power\+\_\+source}}
\index{aero\+\_\+state\+\_\+weight\+\_\+power\+\_\+source@{aero\+\_\+state\+\_\+weight\+\_\+power\+\_\+source}!pmc\+\_\+aero\+\_\+state@{pmc\+\_\+aero\+\_\+state}}
\subsubsection{\texorpdfstring{aero\+\_\+state\+\_\+weight\+\_\+power\+\_\+source}{aero\_state\_weight\_power\_source}}
{\footnotesize\ttfamily integer, parameter pmc\+\_\+aero\+\_\+state\+::aero\+\_\+state\+\_\+weight\+\_\+power\+\_\+source = 6}



Power-\/law weighting by source. 



Definition at line 49 of file aero\+\_\+state.\+F90.

