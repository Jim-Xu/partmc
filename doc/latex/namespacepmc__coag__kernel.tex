\hypertarget{namespacepmc__coag__kernel}{}\section{pmc\+\_\+coag\+\_\+kernel Module Reference}
\label{namespacepmc__coag__kernel}\index{pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}}


Generic coagulation kernel.  


\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
character(len=\mbox{\hyperlink{namespacepmc__coag__kernel_a5b9c2196146dafb206c5442d2c928559}{coag\+\_\+kernel\+\_\+type\+\_\+len}}) function \mbox{\hyperlink{namespacepmc__coag__kernel_a936dec49a171f5c431e47fa7c297409b}{coag\+\_\+kernel\+\_\+type\+\_\+to\+\_\+string}} (coag\+\_\+kernel\+\_\+type)
\begin{DoxyCompactList}\small\item\em Return a string representation of a kernel type. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__coag__kernel_aaecec4cf362a3631e2b30f382c62b343}{kernel}} (coag\+\_\+kernel\+\_\+type, aero\+\_\+particle\+\_\+1, aero\+\_\+particle\+\_\+2, aero\+\_\+data, env\+\_\+state, k)
\begin{DoxyCompactList}\small\item\em Evalulate a coagulation kernel function. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__coag__kernel_a5c6cf663a5f3f664e52ed5b979fb9fd3}{kernel\+\_\+minmax}} (coag\+\_\+kernel\+\_\+type, v1, v2, aero\+\_\+data, env\+\_\+state, k\+\_\+min, k\+\_\+max)
\begin{DoxyCompactList}\small\item\em Compute the minimum and maximum coagulation kernel. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__coag__kernel_a346752606a43c3b5348ff3f47a4e0d17}{num\+\_\+conc\+\_\+weighted\+\_\+kernel}} (coag\+\_\+kernel\+\_\+type, aero\+\_\+particle\+\_\+1, aero\+\_\+particle\+\_\+2, i\+\_\+class, j\+\_\+class, ij\+\_\+class, aero\+\_\+data, aero\+\_\+weight\+\_\+array, env\+\_\+state, k)
\begin{DoxyCompactList}\small\item\em Compute the kernel value with the given number concentration weighting. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__coag__kernel_a8e624c7ffea2d3cb1b91778b178240da}{bin\+\_\+kernel}} (n\+\_\+bin, bin\+\_\+r, aero\+\_\+data, coag\+\_\+kernel\+\_\+type, env\+\_\+state, k)
\begin{DoxyCompactList}\small\item\em Computes an array of kernel values for each bin pair. k(i,j) is the kernel value at the centers of bins i and j. This assumes the kernel is only a function of the particle volumes. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__coag__kernel_a3081c503d797de18f273fdc785e2b358}{est\+\_\+k\+\_\+minmax\+\_\+binned\+\_\+unweighted}} (bin\+\_\+grid, coag\+\_\+kernel\+\_\+type, aero\+\_\+data, env\+\_\+state, k\+\_\+min, k\+\_\+max)
\begin{DoxyCompactList}\small\item\em Estimate an array of minimum and maximum kernel values. Given particles v1 in bin b1 and v2 in bin b2, it is probably true that {\ttfamily k\+\_\+min(b1,b2) $<$= kernel(v1,v2) $<$= k\+\_\+max(b1,b2)}. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__coag__kernel_a3930ee7fd2fbb2c326683ad6b9c08185}{est\+\_\+k\+\_\+minmax\+\_\+for\+\_\+bin\+\_\+unweighted}} (bin\+\_\+grid, coag\+\_\+kernel\+\_\+type, b1, b2, aero\+\_\+data, env\+\_\+state, k\+\_\+min, k\+\_\+max)
\begin{DoxyCompactList}\small\item\em Samples within bins b1 and b2 to find the minimum and maximum value of the kernel between particles from the two bins. \end{DoxyCompactList}\item 
real(kind=dp) function \mbox{\hyperlink{namespacepmc__coag__kernel_a39c314a4ab6418c6c6ff1fc12678de26}{coag\+\_\+num\+\_\+conc\+\_\+factor}} (aero\+\_\+weight\+\_\+array, aero\+\_\+data, i\+\_\+r, j\+\_\+r, i\+\_\+class, j\+\_\+class, ij\+\_\+class)
\begin{DoxyCompactList}\small\item\em Coagulation scale factor due to number concentrations. \end{DoxyCompactList}\item 
integer function \mbox{\hyperlink{namespacepmc__coag__kernel_a472f1cb2e3d50f1d44c1cb3a55df568b}{coag\+\_\+dest\+\_\+class}} (aero\+\_\+weight\+\_\+array, aero\+\_\+data, bin\+\_\+grid, i\+\_\+bin, j\+\_\+bin, i\+\_\+class, j\+\_\+class)
\begin{DoxyCompactList}\small\item\em Determine the weight class in which coagulated particles will be placed. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__coag__kernel_aff06e0cba11c675531b31fee88244d74}{max\+\_\+coag\+\_\+num\+\_\+conc\+\_\+factor}} (aero\+\_\+weight\+\_\+array, aero\+\_\+data, bin\+\_\+grid, i\+\_\+bin, j\+\_\+bin, i\+\_\+class, j\+\_\+class, ij\+\_\+class, f\+\_\+max)
\begin{DoxyCompactList}\small\item\em Determine the minimum and maximum number concentration factors for coagulation. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
integer, parameter \mbox{\hyperlink{namespacepmc__coag__kernel_a5b9c2196146dafb206c5442d2c928559}{coag\+\_\+kernel\+\_\+type\+\_\+len}} = 20
\begin{DoxyCompactList}\small\item\em Maximum length of a mode type. \end{DoxyCompactList}\item 
integer, parameter \mbox{\hyperlink{namespacepmc__coag__kernel_a299db166a8c9252d1ee80b1bab04270b}{coag\+\_\+kernel\+\_\+type\+\_\+invalid}} = 0
\begin{DoxyCompactList}\small\item\em Type code for an undefined or invalid kernel. \end{DoxyCompactList}\item 
integer, parameter \mbox{\hyperlink{namespacepmc__coag__kernel_acc427a94f9c674be417fa4eb397cd808}{coag\+\_\+kernel\+\_\+type\+\_\+sedi}} = 1
\begin{DoxyCompactList}\small\item\em Type code for a sedimentation kernel. \end{DoxyCompactList}\item 
integer, parameter \mbox{\hyperlink{namespacepmc__coag__kernel_a75f7fd7b7f1f6d38bb03828c46e1be66}{coag\+\_\+kernel\+\_\+type\+\_\+additive}} = 2
\begin{DoxyCompactList}\small\item\em Type code for an additive kernel. \end{DoxyCompactList}\item 
integer, parameter \mbox{\hyperlink{namespacepmc__coag__kernel_a6706cc1fc48d83cd5fbca4bba57d60b2}{coag\+\_\+kernel\+\_\+type\+\_\+constant}} = 3
\begin{DoxyCompactList}\small\item\em Type code for a constant kernel. \end{DoxyCompactList}\item 
integer, parameter \mbox{\hyperlink{namespacepmc__coag__kernel_aa6a324c3d911cbc50a287ebb1b873535}{coag\+\_\+kernel\+\_\+type\+\_\+brown}} = 4
\begin{DoxyCompactList}\small\item\em Type code for a Brownian kernel. \end{DoxyCompactList}\item 
integer, parameter \mbox{\hyperlink{namespacepmc__coag__kernel_a6d75eae86113c1790f98fe66147bcdcc}{coag\+\_\+kernel\+\_\+type\+\_\+zero}} = 5
\begin{DoxyCompactList}\small\item\em Type code for a zero kernel. \end{DoxyCompactList}\item 
integer, parameter \mbox{\hyperlink{namespacepmc__coag__kernel_ac11bbcea41051f4b2e16769f2a78fc94}{coag\+\_\+kernel\+\_\+type\+\_\+brown\+\_\+free}} = 6
\begin{DoxyCompactList}\small\item\em Type code for a Brownian kernel in free molecular regime from Vemury and Pratsinis \mbox{[}1995\mbox{]}. \end{DoxyCompactList}\item 
integer, parameter \mbox{\hyperlink{namespacepmc__coag__kernel_ad1ce21ef5a0a9dff8f2efe6267f22c52}{coag\+\_\+kernel\+\_\+type\+\_\+brown\+\_\+cont}} = 7
\begin{DoxyCompactList}\small\item\em Type code for a Brownian kernel in continuum regime from Vemury and Pratsinis \mbox{[}1995\mbox{]}. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Generic coagulation kernel. 

\subsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacepmc__coag__kernel_a8e624c7ffea2d3cb1b91778b178240da}\label{namespacepmc__coag__kernel_a8e624c7ffea2d3cb1b91778b178240da}} 
\index{pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}!bin\+\_\+kernel@{bin\+\_\+kernel}}
\index{bin\+\_\+kernel@{bin\+\_\+kernel}!pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}}
\subsubsection{\texorpdfstring{bin\+\_\+kernel()}{bin\_kernel()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+coag\+\_\+kernel\+::bin\+\_\+kernel (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{n\+\_\+bin,  }\item[{real(kind=dp), dimension(n\+\_\+bin), intent(in)}]{bin\+\_\+r,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data,  }\item[{integer, intent(in)}]{coag\+\_\+kernel\+\_\+type,  }\item[{type(\mbox{\hyperlink{structpmc__env__state_1_1env__state__t}{env\+\_\+state\+\_\+t}}), intent(in)}]{env\+\_\+state,  }\item[{real(kind=dp), dimension(n\+\_\+bin,n\+\_\+bin), intent(out)}]{k }\end{DoxyParamCaption})}



Computes an array of kernel values for each bin pair. k(i,j) is the kernel value at the centers of bins i and j. This assumes the kernel is only a function of the particle volumes. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em n\+\_\+bin} & Number of bins.\\
\hline
\mbox{\tt in}  & {\em bin\+\_\+r} & Radii of particles in bins (m).\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\mbox{\tt in}  & {\em coag\+\_\+kernel\+\_\+type} & Coagulation kernel type.\\
\hline
\mbox{\tt in}  & {\em env\+\_\+state} & Environment state.\\
\hline
\mbox{\tt out}  & {\em k} & Kernel values. \\
\hline
\end{DoxyParams}


Definition at line 218 of file coag\+\_\+kernel.\+F90.

\mbox{\Hypertarget{namespacepmc__coag__kernel_a472f1cb2e3d50f1d44c1cb3a55df568b}\label{namespacepmc__coag__kernel_a472f1cb2e3d50f1d44c1cb3a55df568b}} 
\index{pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}!coag\+\_\+dest\+\_\+class@{coag\+\_\+dest\+\_\+class}}
\index{coag\+\_\+dest\+\_\+class@{coag\+\_\+dest\+\_\+class}!pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}}
\subsubsection{\texorpdfstring{coag\+\_\+dest\+\_\+class()}{coag\_dest\_class()}}
{\footnotesize\ttfamily integer function pmc\+\_\+coag\+\_\+kernel\+::coag\+\_\+dest\+\_\+class (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__weight__array_1_1aero__weight__array__t}{aero\+\_\+weight\+\_\+array\+\_\+t}}), intent(in)}]{aero\+\_\+weight\+\_\+array,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data,  }\item[{type(\mbox{\hyperlink{structpmc__bin__grid_1_1bin__grid__t}{bin\+\_\+grid\+\_\+t}}), intent(in)}]{bin\+\_\+grid,  }\item[{integer, intent(in)}]{i\+\_\+bin,  }\item[{integer, intent(in)}]{j\+\_\+bin,  }\item[{integer, intent(in)}]{i\+\_\+class,  }\item[{integer, intent(in)}]{j\+\_\+class }\end{DoxyParamCaption})}



Determine the weight class in which coagulated particles will be placed. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em aero\+\_\+weight\+\_\+array} & Aerosol weight array.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\mbox{\tt in}  & {\em bin\+\_\+grid} & Bin grid.\\
\hline
\mbox{\tt in}  & {\em i\+\_\+bin} & First bin number.\\
\hline
\mbox{\tt in}  & {\em j\+\_\+bin} & Second bin number.\\
\hline
\mbox{\tt in}  & {\em i\+\_\+class} & Weight class of first particle.\\
\hline
\mbox{\tt in}  & {\em j\+\_\+class} & Weight class of second particle. \\
\hline
\end{DoxyParams}


Definition at line 384 of file coag\+\_\+kernel.\+F90.

\mbox{\Hypertarget{namespacepmc__coag__kernel_a936dec49a171f5c431e47fa7c297409b}\label{namespacepmc__coag__kernel_a936dec49a171f5c431e47fa7c297409b}} 
\index{pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}!coag\+\_\+kernel\+\_\+type\+\_\+to\+\_\+string@{coag\+\_\+kernel\+\_\+type\+\_\+to\+\_\+string}}
\index{coag\+\_\+kernel\+\_\+type\+\_\+to\+\_\+string@{coag\+\_\+kernel\+\_\+type\+\_\+to\+\_\+string}!pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}}
\subsubsection{\texorpdfstring{coag\+\_\+kernel\+\_\+type\+\_\+to\+\_\+string()}{coag\_kernel\_type\_to\_string()}}
{\footnotesize\ttfamily character(len=\mbox{\hyperlink{namespacepmc__coag__kernel_a5b9c2196146dafb206c5442d2c928559}{coag\+\_\+kernel\+\_\+type\+\_\+len}}) function pmc\+\_\+coag\+\_\+kernel\+::coag\+\_\+kernel\+\_\+type\+\_\+to\+\_\+string (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{coag\+\_\+kernel\+\_\+type }\end{DoxyParamCaption})}



Return a string representation of a kernel type. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em coag\+\_\+kernel\+\_\+type} & Coagulation kernel type. \\
\hline
\end{DoxyParams}


Definition at line 54 of file coag\+\_\+kernel.\+F90.

\mbox{\Hypertarget{namespacepmc__coag__kernel_a39c314a4ab6418c6c6ff1fc12678de26}\label{namespacepmc__coag__kernel_a39c314a4ab6418c6c6ff1fc12678de26}} 
\index{pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}!coag\+\_\+num\+\_\+conc\+\_\+factor@{coag\+\_\+num\+\_\+conc\+\_\+factor}}
\index{coag\+\_\+num\+\_\+conc\+\_\+factor@{coag\+\_\+num\+\_\+conc\+\_\+factor}!pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}}
\subsubsection{\texorpdfstring{coag\+\_\+num\+\_\+conc\+\_\+factor()}{coag\_num\_conc\_factor()}}
{\footnotesize\ttfamily real(kind=dp) function pmc\+\_\+coag\+\_\+kernel\+::coag\+\_\+num\+\_\+conc\+\_\+factor (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__weight__array_1_1aero__weight__array__t}{aero\+\_\+weight\+\_\+array\+\_\+t}}), intent(in)}]{aero\+\_\+weight\+\_\+array,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data,  }\item[{real(kind=dp), intent(in)}]{i\+\_\+r,  }\item[{real(kind=dp), intent(in)}]{j\+\_\+r,  }\item[{integer, intent(in)}]{i\+\_\+class,  }\item[{integer, intent(in)}]{j\+\_\+class,  }\item[{integer, intent(in)}]{ij\+\_\+class }\end{DoxyParamCaption})}



Coagulation scale factor due to number concentrations. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em aero\+\_\+weight\+\_\+array} & Aerosol weight array.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\mbox{\tt in}  & {\em i\+\_\+r} & Radius of first particle.\\
\hline
\mbox{\tt in}  & {\em j\+\_\+r} & Radius of second particle.\\
\hline
\mbox{\tt in}  & {\em i\+\_\+class} & Weight class of first particle.\\
\hline
\mbox{\tt in}  & {\em j\+\_\+class} & Weight class of second particle.\\
\hline
\mbox{\tt in}  & {\em ij\+\_\+class} & Weight class of combined particle. \\
\hline
\end{DoxyParams}


Definition at line 348 of file coag\+\_\+kernel.\+F90.

\mbox{\Hypertarget{namespacepmc__coag__kernel_a3081c503d797de18f273fdc785e2b358}\label{namespacepmc__coag__kernel_a3081c503d797de18f273fdc785e2b358}} 
\index{pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}!est\+\_\+k\+\_\+minmax\+\_\+binned\+\_\+unweighted@{est\+\_\+k\+\_\+minmax\+\_\+binned\+\_\+unweighted}}
\index{est\+\_\+k\+\_\+minmax\+\_\+binned\+\_\+unweighted@{est\+\_\+k\+\_\+minmax\+\_\+binned\+\_\+unweighted}!pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}}
\subsubsection{\texorpdfstring{est\+\_\+k\+\_\+minmax\+\_\+binned\+\_\+unweighted()}{est\_k\_minmax\_binned\_unweighted()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+coag\+\_\+kernel\+::est\+\_\+k\+\_\+minmax\+\_\+binned\+\_\+unweighted (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__bin__grid_1_1bin__grid__t}{bin\+\_\+grid\+\_\+t}}), intent(in)}]{bin\+\_\+grid,  }\item[{integer, intent(in)}]{coag\+\_\+kernel\+\_\+type,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data,  }\item[{type(\mbox{\hyperlink{structpmc__env__state_1_1env__state__t}{env\+\_\+state\+\_\+t}}), intent(in)}]{env\+\_\+state,  }\item[{real(kind=dp), dimension(bin\+\_\+grid\+\_\+size(bin\+\_\+grid),          bin\+\_\+grid\+\_\+size(bin\+\_\+grid)), intent(out)}]{k\+\_\+min,  }\item[{real(kind=dp), dimension(bin\+\_\+grid\+\_\+size(bin\+\_\+grid),          bin\+\_\+grid\+\_\+size(bin\+\_\+grid)), intent(out)}]{k\+\_\+max }\end{DoxyParamCaption})}



Estimate an array of minimum and maximum kernel values. Given particles v1 in bin b1 and v2 in bin b2, it is probably true that {\ttfamily k\+\_\+min(b1,b2) $<$= kernel(v1,v2) $<$= k\+\_\+max(b1,b2)}. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em bin\+\_\+grid} & Bin\+\_\+grid.\\
\hline
\mbox{\tt in}  & {\em coag\+\_\+kernel\+\_\+type} & Coagulation kernel type.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\mbox{\tt in}  & {\em env\+\_\+state} & Environment state.\\
\hline
\mbox{\tt out}  & {\em k\+\_\+min} & Minimum kernel vals.\\
\hline
\mbox{\tt out}  & {\em k\+\_\+max} & Maximum kernel vals. \\
\hline
\end{DoxyParams}


Definition at line 255 of file coag\+\_\+kernel.\+F90.

\mbox{\Hypertarget{namespacepmc__coag__kernel_a3930ee7fd2fbb2c326683ad6b9c08185}\label{namespacepmc__coag__kernel_a3930ee7fd2fbb2c326683ad6b9c08185}} 
\index{pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}!est\+\_\+k\+\_\+minmax\+\_\+for\+\_\+bin\+\_\+unweighted@{est\+\_\+k\+\_\+minmax\+\_\+for\+\_\+bin\+\_\+unweighted}}
\index{est\+\_\+k\+\_\+minmax\+\_\+for\+\_\+bin\+\_\+unweighted@{est\+\_\+k\+\_\+minmax\+\_\+for\+\_\+bin\+\_\+unweighted}!pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}}
\subsubsection{\texorpdfstring{est\+\_\+k\+\_\+minmax\+\_\+for\+\_\+bin\+\_\+unweighted()}{est\_k\_minmax\_for\_bin\_unweighted()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+coag\+\_\+kernel\+::est\+\_\+k\+\_\+minmax\+\_\+for\+\_\+bin\+\_\+unweighted (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__bin__grid_1_1bin__grid__t}{bin\+\_\+grid\+\_\+t}}), intent(in)}]{bin\+\_\+grid,  }\item[{integer, intent(in)}]{coag\+\_\+kernel\+\_\+type,  }\item[{integer, intent(in)}]{b1,  }\item[{integer, intent(in)}]{b2,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data,  }\item[{type(\mbox{\hyperlink{structpmc__env__state_1_1env__state__t}{env\+\_\+state\+\_\+t}}), intent(in)}]{env\+\_\+state,  }\item[{real(kind=dp), intent(out)}]{k\+\_\+min,  }\item[{real(kind=dp), intent(out)}]{k\+\_\+max }\end{DoxyParamCaption})}



Samples within bins b1 and b2 to find the minimum and maximum value of the kernel between particles from the two bins. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em bin\+\_\+grid} & Bin\+\_\+grid.\\
\hline
\mbox{\tt in}  & {\em coag\+\_\+kernel\+\_\+type} & Coagulation kernel type.\\
\hline
\mbox{\tt in}  & {\em b1} & First bin.\\
\hline
\mbox{\tt in}  & {\em b2} & Second bin.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\mbox{\tt in}  & {\em env\+\_\+state} & Environment state.\\
\hline
\mbox{\tt out}  & {\em k\+\_\+min} & Minimum kernel value.\\
\hline
\mbox{\tt out}  & {\em k\+\_\+max} & Maximum kernel value. \\
\hline
\end{DoxyParams}
Number of sample points per bin.

Over-\/estimation scale factor parameter. 

Definition at line 288 of file coag\+\_\+kernel.\+F90.

\mbox{\Hypertarget{namespacepmc__coag__kernel_aaecec4cf362a3631e2b30f382c62b343}\label{namespacepmc__coag__kernel_aaecec4cf362a3631e2b30f382c62b343}} 
\index{pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}!kernel@{kernel}}
\index{kernel@{kernel}!pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}}
\subsubsection{\texorpdfstring{kernel()}{kernel()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+coag\+\_\+kernel\+::kernel (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{coag\+\_\+kernel\+\_\+type,  }\item[{type(\mbox{\hyperlink{structpmc__aero__particle_1_1aero__particle__t}{aero\+\_\+particle\+\_\+t}}), intent(in)}]{aero\+\_\+particle\+\_\+1,  }\item[{type(\mbox{\hyperlink{structpmc__aero__particle_1_1aero__particle__t}{aero\+\_\+particle\+\_\+t}}), intent(in)}]{aero\+\_\+particle\+\_\+2,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data,  }\item[{type(\mbox{\hyperlink{structpmc__env__state_1_1env__state__t}{env\+\_\+state\+\_\+t}}), intent(in)}]{env\+\_\+state,  }\item[{real(kind=dp), intent(out)}]{k }\end{DoxyParamCaption})}



Evalulate a coagulation kernel function. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em coag\+\_\+kernel\+\_\+type} & Coagulation kernel type.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+particle\+\_\+1} & First particle.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+particle\+\_\+2} & Second particle.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\mbox{\tt in}  & {\em env\+\_\+state} & Environment state.\\
\hline
\mbox{\tt out}  & {\em k} & Kernel k(a,b) (m$^\wedge$3/s). \\
\hline
\end{DoxyParams}


Definition at line 85 of file coag\+\_\+kernel.\+F90.

\mbox{\Hypertarget{namespacepmc__coag__kernel_a5c6cf663a5f3f664e52ed5b979fb9fd3}\label{namespacepmc__coag__kernel_a5c6cf663a5f3f664e52ed5b979fb9fd3}} 
\index{pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}!kernel\+\_\+minmax@{kernel\+\_\+minmax}}
\index{kernel\+\_\+minmax@{kernel\+\_\+minmax}!pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}}
\subsubsection{\texorpdfstring{kernel\+\_\+minmax()}{kernel\_minmax()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+coag\+\_\+kernel\+::kernel\+\_\+minmax (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{coag\+\_\+kernel\+\_\+type,  }\item[{real(kind=dp), intent(in)}]{v1,  }\item[{real(kind=dp), intent(in)}]{v2,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data,  }\item[{type(\mbox{\hyperlink{structpmc__env__state_1_1env__state__t}{env\+\_\+state\+\_\+t}}), intent(in)}]{env\+\_\+state,  }\item[{real(kind=dp), intent(out)}]{k\+\_\+min,  }\item[{real(kind=dp), intent(out)}]{k\+\_\+max }\end{DoxyParamCaption})}



Compute the minimum and maximum coagulation kernel. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em coag\+\_\+kernel\+\_\+type} & Coagulation kernel type.\\
\hline
\mbox{\tt in}  & {\em v1} & Volume of first particle (m$^\wedge$3).\\
\hline
\mbox{\tt in}  & {\em v2} & Volume of second particle (m$^\wedge$3).\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\mbox{\tt in}  & {\em env\+\_\+state} & Environment state.\\
\hline
\mbox{\tt out}  & {\em k\+\_\+min} & Minimum kernel value (m$^\wedge$3/s).\\
\hline
\mbox{\tt out}  & {\em k\+\_\+max} & Maximum kernel value (m$^\wedge$3/s). \\
\hline
\end{DoxyParams}


Definition at line 132 of file coag\+\_\+kernel.\+F90.

\mbox{\Hypertarget{namespacepmc__coag__kernel_aff06e0cba11c675531b31fee88244d74}\label{namespacepmc__coag__kernel_aff06e0cba11c675531b31fee88244d74}} 
\index{pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}!max\+\_\+coag\+\_\+num\+\_\+conc\+\_\+factor@{max\+\_\+coag\+\_\+num\+\_\+conc\+\_\+factor}}
\index{max\+\_\+coag\+\_\+num\+\_\+conc\+\_\+factor@{max\+\_\+coag\+\_\+num\+\_\+conc\+\_\+factor}!pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}}
\subsubsection{\texorpdfstring{max\+\_\+coag\+\_\+num\+\_\+conc\+\_\+factor()}{max\_coag\_num\_conc\_factor()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+coag\+\_\+kernel\+::max\+\_\+coag\+\_\+num\+\_\+conc\+\_\+factor (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__aero__weight__array_1_1aero__weight__array__t}{aero\+\_\+weight\+\_\+array\+\_\+t}}), intent(in)}]{aero\+\_\+weight\+\_\+array,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data,  }\item[{type(\mbox{\hyperlink{structpmc__bin__grid_1_1bin__grid__t}{bin\+\_\+grid\+\_\+t}}), intent(in)}]{bin\+\_\+grid,  }\item[{integer, intent(in)}]{i\+\_\+bin,  }\item[{integer, intent(in)}]{j\+\_\+bin,  }\item[{integer, intent(in)}]{i\+\_\+class,  }\item[{integer, intent(in)}]{j\+\_\+class,  }\item[{integer, intent(in)}]{ij\+\_\+class,  }\item[{real(kind=dp), intent(out)}]{f\+\_\+max }\end{DoxyParamCaption})}



Determine the minimum and maximum number concentration factors for coagulation. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em aero\+\_\+weight\+\_\+array} & Aerosol weight array.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\mbox{\tt in}  & {\em bin\+\_\+grid} & Bin grid.\\
\hline
\mbox{\tt in}  & {\em i\+\_\+bin} & First bin number.\\
\hline
\mbox{\tt in}  & {\em j\+\_\+bin} & Second bin number.\\
\hline
\mbox{\tt in}  & {\em i\+\_\+class} & Weight class of first particle.\\
\hline
\mbox{\tt in}  & {\em j\+\_\+class} & Weight class of second particle.\\
\hline
\mbox{\tt in}  & {\em ij\+\_\+class} & Weight class of coagulated particle.\\
\hline
\mbox{\tt out}  & {\em f\+\_\+max} & Maximum coagulation factor. \\
\hline
\end{DoxyParams}


Definition at line 424 of file coag\+\_\+kernel.\+F90.

\mbox{\Hypertarget{namespacepmc__coag__kernel_a346752606a43c3b5348ff3f47a4e0d17}\label{namespacepmc__coag__kernel_a346752606a43c3b5348ff3f47a4e0d17}} 
\index{pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}!num\+\_\+conc\+\_\+weighted\+\_\+kernel@{num\+\_\+conc\+\_\+weighted\+\_\+kernel}}
\index{num\+\_\+conc\+\_\+weighted\+\_\+kernel@{num\+\_\+conc\+\_\+weighted\+\_\+kernel}!pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}}
\subsubsection{\texorpdfstring{num\+\_\+conc\+\_\+weighted\+\_\+kernel()}{num\_conc\_weighted\_kernel()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+coag\+\_\+kernel\+::num\+\_\+conc\+\_\+weighted\+\_\+kernel (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{coag\+\_\+kernel\+\_\+type,  }\item[{type(\mbox{\hyperlink{structpmc__aero__particle_1_1aero__particle__t}{aero\+\_\+particle\+\_\+t}}), intent(in)}]{aero\+\_\+particle\+\_\+1,  }\item[{type(\mbox{\hyperlink{structpmc__aero__particle_1_1aero__particle__t}{aero\+\_\+particle\+\_\+t}}), intent(in)}]{aero\+\_\+particle\+\_\+2,  }\item[{integer, intent(in)}]{i\+\_\+class,  }\item[{integer, intent(in)}]{j\+\_\+class,  }\item[{integer, intent(in)}]{ij\+\_\+class,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data,  }\item[{type(\mbox{\hyperlink{structpmc__aero__weight__array_1_1aero__weight__array__t}{aero\+\_\+weight\+\_\+array\+\_\+t}}), intent(in)}]{aero\+\_\+weight\+\_\+array,  }\item[{type(\mbox{\hyperlink{structpmc__env__state_1_1env__state__t}{env\+\_\+state\+\_\+t}}), intent(in)}]{env\+\_\+state,  }\item[{real(kind=dp), intent(out)}]{k }\end{DoxyParamCaption})}



Compute the kernel value with the given number concentration weighting. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em coag\+\_\+kernel\+\_\+type} & Coagulation kernel type.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+particle\+\_\+1} & First particle.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+particle\+\_\+2} & Second particle.\\
\hline
\mbox{\tt in}  & {\em i\+\_\+class} & Weight class of first particle.\\
\hline
\mbox{\tt in}  & {\em j\+\_\+class} & Weight class of second particle.\\
\hline
\mbox{\tt in}  & {\em ij\+\_\+class} & Weight class of combined particle.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+weight\+\_\+array} & Aerosol weight array.\\
\hline
\mbox{\tt in}  & {\em env\+\_\+state} & Environment state.\\
\hline
\mbox{\tt out}  & {\em k} & Coagulation kernel. \\
\hline
\end{DoxyParams}


Definition at line 178 of file coag\+\_\+kernel.\+F90.



\subsection{Variable Documentation}
\mbox{\Hypertarget{namespacepmc__coag__kernel_a75f7fd7b7f1f6d38bb03828c46e1be66}\label{namespacepmc__coag__kernel_a75f7fd7b7f1f6d38bb03828c46e1be66}} 
\index{pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}!coag\+\_\+kernel\+\_\+type\+\_\+additive@{coag\+\_\+kernel\+\_\+type\+\_\+additive}}
\index{coag\+\_\+kernel\+\_\+type\+\_\+additive@{coag\+\_\+kernel\+\_\+type\+\_\+additive}!pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}}
\subsubsection{\texorpdfstring{coag\+\_\+kernel\+\_\+type\+\_\+additive}{coag\_kernel\_type\_additive}}
{\footnotesize\ttfamily integer, parameter pmc\+\_\+coag\+\_\+kernel\+::coag\+\_\+kernel\+\_\+type\+\_\+additive = 2}



Type code for an additive kernel. 



Definition at line 33 of file coag\+\_\+kernel.\+F90.

\mbox{\Hypertarget{namespacepmc__coag__kernel_aa6a324c3d911cbc50a287ebb1b873535}\label{namespacepmc__coag__kernel_aa6a324c3d911cbc50a287ebb1b873535}} 
\index{pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}!coag\+\_\+kernel\+\_\+type\+\_\+brown@{coag\+\_\+kernel\+\_\+type\+\_\+brown}}
\index{coag\+\_\+kernel\+\_\+type\+\_\+brown@{coag\+\_\+kernel\+\_\+type\+\_\+brown}!pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}}
\subsubsection{\texorpdfstring{coag\+\_\+kernel\+\_\+type\+\_\+brown}{coag\_kernel\_type\_brown}}
{\footnotesize\ttfamily integer, parameter pmc\+\_\+coag\+\_\+kernel\+::coag\+\_\+kernel\+\_\+type\+\_\+brown = 4}



Type code for a Brownian kernel. 



Definition at line 37 of file coag\+\_\+kernel.\+F90.

\mbox{\Hypertarget{namespacepmc__coag__kernel_ad1ce21ef5a0a9dff8f2efe6267f22c52}\label{namespacepmc__coag__kernel_ad1ce21ef5a0a9dff8f2efe6267f22c52}} 
\index{pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}!coag\+\_\+kernel\+\_\+type\+\_\+brown\+\_\+cont@{coag\+\_\+kernel\+\_\+type\+\_\+brown\+\_\+cont}}
\index{coag\+\_\+kernel\+\_\+type\+\_\+brown\+\_\+cont@{coag\+\_\+kernel\+\_\+type\+\_\+brown\+\_\+cont}!pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}}
\subsubsection{\texorpdfstring{coag\+\_\+kernel\+\_\+type\+\_\+brown\+\_\+cont}{coag\_kernel\_type\_brown\_cont}}
{\footnotesize\ttfamily integer, parameter pmc\+\_\+coag\+\_\+kernel\+::coag\+\_\+kernel\+\_\+type\+\_\+brown\+\_\+cont = 7}



Type code for a Brownian kernel in continuum regime from Vemury and Pratsinis \mbox{[}1995\mbox{]}. 



Definition at line 45 of file coag\+\_\+kernel.\+F90.

\mbox{\Hypertarget{namespacepmc__coag__kernel_ac11bbcea41051f4b2e16769f2a78fc94}\label{namespacepmc__coag__kernel_ac11bbcea41051f4b2e16769f2a78fc94}} 
\index{pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}!coag\+\_\+kernel\+\_\+type\+\_\+brown\+\_\+free@{coag\+\_\+kernel\+\_\+type\+\_\+brown\+\_\+free}}
\index{coag\+\_\+kernel\+\_\+type\+\_\+brown\+\_\+free@{coag\+\_\+kernel\+\_\+type\+\_\+brown\+\_\+free}!pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}}
\subsubsection{\texorpdfstring{coag\+\_\+kernel\+\_\+type\+\_\+brown\+\_\+free}{coag\_kernel\_type\_brown\_free}}
{\footnotesize\ttfamily integer, parameter pmc\+\_\+coag\+\_\+kernel\+::coag\+\_\+kernel\+\_\+type\+\_\+brown\+\_\+free = 6}



Type code for a Brownian kernel in free molecular regime from Vemury and Pratsinis \mbox{[}1995\mbox{]}. 



Definition at line 42 of file coag\+\_\+kernel.\+F90.

\mbox{\Hypertarget{namespacepmc__coag__kernel_a6706cc1fc48d83cd5fbca4bba57d60b2}\label{namespacepmc__coag__kernel_a6706cc1fc48d83cd5fbca4bba57d60b2}} 
\index{pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}!coag\+\_\+kernel\+\_\+type\+\_\+constant@{coag\+\_\+kernel\+\_\+type\+\_\+constant}}
\index{coag\+\_\+kernel\+\_\+type\+\_\+constant@{coag\+\_\+kernel\+\_\+type\+\_\+constant}!pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}}
\subsubsection{\texorpdfstring{coag\+\_\+kernel\+\_\+type\+\_\+constant}{coag\_kernel\_type\_constant}}
{\footnotesize\ttfamily integer, parameter pmc\+\_\+coag\+\_\+kernel\+::coag\+\_\+kernel\+\_\+type\+\_\+constant = 3}



Type code for a constant kernel. 



Definition at line 35 of file coag\+\_\+kernel.\+F90.

\mbox{\Hypertarget{namespacepmc__coag__kernel_a299db166a8c9252d1ee80b1bab04270b}\label{namespacepmc__coag__kernel_a299db166a8c9252d1ee80b1bab04270b}} 
\index{pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}!coag\+\_\+kernel\+\_\+type\+\_\+invalid@{coag\+\_\+kernel\+\_\+type\+\_\+invalid}}
\index{coag\+\_\+kernel\+\_\+type\+\_\+invalid@{coag\+\_\+kernel\+\_\+type\+\_\+invalid}!pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}}
\subsubsection{\texorpdfstring{coag\+\_\+kernel\+\_\+type\+\_\+invalid}{coag\_kernel\_type\_invalid}}
{\footnotesize\ttfamily integer, parameter pmc\+\_\+coag\+\_\+kernel\+::coag\+\_\+kernel\+\_\+type\+\_\+invalid = 0}



Type code for an undefined or invalid kernel. 



Definition at line 29 of file coag\+\_\+kernel.\+F90.

\mbox{\Hypertarget{namespacepmc__coag__kernel_a5b9c2196146dafb206c5442d2c928559}\label{namespacepmc__coag__kernel_a5b9c2196146dafb206c5442d2c928559}} 
\index{pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}!coag\+\_\+kernel\+\_\+type\+\_\+len@{coag\+\_\+kernel\+\_\+type\+\_\+len}}
\index{coag\+\_\+kernel\+\_\+type\+\_\+len@{coag\+\_\+kernel\+\_\+type\+\_\+len}!pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}}
\subsubsection{\texorpdfstring{coag\+\_\+kernel\+\_\+type\+\_\+len}{coag\_kernel\_type\_len}}
{\footnotesize\ttfamily integer, parameter pmc\+\_\+coag\+\_\+kernel\+::coag\+\_\+kernel\+\_\+type\+\_\+len = 20}



Maximum length of a mode type. 



Definition at line 26 of file coag\+\_\+kernel.\+F90.

\mbox{\Hypertarget{namespacepmc__coag__kernel_acc427a94f9c674be417fa4eb397cd808}\label{namespacepmc__coag__kernel_acc427a94f9c674be417fa4eb397cd808}} 
\index{pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}!coag\+\_\+kernel\+\_\+type\+\_\+sedi@{coag\+\_\+kernel\+\_\+type\+\_\+sedi}}
\index{coag\+\_\+kernel\+\_\+type\+\_\+sedi@{coag\+\_\+kernel\+\_\+type\+\_\+sedi}!pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}}
\subsubsection{\texorpdfstring{coag\+\_\+kernel\+\_\+type\+\_\+sedi}{coag\_kernel\_type\_sedi}}
{\footnotesize\ttfamily integer, parameter pmc\+\_\+coag\+\_\+kernel\+::coag\+\_\+kernel\+\_\+type\+\_\+sedi = 1}



Type code for a sedimentation kernel. 



Definition at line 31 of file coag\+\_\+kernel.\+F90.

\mbox{\Hypertarget{namespacepmc__coag__kernel_a6d75eae86113c1790f98fe66147bcdcc}\label{namespacepmc__coag__kernel_a6d75eae86113c1790f98fe66147bcdcc}} 
\index{pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}!coag\+\_\+kernel\+\_\+type\+\_\+zero@{coag\+\_\+kernel\+\_\+type\+\_\+zero}}
\index{coag\+\_\+kernel\+\_\+type\+\_\+zero@{coag\+\_\+kernel\+\_\+type\+\_\+zero}!pmc\+\_\+coag\+\_\+kernel@{pmc\+\_\+coag\+\_\+kernel}}
\subsubsection{\texorpdfstring{coag\+\_\+kernel\+\_\+type\+\_\+zero}{coag\_kernel\_type\_zero}}
{\footnotesize\ttfamily integer, parameter pmc\+\_\+coag\+\_\+kernel\+::coag\+\_\+kernel\+\_\+type\+\_\+zero = 5}



Type code for a zero kernel. 



Definition at line 39 of file coag\+\_\+kernel.\+F90.

