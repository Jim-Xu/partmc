\hypertarget{namespacepmc__run__sect}{}\section{pmc\+\_\+run\+\_\+sect Module Reference}
\label{namespacepmc__run__sect}\index{pmc\+\_\+run\+\_\+sect@{pmc\+\_\+run\+\_\+sect}}


1D sectional simulation.  


\subsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
type \mbox{\hyperlink{structpmc__run__sect_1_1run__sect__opt__t}{run\+\_\+sect\+\_\+opt\+\_\+t}}
\begin{DoxyCompactList}\small\item\em Options controlling the operation of \mbox{\hyperlink{namespacepmc__run__sect_a98f7b8811139683010e8a70346452ac2}{run\+\_\+sect()}}. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacepmc__run__sect_a98f7b8811139683010e8a70346452ac2}{run\+\_\+sect}} (bin\+\_\+grid, gas\+\_\+data, aero\+\_\+data, aero\+\_\+dist, scenario, env\+\_\+state, run\+\_\+sect\+\_\+opt)
\begin{DoxyCompactList}\small\item\em Run a sectional simulation. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__run__sect_ab0cefd419d24a8416f61f3d6a1098f0e}{coad}} (n\+\_\+bin, dt, taug, taup, taul, tauu, prod, ploss, c, ima, g, r, e, ck, ec)
\begin{DoxyCompactList}\small\item\em Collision subroutine, exponential approach. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__run__sect_a55df1799d03853355ca1d55274b370df}{courant}} (n\+\_\+bin, log\+\_\+width, e, ima, c)
\begin{DoxyCompactList}\small\item\em Determines the Courant number for each bin pair. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__run__sect_af8c0ab7ec5c461726865d56af791a77a}{smooth\+\_\+bin\+\_\+kernel}} (n\+\_\+bin, k, k\+\_\+smooth)
\begin{DoxyCompactList}\small\item\em Smooths kernel values for bin pairs, and halves the self-\/rate. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
1D sectional simulation. 

Sectional code based on {\ttfamily coad1d.\+f} by Andreas Bott
\begin{DoxyItemize}
\item \href{http://www.meteo.uni-bonn.de/mitarbeiter/ABott/}{\tt http\+://www.\+meteo.\+uni-\/bonn.\+de/mitarbeiter/\+A\+Bott/}
\item Released under the G\+PL to Nicole Riemer (personal communication)
\item A. Bott, A flux method for the numerical solution of the stochastic collection equation, J. Atmos. Sci. 55, 2284-\/2293,
\begin{DoxyEnumerate}
\item 
\end{DoxyEnumerate}
\end{DoxyItemize}

\subsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacepmc__run__sect_ab0cefd419d24a8416f61f3d6a1098f0e}\label{namespacepmc__run__sect_ab0cefd419d24a8416f61f3d6a1098f0e}} 
\index{pmc\+\_\+run\+\_\+sect@{pmc\+\_\+run\+\_\+sect}!coad@{coad}}
\index{coad@{coad}!pmc\+\_\+run\+\_\+sect@{pmc\+\_\+run\+\_\+sect}}
\subsubsection{\texorpdfstring{coad()}{coad()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+run\+\_\+sect\+::coad (\begin{DoxyParamCaption}\item[{integer}]{n\+\_\+bin,  }\item[{real(kind=dp)}]{dt,  }\item[{real(kind=dp), dimension(n\+\_\+bin)}]{taug,  }\item[{real(kind=dp), dimension(n\+\_\+bin)}]{taup,  }\item[{real(kind=dp), dimension(n\+\_\+bin)}]{taul,  }\item[{real(kind=dp), dimension(n\+\_\+bin)}]{tauu,  }\item[{real(kind=dp), dimension(n\+\_\+bin)}]{prod,  }\item[{real(kind=dp), dimension(n\+\_\+bin)}]{ploss,  }\item[{real(kind=dp), dimension(n\+\_\+bin,n\+\_\+bin)}]{c,  }\item[{integer, dimension(n\+\_\+bin,n\+\_\+bin)}]{ima,  }\item[{real(kind=dp), dimension(n\+\_\+bin)}]{g,  }\item[{real(kind=dp), dimension(n\+\_\+bin)}]{r,  }\item[{real(kind=dp), dimension(n\+\_\+bin)}]{e,  }\item[{real(kind=dp), dimension(n\+\_\+bin,n\+\_\+bin)}]{ck,  }\item[{real(kind=dp), dimension(n\+\_\+bin,n\+\_\+bin)}]{ec }\end{DoxyParamCaption})}



Collision subroutine, exponential approach. 



Definition at line 205 of file run\+\_\+sect.\+F90.

\mbox{\Hypertarget{namespacepmc__run__sect_a55df1799d03853355ca1d55274b370df}\label{namespacepmc__run__sect_a55df1799d03853355ca1d55274b370df}} 
\index{pmc\+\_\+run\+\_\+sect@{pmc\+\_\+run\+\_\+sect}!courant@{courant}}
\index{courant@{courant}!pmc\+\_\+run\+\_\+sect@{pmc\+\_\+run\+\_\+sect}}
\subsubsection{\texorpdfstring{courant()}{courant()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+run\+\_\+sect\+::courant (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{n\+\_\+bin,  }\item[{real(kind=dp), intent(in)}]{log\+\_\+width,  }\item[{real(kind=dp), dimension(n\+\_\+bin), intent(in)}]{e,  }\item[{integer, dimension(n\+\_\+bin,n\+\_\+bin), intent(out)}]{ima,  }\item[{real(kind=dp), dimension(n\+\_\+bin,n\+\_\+bin), intent(out)}]{c }\end{DoxyParamCaption})}



Determines the Courant number for each bin pair. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em n\+\_\+bin} & Number of bins.\\
\hline
\mbox{\tt in}  & {\em log\+\_\+width} & Bin scale factor.\\
\hline
\mbox{\tt in}  & {\em e} & Droplet mass grid (mg).\\
\hline
\mbox{\tt out}  & {\em ima} & i + j goes in bin ima(i,j).\\
\hline
\mbox{\tt out}  & {\em c} & Courant number for bin pairs. \\
\hline
\end{DoxyParams}


Definition at line 285 of file run\+\_\+sect.\+F90.

\mbox{\Hypertarget{namespacepmc__run__sect_a98f7b8811139683010e8a70346452ac2}\label{namespacepmc__run__sect_a98f7b8811139683010e8a70346452ac2}} 
\index{pmc\+\_\+run\+\_\+sect@{pmc\+\_\+run\+\_\+sect}!run\+\_\+sect@{run\+\_\+sect}}
\index{run\+\_\+sect@{run\+\_\+sect}!pmc\+\_\+run\+\_\+sect@{pmc\+\_\+run\+\_\+sect}}
\subsubsection{\texorpdfstring{run\+\_\+sect()}{run\_sect()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+run\+\_\+sect\+::run\+\_\+sect (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__bin__grid_1_1bin__grid__t}{bin\+\_\+grid\+\_\+t}}), intent(in)}]{bin\+\_\+grid,  }\item[{type(\mbox{\hyperlink{structpmc__gas__data_1_1gas__data__t}{gas\+\_\+data\+\_\+t}}), intent(in)}]{gas\+\_\+data,  }\item[{type(\mbox{\hyperlink{structpmc__aero__data_1_1aero__data__t}{aero\+\_\+data\+\_\+t}}), intent(in)}]{aero\+\_\+data,  }\item[{type(\mbox{\hyperlink{structpmc__aero__dist_1_1aero__dist__t}{aero\+\_\+dist\+\_\+t}}), intent(inout)}]{aero\+\_\+dist,  }\item[{type(\mbox{\hyperlink{structpmc__scenario_1_1scenario__t}{scenario\+\_\+t}}), intent(inout)}]{scenario,  }\item[{type(\mbox{\hyperlink{structpmc__env__state_1_1env__state__t}{env\+\_\+state\+\_\+t}}), intent(inout)}]{env\+\_\+state,  }\item[{type(\mbox{\hyperlink{structpmc__run__sect_1_1run__sect__opt__t}{run\+\_\+sect\+\_\+opt\+\_\+t}}), intent(in)}]{run\+\_\+sect\+\_\+opt }\end{DoxyParamCaption})}



Run a sectional simulation. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em bin\+\_\+grid} & Bin grid.\\
\hline
\mbox{\tt in}  & {\em gas\+\_\+data} & Gas data.\\
\hline
\mbox{\tt in}  & {\em aero\+\_\+data} & Aerosol data.\\
\hline
\mbox{\tt in,out}  & {\em aero\+\_\+dist} & Aerosol distribution.\\
\hline
\mbox{\tt in,out}  & {\em scenario} & Environment data.\\
\hline
\mbox{\tt in,out}  & {\em env\+\_\+state} & Environment state.\\
\hline
\mbox{\tt in}  & {\em run\+\_\+sect\+\_\+opt} & Options. \\
\hline
\end{DoxyParams}


Definition at line 58 of file run\+\_\+sect.\+F90.

\mbox{\Hypertarget{namespacepmc__run__sect_af8c0ab7ec5c461726865d56af791a77a}\label{namespacepmc__run__sect_af8c0ab7ec5c461726865d56af791a77a}} 
\index{pmc\+\_\+run\+\_\+sect@{pmc\+\_\+run\+\_\+sect}!smooth\+\_\+bin\+\_\+kernel@{smooth\+\_\+bin\+\_\+kernel}}
\index{smooth\+\_\+bin\+\_\+kernel@{smooth\+\_\+bin\+\_\+kernel}!pmc\+\_\+run\+\_\+sect@{pmc\+\_\+run\+\_\+sect}}
\subsubsection{\texorpdfstring{smooth\+\_\+bin\+\_\+kernel()}{smooth\_bin\_kernel()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+run\+\_\+sect\+::smooth\+\_\+bin\+\_\+kernel (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{n\+\_\+bin,  }\item[{real(kind=dp), dimension(n\+\_\+bin,n\+\_\+bin), intent(in)}]{k,  }\item[{real(kind=dp), dimension(n\+\_\+bin,n\+\_\+bin), intent(out)}]{k\+\_\+smooth }\end{DoxyParamCaption})}



Smooths kernel values for bin pairs, and halves the self-\/rate. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em n\+\_\+bin} & Number of bins.\\
\hline
\mbox{\tt in}  & {\em k} & Kernel values.\\
\hline
\mbox{\tt out}  & {\em k\+\_\+smooth} & Smoothed kernel values. \\
\hline
\end{DoxyParams}


Definition at line 335 of file run\+\_\+sect.\+F90.

