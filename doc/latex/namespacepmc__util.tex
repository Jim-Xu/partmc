\hypertarget{namespacepmc__util}{}\section{pmc\+\_\+util Module Reference}
\label{namespacepmc__util}\index{pmc\+\_\+util@{pmc\+\_\+util}}


Common utility subroutines.  


\subsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
interface \mbox{\hyperlink{structpmc__util_1_1string__t}{string\+\_\+t}}
\begin{DoxyCompactList}\small\item\em String type for building arrays of string of various size. \end{DoxyCompactList}\item 
interface \mbox{\hyperlink{interfacepmc__util_1_1to__string}{to\+\_\+string}}
\begin{DoxyCompactList}\small\item\em Interface for \mbox{\hyperlink{interfacepmc__util_1_1to__string}{to\+\_\+string}} functions. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
type(\mbox{\hyperlink{structpmc__util_1_1string__t}{string\+\_\+t}}) function, pointer \mbox{\hyperlink{namespacepmc__util_a8fc2639b0e044d6e575027b5394061aa}{string\+\_\+t\+\_\+constructor}} (val)
\begin{DoxyCompactList}\small\item\em Constructor for \mbox{\hyperlink{structpmc__util_1_1string__t}{string\+\_\+t}}. \end{DoxyCompactList}\item 
elemental subroutine \mbox{\hyperlink{namespacepmc__util_a25291e39623c22ba97600388d04ef7a0}{string\+\_\+t\+\_\+finalize}} (this)
\begin{DoxyCompactList}\small\item\em Finalize a string object. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__util_a249b73ad660e5e17ec4e4ad2ff743546}{warn\+\_\+msg}} (code, warning\+\_\+msg, already\+\_\+warned)
\begin{DoxyCompactList}\small\item\em Prints a warning message. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__util_aca11f4bf2897a638ee7035dcc39e7524}{warn\+\_\+assert\+\_\+msg}} (code, condition\+\_\+ok, warning\+\_\+msg)
\begin{DoxyCompactList}\small\item\em Prints a warning message if condition\+\_\+ok is false. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__util_ab4f813625900c9949db11067af2224f2}{assert\+\_\+msg}} (code, condition\+\_\+ok, error\+\_\+msg)
\begin{DoxyCompactList}\small\item\em Errors unless condition\+\_\+ok is true. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__util_a4b6a3270c45469ecd16abc4c2c43e391}{assert}} (code, condition\+\_\+ok)
\begin{DoxyCompactList}\small\item\em Errors unless condition\+\_\+ok is true. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__util_ae2f8c4238f51e70e793d1572c823fef6}{die}} (code)
\begin{DoxyCompactList}\small\item\em Error immediately. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__util_aa6e9ef9e9da5f7b7f100405b86c74316}{die\+\_\+msg}} (code, error\+\_\+msg)
\begin{DoxyCompactList}\small\item\em Error immediately. \end{DoxyCompactList}\item 
integer function \mbox{\hyperlink{namespacepmc__util_a76442600ebd1117db2a8db91d73f7737}{get\+\_\+unit}} ()
\begin{DoxyCompactList}\small\item\em Returns an available unit number. This should be freed by \mbox{\hyperlink{namespacepmc__util_a74557f04ac600442864bec92848b4550}{free\+\_\+unit()}}. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__util_a74557f04ac600442864bec92848b4550}{free\+\_\+unit}} (unit)
\begin{DoxyCompactList}\small\item\em Frees a unit number returned by \mbox{\hyperlink{namespacepmc__util_a76442600ebd1117db2a8db91d73f7737}{get\+\_\+unit()}}. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__util_aee3183d5ad7cf9bf38f966a4aecee252}{open\+\_\+file\+\_\+read}} (filename, unit)
\begin{DoxyCompactList}\small\item\em Open a file for reading with an automatically assigned unit and test that it succeeds. The file should be closed with \mbox{\hyperlink{namespacepmc__util_ac91736b4f44a1623208ebe7f161e84ad}{close\+\_\+file()}}. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__util_ab49e2a7d4958cc13e35bb5982d378da5}{open\+\_\+file\+\_\+write}} (filename, unit)
\begin{DoxyCompactList}\small\item\em Open a file for writing with an automatically assigned unit and test that it succeeds. The file should be closed with \mbox{\hyperlink{namespacepmc__util_ac91736b4f44a1623208ebe7f161e84ad}{close\+\_\+file()}}. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__util_ac91736b4f44a1623208ebe7f161e84ad}{close\+\_\+file}} (unit)
\begin{DoxyCompactList}\small\item\em Close a file and de-\/assign the unit. \end{DoxyCompactList}\item 
real(kind=dp) elemental function \mbox{\hyperlink{namespacepmc__util_af905c1127f64dd471808b872022ed632}{sphere\+\_\+vol2rad}} (v)
\begin{DoxyCompactList}\small\item\em Convert mass-\/equivalent volume $V$ (m$^\wedge$3) to geometric radius $R_{\rm geo}$ (m) for spherical particles. \end{DoxyCompactList}\item 
real(kind=dp) elemental function \mbox{\hyperlink{namespacepmc__util_a69ab911167fab93d371e42476e9aac73}{rad2diam}} (r)
\begin{DoxyCompactList}\small\item\em Convert radius (m) to diameter (m). \end{DoxyCompactList}\item 
real(kind=dp) elemental function \mbox{\hyperlink{namespacepmc__util_a30ef7112d68a812b3022046e0f3a40be}{sphere\+\_\+rad2vol}} (r)
\begin{DoxyCompactList}\small\item\em Convert geometric radius $R_{\rm geo}$ (m) to mass-\/equivalent volume $V$ (m$^\wedge$3) for spherical particles. \end{DoxyCompactList}\item 
real(kind=dp) elemental function \mbox{\hyperlink{namespacepmc__util_ab0ce0deb86bd2e48734d7e654e5c3b18}{diam2rad}} (d)
\begin{DoxyCompactList}\small\item\em Convert diameter (m) to radius (m). \end{DoxyCompactList}\item 
real(kind=dp) function \mbox{\hyperlink{namespacepmc__util_abd28fa58b98f202bfa9e4f4bcd3a7608}{air\+\_\+mean\+\_\+free\+\_\+path}} (temp, pressure)
\begin{DoxyCompactList}\small\item\em Calculate air molecular mean free path $l$ (m). \end{DoxyCompactList}\item 
logical function \mbox{\hyperlink{namespacepmc__util_a7bc605f9cb5389d88d233bcecfbfc858}{almost\+\_\+equal}} (d1, d2, tol)
\begin{DoxyCompactList}\small\item\em Tests whether two real numbers are almost equal using only a relative tolerance. \end{DoxyCompactList}\item 
logical function \mbox{\hyperlink{namespacepmc__util_a5952e4909aad7ccdcdc8ac308c7bf3f8}{almost\+\_\+equal\+\_\+abs}} (d1, d2, abs\+\_\+tol)
\begin{DoxyCompactList}\small\item\em Tests whether two real numbers are almost equal using an absolute and relative tolerance. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__util_a479916629132db9682beccf0d90a0113}{check\+\_\+time\+\_\+multiple}} (first\+\_\+name, first\+\_\+time, second\+\_\+name, second\+\_\+time)
\begin{DoxyCompactList}\small\item\em Check that the first time interval is close to an integer multiple of the second, and warn if it is not. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__util_a2c1ad3f0be48f08a1b308538f8d42540}{check\+\_\+event}} (time, timestep, interval, last\+\_\+time, do\+\_\+event)
\begin{DoxyCompactList}\small\item\em Computes whether an event is scheduled to take place. \end{DoxyCompactList}\item 
real(kind=dp) function, dimension(\+:), allocatable \mbox{\hyperlink{namespacepmc__util_a173493cd6763f490fd73dcc0d3ae701b}{linspace}} (min\+\_\+x, max\+\_\+x, n)
\begin{DoxyCompactList}\small\item\em Makes a linearly spaced array from min to max. \end{DoxyCompactList}\item 
real(kind=dp) function, dimension(\+:), allocatable \mbox{\hyperlink{namespacepmc__util_aaa2f79250374df571d379d895ceb7a71}{logspace}} (min\+\_\+x, max\+\_\+x, n)
\begin{DoxyCompactList}\small\item\em Makes a logarithmically spaced array of length n from min to max. \end{DoxyCompactList}\item 
integer function \mbox{\hyperlink{namespacepmc__util_a1d5f058ff11d51e9083950422757e8b7}{linspace\+\_\+find}} (min\+\_\+x, max\+\_\+x, n, x)
\begin{DoxyCompactList}\small\item\em Find the position of a real number in a 1D linear array. \end{DoxyCompactList}\item 
integer function \mbox{\hyperlink{namespacepmc__util_a8679b1591949031ddac4234e457fe048}{logspace\+\_\+find}} (min\+\_\+x, max\+\_\+x, n, x)
\begin{DoxyCompactList}\small\item\em Find the position of a real number in a 1D logarithmic array. \end{DoxyCompactList}\item 
integer function \mbox{\hyperlink{namespacepmc__util_ac91afc829f34ff168c29ebd00f560cb2}{find\+\_\+1d}} (n, x\+\_\+vals, x)
\begin{DoxyCompactList}\small\item\em Find the position of a real number in an arbitrary 1D array. \end{DoxyCompactList}\item 
real(kind=dp) function \mbox{\hyperlink{namespacepmc__util_aa7405c9d93fafa02adb9b51f7a8acadf}{interp\+\_\+1d}} (x\+\_\+vals, y\+\_\+vals, x)
\begin{DoxyCompactList}\small\item\em 1D linear interpolation. \end{DoxyCompactList}\item 
real(kind=dp) function \mbox{\hyperlink{namespacepmc__util_a6b98d6e94a23e0223f1e78ee4cbdca64}{interp\+\_\+linear\+\_\+disc}} (x\+\_\+1, x\+\_\+n, n, i)
\begin{DoxyCompactList}\small\item\em Linear interpolation over discrete indices. \end{DoxyCompactList}\item 
integer function \mbox{\hyperlink{namespacepmc__util_aa4e6c3a50b7def19b9ce4cf85a0816ca}{string\+\_\+to\+\_\+integer}} (string)
\begin{DoxyCompactList}\small\item\em Convert a string to an integer. \end{DoxyCompactList}\item 
real(kind=dp) function \mbox{\hyperlink{namespacepmc__util_a1d18d4c7adea4978d104517da57995ef}{string\+\_\+to\+\_\+real}} (string)
\begin{DoxyCompactList}\small\item\em Convert a string to a real. \end{DoxyCompactList}\item 
logical function \mbox{\hyperlink{namespacepmc__util_addbacdfdd34c9190924403097f717ab4}{string\+\_\+to\+\_\+logical}} (string)
\begin{DoxyCompactList}\small\item\em Convert a string to a logical. \end{DoxyCompactList}\item 
character(len=\mbox{\hyperlink{namespacepmc__util_afd468d26aef28509c08087ba8e59089a}{pmc\+\_\+util\+\_\+convert\+\_\+string\+\_\+len}}) function \mbox{\hyperlink{namespacepmc__util_ab5a72413552c4a653ddafc47e28a2f14}{integer\+\_\+to\+\_\+string}} (val)
\begin{DoxyCompactList}\small\item\em Convert an integer to a string format. \end{DoxyCompactList}\item 
character(len=\mbox{\hyperlink{namespacepmc__util_afd468d26aef28509c08087ba8e59089a}{pmc\+\_\+util\+\_\+convert\+\_\+string\+\_\+len}}) function \mbox{\hyperlink{namespacepmc__util_a5f80ccbbb2709c6f8458a1f7742aa549}{real\+\_\+to\+\_\+string}} (val)
\begin{DoxyCompactList}\small\item\em Convert a real to a string format. \end{DoxyCompactList}\item 
character(len=\mbox{\hyperlink{namespacepmc__util_afd468d26aef28509c08087ba8e59089a}{pmc\+\_\+util\+\_\+convert\+\_\+string\+\_\+len}}) function \mbox{\hyperlink{namespacepmc__util_a92e778281860ee189704e0f1f2c19e86}{logical\+\_\+to\+\_\+string}} (val)
\begin{DoxyCompactList}\small\item\em Convert a logical to a string format. \end{DoxyCompactList}\item 
character(len=\mbox{\hyperlink{namespacepmc__util_afd468d26aef28509c08087ba8e59089a}{pmc\+\_\+util\+\_\+convert\+\_\+string\+\_\+len}}) function \mbox{\hyperlink{namespacepmc__util_a1c459fd59d9acef65849cc5fd388d386}{complex\+\_\+to\+\_\+string}} (val)
\begin{DoxyCompactList}\small\item\em Convert a complex to a string format. \end{DoxyCompactList}\item 
character(len=\mbox{\hyperlink{namespacepmc__util_afd468d26aef28509c08087ba8e59089a}{pmc\+\_\+util\+\_\+convert\+\_\+string\+\_\+len}}) function \mbox{\hyperlink{namespacepmc__util_a702884cdee8fa1da41a3bf8b460c95d3}{integer\+\_\+to\+\_\+string\+\_\+max\+\_\+len}} (val, max\+\_\+len)
\begin{DoxyCompactList}\small\item\em Convert an integer to a string format of maximum length. \end{DoxyCompactList}\item 
character(len=\mbox{\hyperlink{namespacepmc__util_afd468d26aef28509c08087ba8e59089a}{pmc\+\_\+util\+\_\+convert\+\_\+string\+\_\+len}}) function \mbox{\hyperlink{namespacepmc__util_a25918c31f5ac5a5497993883e1206308}{real\+\_\+to\+\_\+string\+\_\+max\+\_\+len}} (val, max\+\_\+len)
\begin{DoxyCompactList}\small\item\em Convert a real to a string format of maximum length. \end{DoxyCompactList}\item 
character(len=\mbox{\hyperlink{namespacepmc__util_afd468d26aef28509c08087ba8e59089a}{pmc\+\_\+util\+\_\+convert\+\_\+string\+\_\+len}}) function \mbox{\hyperlink{namespacepmc__util_aa8c823006029e4a59872cb3f1e14bc70}{time\+\_\+to\+\_\+string\+\_\+max\+\_\+len}} (time, max\+\_\+len)
\begin{DoxyCompactList}\small\item\em Convert a time to a string format of maximum length. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__util_a90ce2db27a1927738cbef385c5f6decb}{vec\+\_\+cts\+\_\+to\+\_\+disc}} (n, vec\+\_\+cts, n\+\_\+samp, vec\+\_\+disc)
\begin{DoxyCompactList}\small\item\em Convert a real-\/valued vector into an integer-\/valued vector. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__util_a48e55ceb55e57898081b2b0221caa856}{average\+\_\+integer}} (int\+\_\+vec, int\+\_\+avg)
\begin{DoxyCompactList}\small\item\em Computes the average of an array of integer numbers. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__util_a5659f4d2fd9c274756e737639dc30196}{average\+\_\+real}} (real\+\_\+vec, real\+\_\+avg)
\begin{DoxyCompactList}\small\item\em Computes the average of an array of real numbers. \end{DoxyCompactList}\item 
integer function \mbox{\hyperlink{namespacepmc__util_a20346c4da2a25e5b8a3215240e851e5f}{string\+\_\+array\+\_\+find}} (array, val)
\begin{DoxyCompactList}\small\item\em Return the index of the first occurance of the given value in the array, or 0 if it is not present. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__util_ad5e823b848ba95bfd29d67f1cfee7a7a}{ensure\+\_\+real\+\_\+array\+\_\+size}} (x, n, only\+\_\+grow)
\begin{DoxyCompactList}\small\item\em Allocate or reallocate the given array to ensure it is of the given size, preserving any data and/or initializing to 0. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__util_a26a0550006c522169b83c4f9c9df69d1}{ensure\+\_\+real\+\_\+array\+\_\+2d\+\_\+size}} (x, n1, n2, only\+\_\+grow)
\begin{DoxyCompactList}\small\item\em Allocate or reallocate the given array to ensure it is of the given size, preserving any data and/or initializing to 0. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__util_adbf9a41092ec1df9139a6f149b644102}{ensure\+\_\+integer\+\_\+array\+\_\+size}} (x, n, only\+\_\+grow)
\begin{DoxyCompactList}\small\item\em Allocate or reallocate the given array to ensure it is of the given size, preserving any data and/or initializing to 0. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__util_a0cf0527cde4f90e88c216b51686de71d}{ensure\+\_\+integer\+\_\+array\+\_\+2d\+\_\+size}} (x, n1, n2, only\+\_\+grow)
\begin{DoxyCompactList}\small\item\em Allocate or reallocate the given array to ensure it is of the given size, preserving any data and/or initializing to 0. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__util_a61a37625f7eff4bd4bbba002652b596d}{ensure\+\_\+string\+\_\+array\+\_\+size}} (x, n)
\begin{DoxyCompactList}\small\item\em Allocate or reallocate the given array to ensure it is of the given size, without preserving data. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__util_a4a6576eb74e7fb0c14d7190b44b62c5c}{get\+\_\+basename}} (filename, basename)
\begin{DoxyCompactList}\small\item\em Strip the extension to find the basename. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__util_aac8c9feb22730857691a4de7b68a041f}{iso8601\+\_\+date\+\_\+and\+\_\+time}} (date\+\_\+time)
\begin{DoxyCompactList}\small\item\em Current date and time in I\+SO 8601 format. \end{DoxyCompactList}\item 
real(kind=dp) function \mbox{\hyperlink{namespacepmc__util_a46d994b9563ad325253e528f983cb3cc}{deg2rad}} (deg)
\begin{DoxyCompactList}\small\item\em Convert degrees to radians. \end{DoxyCompactList}\item 
real(kind=dp) function \mbox{\hyperlink{namespacepmc__util_aee025b9d181017a7c928195ae1148b27}{rad2deg}} (rad)
\begin{DoxyCompactList}\small\item\em Convert radians to degrees. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__util_a32c8275ed718fa49d7ebd55eca41ef70}{integer\+\_\+sort}} (data, perm)
\begin{DoxyCompactList}\small\item\em Sort the given data array and return the permutation defining the sort. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__util_a89e25708a94945ec739408bceef13762}{loadtxt}} (filename, data)
\begin{DoxyCompactList}\small\item\em Load a real array from a text file. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__util_a22ca26ff282a9278ae95f877cb999786}{savetxt\+\_\+1d}} (filename, data)
\begin{DoxyCompactList}\small\item\em Write a real 1D array to a text file. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__util_a136a49845a94549788f385e2c0f625a6}{savetxt\+\_\+2d}} (filename, data)
\begin{DoxyCompactList}\small\item\em Write a real 2D array to a text file. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__util_ae3535489875ec1ba14b921bd43cff11c}{reallocate\+\_\+real\+\_\+array2d}} (data, rows, cols)
\begin{DoxyCompactList}\small\item\em Reallocate a 2D real array to the given size, preserving the contents. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__util_ad88e1503acea1e8e33d13275f37b9755}{read\+\_\+char\+\_\+raw}} (unit, char, eol, eof)
\begin{DoxyCompactList}\small\item\em Read a single character from a file, signaling if we have hit end-\/of-\/line (E\+OL) or end-\/of-\/file (E\+OF). If E\+OL or E\+OF are true then the character value should be ignored. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__util_aa8ba2bc88e899084afec8b5d7f3a8b92}{read\+\_\+word\+\_\+raw}} (unit, word, eol, eof)
\begin{DoxyCompactList}\small\item\em Read a white-\/space delimited word from a file, signaling if we have E\+OL or E\+OF. If E\+OL or E\+OF are true then the word will still be meaningful data. If there was no data to be read then len(word) will be 0. \end{DoxyCompactList}\item 
logical function \mbox{\hyperlink{namespacepmc__util_a397fa3e495a78638d8abfdb798d632f0}{starts\+\_\+with}} (string, start\+\_\+string)
\begin{DoxyCompactList}\small\item\em Checks whether a string starts with a given other string. \end{DoxyCompactList}\item 
elemental real(kind=dp) function \mbox{\hyperlink{namespacepmc__util_ae5311f9f48ddfa5b7c24658526276621}{harmonic\+\_\+mean}} (x1, x2)
\begin{DoxyCompactList}\small\item\em Compute the harmonic mean of two numbers. \end{DoxyCompactList}\item 
elemental real(kind=dp) function \mbox{\hyperlink{namespacepmc__util_a95ad9c9ce574477325505b3e913917cb}{nplogp}} (p)
\begin{DoxyCompactList}\small\item\em Compute $ - p \ln p$ for computing entropy. \end{DoxyCompactList}\item 
real(kind=dp) function \mbox{\hyperlink{namespacepmc__util_af9bd7e3317d4574c2f4633e5f77df142}{entropy}} (p)
\begin{DoxyCompactList}\small\item\em Compute the entropy of a probability mass function (non necessarily normalized). \end{DoxyCompactList}\item 
integer function \mbox{\hyperlink{namespacepmc__util_a1da5df278262d67cfd7576fedea5e9aa}{pow2\+\_\+above}} (n)
\begin{DoxyCompactList}\small\item\em Return the least power-\/of-\/2 that is at least equal to n. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
integer, parameter \mbox{\hyperlink{namespacepmc__util_a0bc01a46ad6e7b0d503c9181b1101ce0}{max\+\_\+units}} = 200
\begin{DoxyCompactList}\small\item\em Maximum number of IO units usable simultaneously. \end{DoxyCompactList}\item 
integer, parameter \mbox{\hyperlink{namespacepmc__util_abd64d09b01c7009bc014bd03950e3318}{unit\+\_\+offset}} = 10
\begin{DoxyCompactList}\small\item\em Minimum unit number to allocate. \end{DoxyCompactList}\item 
logical, dimension(\mbox{\hyperlink{namespacepmc__util_a0bc01a46ad6e7b0d503c9181b1101ce0}{max\+\_\+units}}), save \mbox{\hyperlink{namespacepmc__util_a172ec1eea3cead7645401a0b8c55fcb0}{unit\+\_\+used}} = .false.
\begin{DoxyCompactList}\small\item\em Table of unit numbers storing allocation status. \end{DoxyCompactList}\item 
integer, parameter \mbox{\hyperlink{namespacepmc__util_afd468d26aef28509c08087ba8e59089a}{pmc\+\_\+util\+\_\+convert\+\_\+string\+\_\+len}} = 100
\begin{DoxyCompactList}\small\item\em Length of string for converting numbers. \end{DoxyCompactList}\item 
integer, parameter \mbox{\hyperlink{namespacepmc__util_aca52c78318a6a444ebb5477b532ffeec}{pmc\+\_\+max\+\_\+filename\+\_\+len}} = 300
\begin{DoxyCompactList}\small\item\em Maximum length of filenames. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Common utility subroutines. 

\subsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacepmc__util_abd28fa58b98f202bfa9e4f4bcd3a7608}\label{namespacepmc__util_abd28fa58b98f202bfa9e4f4bcd3a7608}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!air\+\_\+mean\+\_\+free\+\_\+path@{air\+\_\+mean\+\_\+free\+\_\+path}}
\index{air\+\_\+mean\+\_\+free\+\_\+path@{air\+\_\+mean\+\_\+free\+\_\+path}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{air\+\_\+mean\+\_\+free\+\_\+path()}{air\_mean\_free\_path()}}
{\footnotesize\ttfamily real(kind=dp) function pmc\+\_\+util\+::air\+\_\+mean\+\_\+free\+\_\+path (\begin{DoxyParamCaption}\item[{real(kind=dp), intent(in)}]{temp,  }\item[{real(kind=dp), intent(in)}]{pressure }\end{DoxyParamCaption})}



Calculate air molecular mean free path $l$ (m). 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em temp} & Temperature (K).\\
\hline
\mbox{\tt in}  & {\em pressure} & Pressure (Pa). \\
\hline
\end{DoxyParams}


Definition at line 336 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a7bc605f9cb5389d88d233bcecfbfc858}\label{namespacepmc__util_a7bc605f9cb5389d88d233bcecfbfc858}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!almost\+\_\+equal@{almost\+\_\+equal}}
\index{almost\+\_\+equal@{almost\+\_\+equal}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{almost\+\_\+equal()}{almost\_equal()}}
{\footnotesize\ttfamily logical function pmc\+\_\+util\+::almost\+\_\+equal (\begin{DoxyParamCaption}\item[{real(kind=dp), intent(in)}]{d1,  }\item[{real(kind=dp), intent(in)}]{d2,  }\item[{real(kind=dp), intent(in), optional}]{tol }\end{DoxyParamCaption})}



Tests whether two real numbers are almost equal using only a relative tolerance. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em d1} & First number to compare.\\
\hline
\mbox{\tt in}  & {\em d2} & Second number to compare.\\
\hline
\mbox{\tt in}  & {\em tol} & User-\/defined relative tolerance \\
\hline
\end{DoxyParams}
Relative tolerance. 

Definition at line 365 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a5952e4909aad7ccdcdc8ac308c7bf3f8}\label{namespacepmc__util_a5952e4909aad7ccdcdc8ac308c7bf3f8}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!almost\+\_\+equal\+\_\+abs@{almost\+\_\+equal\+\_\+abs}}
\index{almost\+\_\+equal\+\_\+abs@{almost\+\_\+equal\+\_\+abs}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{almost\+\_\+equal\+\_\+abs()}{almost\_equal\_abs()}}
{\footnotesize\ttfamily logical function pmc\+\_\+util\+::almost\+\_\+equal\+\_\+abs (\begin{DoxyParamCaption}\item[{real(kind=dp), intent(in)}]{d1,  }\item[{real(kind=dp), intent(in)}]{d2,  }\item[{real(kind=dp), intent(in)}]{abs\+\_\+tol }\end{DoxyParamCaption})}



Tests whether two real numbers are almost equal using an absolute and relative tolerance. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em d1} & First number to compare.\\
\hline
\mbox{\tt in}  & {\em d2} & Second number to compare.\\
\hline
\mbox{\tt in}  & {\em abs\+\_\+tol} & Tolerance for when d1 equals d2. \\
\hline
\end{DoxyParams}
Relative tolerance. 

Definition at line 396 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a4b6a3270c45469ecd16abc4c2c43e391}\label{namespacepmc__util_a4b6a3270c45469ecd16abc4c2c43e391}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!assert@{assert}}
\index{assert@{assert}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{assert()}{assert()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+util\+::assert (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{code,  }\item[{logical, intent(in)}]{condition\+\_\+ok }\end{DoxyParamCaption})}



Errors unless condition\+\_\+ok is true. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em code} & Status code to use if assertion fails.\\
\hline
\mbox{\tt in}  & {\em condition\+\_\+ok} & Whether the assertion is ok. \\
\hline
\end{DoxyParams}


Definition at line 150 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_ab4f813625900c9949db11067af2224f2}\label{namespacepmc__util_ab4f813625900c9949db11067af2224f2}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!assert\+\_\+msg@{assert\+\_\+msg}}
\index{assert\+\_\+msg@{assert\+\_\+msg}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{assert\+\_\+msg()}{assert\_msg()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+util\+::assert\+\_\+msg (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{code,  }\item[{logical, intent(in)}]{condition\+\_\+ok,  }\item[{character(len=$\ast$), intent(in)}]{error\+\_\+msg }\end{DoxyParamCaption})}



Errors unless condition\+\_\+ok is true. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em code} & Status code to use if assertion fails.\\
\hline
\mbox{\tt in}  & {\em condition\+\_\+ok} & Whether the assertion is ok.\\
\hline
\mbox{\tt in}  & {\em error\+\_\+msg} & Msg if assertion fails. \\
\hline
\end{DoxyParams}


Definition at line 124 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a48e55ceb55e57898081b2b0221caa856}\label{namespacepmc__util_a48e55ceb55e57898081b2b0221caa856}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!average\+\_\+integer@{average\+\_\+integer}}
\index{average\+\_\+integer@{average\+\_\+integer}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{average\+\_\+integer()}{average\_integer()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+util\+::average\+\_\+integer (\begin{DoxyParamCaption}\item[{integer, dimension(\+:), intent(in)}]{int\+\_\+vec,  }\item[{integer, intent(out)}]{int\+\_\+avg }\end{DoxyParamCaption})}



Computes the average of an array of integer numbers. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int\+\_\+vec} & Array of integer numbers.\\
\hline
\mbox{\tt out}  & {\em int\+\_\+avg} & Average of int\+\_\+vec. \\
\hline
\end{DoxyParams}


Definition at line 1045 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a5659f4d2fd9c274756e737639dc30196}\label{namespacepmc__util_a5659f4d2fd9c274756e737639dc30196}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!average\+\_\+real@{average\+\_\+real}}
\index{average\+\_\+real@{average\+\_\+real}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{average\+\_\+real()}{average\_real()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+util\+::average\+\_\+real (\begin{DoxyParamCaption}\item[{real(kind=dp), dimension(\+:), intent(in)}]{real\+\_\+vec,  }\item[{real(kind=dp), intent(out)}]{real\+\_\+avg }\end{DoxyParamCaption})}



Computes the average of an array of real numbers. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em real\+\_\+vec} & Array of real numbers.\\
\hline
\mbox{\tt out}  & {\em real\+\_\+avg} & Average of real\+\_\+vec. \\
\hline
\end{DoxyParams}


Definition at line 1059 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a2c1ad3f0be48f08a1b308538f8d42540}\label{namespacepmc__util_a2c1ad3f0be48f08a1b308538f8d42540}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!check\+\_\+event@{check\+\_\+event}}
\index{check\+\_\+event@{check\+\_\+event}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{check\+\_\+event()}{check\_event()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+util\+::check\+\_\+event (\begin{DoxyParamCaption}\item[{real(kind=dp), intent(in)}]{time,  }\item[{real(kind=dp), intent(in)}]{timestep,  }\item[{real(kind=dp), intent(in)}]{interval,  }\item[{real(kind=dp), intent(inout)}]{last\+\_\+time,  }\item[{logical, intent(out)}]{do\+\_\+event }\end{DoxyParamCaption})}



Computes whether an event is scheduled to take place. 

The events should occur ideally at times 0, interval, 2$\ast$interval, etc. The events are guaranteed to occur at least interval $\ast$ (1 -\/ tolerance) apart, and if at least interval time has passed then the next call is guaranteed to do the event. Otherwise the timestep is used to guess whether to do the event.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em time} & Current time.\\
\hline
\mbox{\tt in}  & {\em timestep} & Estimate of the time to the next call.\\
\hline
\mbox{\tt in}  & {\em interval} & How often the event should be done.\\
\hline
\mbox{\tt in,out}  & {\em last\+\_\+time} & When the event was last done.\\
\hline
\mbox{\tt out}  & {\em do\+\_\+event} & Whether the event should be done. \\
\hline
\end{DoxyParams}
Fuzz for event occurance. 

Definition at line 458 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a479916629132db9682beccf0d90a0113}\label{namespacepmc__util_a479916629132db9682beccf0d90a0113}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!check\+\_\+time\+\_\+multiple@{check\+\_\+time\+\_\+multiple}}
\index{check\+\_\+time\+\_\+multiple@{check\+\_\+time\+\_\+multiple}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{check\+\_\+time\+\_\+multiple()}{check\_time\_multiple()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+util\+::check\+\_\+time\+\_\+multiple (\begin{DoxyParamCaption}\item[{character(len=$\ast$), intent(in)}]{first\+\_\+name,  }\item[{real(kind=dp), intent(in)}]{first\+\_\+time,  }\item[{character(len=$\ast$), intent(in)}]{second\+\_\+name,  }\item[{real(kind=dp), intent(in)}]{second\+\_\+time }\end{DoxyParamCaption})}



Check that the first time interval is close to an integer multiple of the second, and warn if it is not. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em first\+\_\+name} & Name of the first time variable.\\
\hline
\mbox{\tt in}  & {\em first\+\_\+time} & First time variable (s).\\
\hline
\mbox{\tt in}  & {\em second\+\_\+name} & Name of the second time variable.\\
\hline
\mbox{\tt in}  & {\em second\+\_\+time} & Second time variable (s). \\
\hline
\end{DoxyParams}


Definition at line 427 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_ac91736b4f44a1623208ebe7f161e84ad}\label{namespacepmc__util_ac91736b4f44a1623208ebe7f161e84ad}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!close\+\_\+file@{close\+\_\+file}}
\index{close\+\_\+file@{close\+\_\+file}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{close\+\_\+file()}{close\_file()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+util\+::close\+\_\+file (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{unit }\end{DoxyParamCaption})}



Close a file and de-\/assign the unit. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em unit} & Unit to close. \\
\hline
\end{DoxyParams}


Definition at line 273 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a1c459fd59d9acef65849cc5fd388d386}\label{namespacepmc__util_a1c459fd59d9acef65849cc5fd388d386}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!complex\+\_\+to\+\_\+string@{complex\+\_\+to\+\_\+string}}
\index{complex\+\_\+to\+\_\+string@{complex\+\_\+to\+\_\+string}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{complex\+\_\+to\+\_\+string()}{complex\_to\_string()}}
{\footnotesize\ttfamily character(len=\mbox{\hyperlink{namespacepmc__util_afd468d26aef28509c08087ba8e59089a}{pmc\+\_\+util\+\_\+convert\+\_\+string\+\_\+len}}) function pmc\+\_\+util\+::complex\+\_\+to\+\_\+string (\begin{DoxyParamCaption}\item[{complex(kind=dc), intent(in)}]{val }\end{DoxyParamCaption})}



Convert a complex to a string format. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em val} & Value to convert. \\
\hline
\end{DoxyParams}


Definition at line 869 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a46d994b9563ad325253e528f983cb3cc}\label{namespacepmc__util_a46d994b9563ad325253e528f983cb3cc}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!deg2rad@{deg2rad}}
\index{deg2rad@{deg2rad}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{deg2rad()}{deg2rad()}}
{\footnotesize\ttfamily real(kind=dp) function pmc\+\_\+util\+::deg2rad (\begin{DoxyParamCaption}\item[{real(kind=dp), intent(in)}]{deg }\end{DoxyParamCaption})}



Convert degrees to radians. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em deg} & Input degrees. \\
\hline
\end{DoxyParams}


Definition at line 1318 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_ab0ce0deb86bd2e48734d7e654e5c3b18}\label{namespacepmc__util_ab0ce0deb86bd2e48734d7e654e5c3b18}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!diam2rad@{diam2rad}}
\index{diam2rad@{diam2rad}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{diam2rad()}{diam2rad()}}
{\footnotesize\ttfamily real(kind=dp) elemental function pmc\+\_\+util\+::diam2rad (\begin{DoxyParamCaption}\item[{real(kind=dp), intent(in)}]{d }\end{DoxyParamCaption})}



Convert diameter (m) to radius (m). 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em d} & Diameter (m). \\
\hline
\end{DoxyParams}


Definition at line 324 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_ae2f8c4238f51e70e793d1572c823fef6}\label{namespacepmc__util_ae2f8c4238f51e70e793d1572c823fef6}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!die@{die}}
\index{die@{die}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{die()}{die()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+util\+::die (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{code }\end{DoxyParamCaption})}



Error immediately. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em code} & Status code to use if assertion fails. \\
\hline
\end{DoxyParams}


Definition at line 169 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_aa6e9ef9e9da5f7b7f100405b86c74316}\label{namespacepmc__util_aa6e9ef9e9da5f7b7f100405b86c74316}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!die\+\_\+msg@{die\+\_\+msg}}
\index{die\+\_\+msg@{die\+\_\+msg}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{die\+\_\+msg()}{die\_msg()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+util\+::die\+\_\+msg (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{code,  }\item[{character(len=$\ast$), intent(in)}]{error\+\_\+msg }\end{DoxyParamCaption})}



Error immediately. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em code} & Status code to use if assertion fails.\\
\hline
\mbox{\tt in}  & {\em error\+\_\+msg} & Msg if assertion fails. \\
\hline
\end{DoxyParams}


Definition at line 181 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a0cf0527cde4f90e88c216b51686de71d}\label{namespacepmc__util_a0cf0527cde4f90e88c216b51686de71d}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!ensure\+\_\+integer\+\_\+array\+\_\+2d\+\_\+size@{ensure\+\_\+integer\+\_\+array\+\_\+2d\+\_\+size}}
\index{ensure\+\_\+integer\+\_\+array\+\_\+2d\+\_\+size@{ensure\+\_\+integer\+\_\+array\+\_\+2d\+\_\+size}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{ensure\+\_\+integer\+\_\+array\+\_\+2d\+\_\+size()}{ensure\_integer\_array\_2d\_size()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+util\+::ensure\+\_\+integer\+\_\+array\+\_\+2d\+\_\+size (\begin{DoxyParamCaption}\item[{integer, dimension(\+:, \+:), intent(inout), allocatable}]{x,  }\item[{integer, intent(in)}]{n1,  }\item[{integer, intent(in)}]{n2,  }\item[{logical, intent(in), optional}]{only\+\_\+grow }\end{DoxyParamCaption})}



Allocate or reallocate the given array to ensure it is of the given size, preserving any data and/or initializing to 0. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em x} & Array of integer numbers.\\
\hline
\mbox{\tt in}  & {\em n1} & Desired first size of array.\\
\hline
\mbox{\tt in}  & {\em n2} & Desired second size of array.\\
\hline
\mbox{\tt in}  & {\em only\+\_\+grow} & Whether to only increase the array size (default .true.). \\
\hline
\end{DoxyParams}


Definition at line 1200 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_adbf9a41092ec1df9139a6f149b644102}\label{namespacepmc__util_adbf9a41092ec1df9139a6f149b644102}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!ensure\+\_\+integer\+\_\+array\+\_\+size@{ensure\+\_\+integer\+\_\+array\+\_\+size}}
\index{ensure\+\_\+integer\+\_\+array\+\_\+size@{ensure\+\_\+integer\+\_\+array\+\_\+size}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{ensure\+\_\+integer\+\_\+array\+\_\+size()}{ensure\_integer\_array\_size()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+util\+::ensure\+\_\+integer\+\_\+array\+\_\+size (\begin{DoxyParamCaption}\item[{integer, dimension(\+:), intent(inout), allocatable}]{x,  }\item[{integer, intent(in)}]{n,  }\item[{logical, intent(in), optional}]{only\+\_\+grow }\end{DoxyParamCaption})}



Allocate or reallocate the given array to ensure it is of the given size, preserving any data and/or initializing to 0. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em x} & Array of integer numbers.\\
\hline
\mbox{\tt in}  & {\em n} & Desired size of array.\\
\hline
\mbox{\tt in}  & {\em only\+\_\+grow} & Whether to only increase the array size (default .true.). \\
\hline
\end{DoxyParams}


Definition at line 1166 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a26a0550006c522169b83c4f9c9df69d1}\label{namespacepmc__util_a26a0550006c522169b83c4f9c9df69d1}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!ensure\+\_\+real\+\_\+array\+\_\+2d\+\_\+size@{ensure\+\_\+real\+\_\+array\+\_\+2d\+\_\+size}}
\index{ensure\+\_\+real\+\_\+array\+\_\+2d\+\_\+size@{ensure\+\_\+real\+\_\+array\+\_\+2d\+\_\+size}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{ensure\+\_\+real\+\_\+array\+\_\+2d\+\_\+size()}{ensure\_real\_array\_2d\_size()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+util\+::ensure\+\_\+real\+\_\+array\+\_\+2d\+\_\+size (\begin{DoxyParamCaption}\item[{real(kind=dp), dimension(\+:, \+:), intent(inout), allocatable}]{x,  }\item[{integer, intent(in)}]{n1,  }\item[{integer, intent(in)}]{n2,  }\item[{logical, intent(in), optional}]{only\+\_\+grow }\end{DoxyParamCaption})}



Allocate or reallocate the given array to ensure it is of the given size, preserving any data and/or initializing to 0. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em x} & Array of real numbers.\\
\hline
\mbox{\tt in}  & {\em n1} & Desired first size of array.\\
\hline
\mbox{\tt in}  & {\em n2} & Desired second size of array.\\
\hline
\mbox{\tt in}  & {\em only\+\_\+grow} & Whether to only increase the array size (default .true.). \\
\hline
\end{DoxyParams}


Definition at line 1126 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_ad5e823b848ba95bfd29d67f1cfee7a7a}\label{namespacepmc__util_ad5e823b848ba95bfd29d67f1cfee7a7a}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!ensure\+\_\+real\+\_\+array\+\_\+size@{ensure\+\_\+real\+\_\+array\+\_\+size}}
\index{ensure\+\_\+real\+\_\+array\+\_\+size@{ensure\+\_\+real\+\_\+array\+\_\+size}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{ensure\+\_\+real\+\_\+array\+\_\+size()}{ensure\_real\_array\_size()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+util\+::ensure\+\_\+real\+\_\+array\+\_\+size (\begin{DoxyParamCaption}\item[{real(kind=dp), dimension(\+:), intent(inout), allocatable}]{x,  }\item[{integer, intent(in)}]{n,  }\item[{logical, intent(in), optional}]{only\+\_\+grow }\end{DoxyParamCaption})}



Allocate or reallocate the given array to ensure it is of the given size, preserving any data and/or initializing to 0. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em x} & Array of real numbers.\\
\hline
\mbox{\tt in}  & {\em n} & Desired size of array.\\
\hline
\mbox{\tt in}  & {\em only\+\_\+grow} & Whether to only increase the array size (default .true.). \\
\hline
\end{DoxyParams}


Definition at line 1092 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a61a37625f7eff4bd4bbba002652b596d}\label{namespacepmc__util_a61a37625f7eff4bd4bbba002652b596d}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!ensure\+\_\+string\+\_\+array\+\_\+size@{ensure\+\_\+string\+\_\+array\+\_\+size}}
\index{ensure\+\_\+string\+\_\+array\+\_\+size@{ensure\+\_\+string\+\_\+array\+\_\+size}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{ensure\+\_\+string\+\_\+array\+\_\+size()}{ensure\_string\_array\_size()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+util\+::ensure\+\_\+string\+\_\+array\+\_\+size (\begin{DoxyParamCaption}\item[{character(len=$\ast$), dimension(\+:), intent(inout), allocatable}]{x,  }\item[{integer, intent(in)}]{n }\end{DoxyParamCaption})}



Allocate or reallocate the given array to ensure it is of the given size, without preserving data. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em x} & Array of strings numbers.\\
\hline
\mbox{\tt in}  & {\em n} & Desired size of array. \\
\hline
\end{DoxyParams}


Definition at line 1240 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_af9bd7e3317d4574c2f4633e5f77df142}\label{namespacepmc__util_af9bd7e3317d4574c2f4633e5f77df142}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!entropy@{entropy}}
\index{entropy@{entropy}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{entropy()}{entropy()}}
{\footnotesize\ttfamily real(kind=dp) function pmc\+\_\+util\+::entropy (\begin{DoxyParamCaption}\item[{real(kind=dp), dimension(\+:), intent(in)}]{p }\end{DoxyParamCaption})}



Compute the entropy of a probability mass function (non necessarily normalized). 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em p} & Probability mass function, will be normalized before use. \\
\hline
\end{DoxyParams}


Definition at line 1683 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_ac91afc829f34ff168c29ebd00f560cb2}\label{namespacepmc__util_ac91afc829f34ff168c29ebd00f560cb2}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!find\+\_\+1d@{find\+\_\+1d}}
\index{find\+\_\+1d@{find\+\_\+1d}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{find\+\_\+1d()}{find\_1d()}}
{\footnotesize\ttfamily integer function pmc\+\_\+util\+::find\+\_\+1d (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{n,  }\item[{real(kind=dp), dimension(n), intent(in)}]{x\+\_\+vals,  }\item[{real(kind=dp), intent(in)}]{x }\end{DoxyParamCaption})}



Find the position of a real number in an arbitrary 1D array. 

Takes an array of x\+\_\+vals, and a single x value, and returns the position p such that x\+\_\+vals(p) $<$= x $<$ x\+\_\+vals(p+1). If p == 0 then x $<$ x\+\_\+vals(1) and if p == n then x\+\_\+vals(n) $<$= x. x\+\_\+vals must be sorted in increasing order.

If the array is known to be linearly or logarithmically spaced then \mbox{\hyperlink{namespacepmc__util_a1d5f058ff11d51e9083950422757e8b7}{linspace\+\_\+find()}} or \mbox{\hyperlink{namespacepmc__util_a8679b1591949031ddac4234e457fe048}{logspace\+\_\+find()}} will be much faster.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em n} & Number of values.\\
\hline
\mbox{\tt in}  & {\em x\+\_\+vals} & X value array, must be sorted.\\
\hline
\mbox{\tt in}  & {\em x} & Value to interpolate at. \\
\hline
\end{DoxyParams}


Definition at line 643 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a74557f04ac600442864bec92848b4550}\label{namespacepmc__util_a74557f04ac600442864bec92848b4550}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!free\+\_\+unit@{free\+\_\+unit}}
\index{free\+\_\+unit@{free\+\_\+unit}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{free\+\_\+unit()}{free\_unit()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+util\+::free\+\_\+unit (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{unit }\end{DoxyParamCaption})}



Frees a unit number returned by \mbox{\hyperlink{namespacepmc__util_a76442600ebd1117db2a8db91d73f7737}{get\+\_\+unit()}}. 



Definition at line 219 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a4a6576eb74e7fb0c14d7190b44b62c5c}\label{namespacepmc__util_a4a6576eb74e7fb0c14d7190b44b62c5c}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!get\+\_\+basename@{get\+\_\+basename}}
\index{get\+\_\+basename@{get\+\_\+basename}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{get\+\_\+basename()}{get\_basename()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+util\+::get\+\_\+basename (\begin{DoxyParamCaption}\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{character(len=$\ast$), intent(out)}]{basename }\end{DoxyParamCaption})}



Strip the extension to find the basename. 

The filename is assumed to be of the form basename.\+extension, where extension contains no periods. If there is no period in filename then basename is the whole filename.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em filename} & Full filename.\\
\hline
\mbox{\tt out}  & {\em basename} & Basename. \\
\hline
\end{DoxyParams}


Definition at line 1265 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a76442600ebd1117db2a8db91d73f7737}\label{namespacepmc__util_a76442600ebd1117db2a8db91d73f7737}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!get\+\_\+unit@{get\+\_\+unit}}
\index{get\+\_\+unit@{get\+\_\+unit}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{get\+\_\+unit()}{get\_unit()}}
{\footnotesize\ttfamily integer function pmc\+\_\+util\+::get\+\_\+unit (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Returns an available unit number. This should be freed by \mbox{\hyperlink{namespacepmc__util_a74557f04ac600442864bec92848b4550}{free\+\_\+unit()}}. 



Definition at line 195 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_ae5311f9f48ddfa5b7c24658526276621}\label{namespacepmc__util_ae5311f9f48ddfa5b7c24658526276621}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!harmonic\+\_\+mean@{harmonic\+\_\+mean}}
\index{harmonic\+\_\+mean@{harmonic\+\_\+mean}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{harmonic\+\_\+mean()}{harmonic\_mean()}}
{\footnotesize\ttfamily elemental real(kind=dp) function pmc\+\_\+util\+::harmonic\+\_\+mean (\begin{DoxyParamCaption}\item[{real(kind=dp), intent(in)}]{x1,  }\item[{real(kind=dp), intent(in)}]{x2 }\end{DoxyParamCaption})}



Compute the harmonic mean of two numbers. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em x1} & First number to average.\\
\hline
\mbox{\tt in}  & {\em x2} & Second number to average. \\
\hline
\end{DoxyParams}


Definition at line 1652 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a32c8275ed718fa49d7ebd55eca41ef70}\label{namespacepmc__util_a32c8275ed718fa49d7ebd55eca41ef70}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!integer\+\_\+sort@{integer\+\_\+sort}}
\index{integer\+\_\+sort@{integer\+\_\+sort}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{integer\+\_\+sort()}{integer\_sort()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+util\+::integer\+\_\+sort (\begin{DoxyParamCaption}\item[{integer, dimension(\+:), intent(inout)}]{data,  }\item[{integer, dimension(size(data)), intent(out)}]{perm }\end{DoxyParamCaption})}



Sort the given data array and return the permutation defining the sort. 

If {\ttfamily data} is the original data array, {\ttfamily new\+\_\+data} is the sorted value of data, and {\ttfamily perm} is the returned permutation, then {\ttfamily new\+\_\+data(i) = data(perm(i))}.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em data} & Data array to sort, sorted on exit.\\
\hline
\mbox{\tt out}  & {\em perm} & Permutation defining the sort\+: {\ttfamily new\+\_\+data(i) = data(perm(i))}. \\
\hline
\end{DoxyParams}


Definition at line 1346 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_ab5a72413552c4a653ddafc47e28a2f14}\label{namespacepmc__util_ab5a72413552c4a653ddafc47e28a2f14}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!integer\+\_\+to\+\_\+string@{integer\+\_\+to\+\_\+string}}
\index{integer\+\_\+to\+\_\+string@{integer\+\_\+to\+\_\+string}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{integer\+\_\+to\+\_\+string()}{integer\_to\_string()}}
{\footnotesize\ttfamily character(len=\mbox{\hyperlink{namespacepmc__util_afd468d26aef28509c08087ba8e59089a}{pmc\+\_\+util\+\_\+convert\+\_\+string\+\_\+len}}) function pmc\+\_\+util\+::integer\+\_\+to\+\_\+string (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{val }\end{DoxyParamCaption})}



Convert an integer to a string format. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em val} & Value to convert. \\
\hline
\end{DoxyParams}


Definition at line 817 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a702884cdee8fa1da41a3bf8b460c95d3}\label{namespacepmc__util_a702884cdee8fa1da41a3bf8b460c95d3}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!integer\+\_\+to\+\_\+string\+\_\+max\+\_\+len@{integer\+\_\+to\+\_\+string\+\_\+max\+\_\+len}}
\index{integer\+\_\+to\+\_\+string\+\_\+max\+\_\+len@{integer\+\_\+to\+\_\+string\+\_\+max\+\_\+len}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{integer\+\_\+to\+\_\+string\+\_\+max\+\_\+len()}{integer\_to\_string\_max\_len()}}
{\footnotesize\ttfamily character(len=\mbox{\hyperlink{namespacepmc__util_afd468d26aef28509c08087ba8e59089a}{pmc\+\_\+util\+\_\+convert\+\_\+string\+\_\+len}}) function pmc\+\_\+util\+::integer\+\_\+to\+\_\+string\+\_\+max\+\_\+len (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{val,  }\item[{integer, intent(in)}]{max\+\_\+len }\end{DoxyParamCaption})}



Convert an integer to a string format of maximum length. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em val} & Value to convert.\\
\hline
\mbox{\tt in}  & {\em max\+\_\+len} & Maximum length of resulting string. \\
\hline
\end{DoxyParams}


Definition at line 887 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_aa7405c9d93fafa02adb9b51f7a8acadf}\label{namespacepmc__util_aa7405c9d93fafa02adb9b51f7a8acadf}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!interp\+\_\+1d@{interp\+\_\+1d}}
\index{interp\+\_\+1d@{interp\+\_\+1d}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{interp\+\_\+1d()}{interp\_1d()}}
{\footnotesize\ttfamily real(kind=dp) function pmc\+\_\+util\+::interp\+\_\+1d (\begin{DoxyParamCaption}\item[{real(kind=dp), dimension(\+:), intent(in)}]{x\+\_\+vals,  }\item[{real(kind=dp), dimension(size(x\+\_\+vals)), intent(in)}]{y\+\_\+vals,  }\item[{real(kind=dp), intent(in)}]{x }\end{DoxyParamCaption})}



1D linear interpolation. 

Takes an array of x and y, and a single x value, and returns the corresponding y using linear interpolation. x\+\_\+vals must be sorted.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em x\+\_\+vals} & X value array, must be sorted.\\
\hline
\mbox{\tt in}  & {\em y\+\_\+vals} & Y value array.\\
\hline
\mbox{\tt in}  & {\em x} & Value to interpolate at. \\
\hline
\end{DoxyParams}


Definition at line 677 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a6b98d6e94a23e0223f1e78ee4cbdca64}\label{namespacepmc__util_a6b98d6e94a23e0223f1e78ee4cbdca64}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!interp\+\_\+linear\+\_\+disc@{interp\+\_\+linear\+\_\+disc}}
\index{interp\+\_\+linear\+\_\+disc@{interp\+\_\+linear\+\_\+disc}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{interp\+\_\+linear\+\_\+disc()}{interp\_linear\_disc()}}
{\footnotesize\ttfamily real(kind=dp) function pmc\+\_\+util\+::interp\+\_\+linear\+\_\+disc (\begin{DoxyParamCaption}\item[{real(kind=dp), intent(in)}]{x\+\_\+1,  }\item[{real(kind=dp), intent(in)}]{x\+\_\+n,  }\item[{integer, intent(in)}]{n,  }\item[{integer, intent(in)}]{i }\end{DoxyParamCaption})}



Linear interpolation over discrete indices. 

Takes real values {\ttfamily x\+\_\+1} and {\ttfamily x\+\_\+n} and integers {\ttfamily n} and {\ttfamily i} and returns the linear interpolation so that {\ttfamily x\+\_\+1} is returned when {\ttfamily i} = 1 and {\ttfamily x\+\_\+n} is returned when {\ttfamily i} = {\ttfamily n}.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em x\+\_\+1} & Value of {\ttfamily x} when {\ttfamily i} = 1.\\
\hline
\mbox{\tt in}  & {\em x\+\_\+n} & Value of {\ttfamily x} when {\ttfamily i} = n.\\
\hline
\mbox{\tt in}  & {\em n} & Number of points to interpolate over.\\
\hline
\mbox{\tt in}  & {\em i} & Index to interpolate at. \\
\hline
\end{DoxyParams}


Definition at line 714 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_aac8c9feb22730857691a4de7b68a041f}\label{namespacepmc__util_aac8c9feb22730857691a4de7b68a041f}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!iso8601\+\_\+date\+\_\+and\+\_\+time@{iso8601\+\_\+date\+\_\+and\+\_\+time}}
\index{iso8601\+\_\+date\+\_\+and\+\_\+time@{iso8601\+\_\+date\+\_\+and\+\_\+time}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{iso8601\+\_\+date\+\_\+and\+\_\+time()}{iso8601\_date\_and\_time()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+util\+::iso8601\+\_\+date\+\_\+and\+\_\+time (\begin{DoxyParamCaption}\item[{character(len=$\ast$), intent(out)}]{date\+\_\+time }\end{DoxyParamCaption})}



Current date and time in I\+SO 8601 format. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em date\+\_\+time} & Result string. \\
\hline
\end{DoxyParams}


Definition at line 1298 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a173493cd6763f490fd73dcc0d3ae701b}\label{namespacepmc__util_a173493cd6763f490fd73dcc0d3ae701b}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!linspace@{linspace}}
\index{linspace@{linspace}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{linspace()}{linspace()}}
{\footnotesize\ttfamily real(kind=dp) function, dimension(\+:), allocatable pmc\+\_\+util\+::linspace (\begin{DoxyParamCaption}\item[{real(kind=dp), intent(in)}]{min\+\_\+x,  }\item[{real(kind=dp), intent(in)}]{max\+\_\+x,  }\item[{integer, intent(in)}]{n }\end{DoxyParamCaption})}



Makes a linearly spaced array from min to max. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em min\+\_\+x} & Minimum array value.\\
\hline
\mbox{\tt in}  & {\em max\+\_\+x} & Maximum array value.\\
\hline
\mbox{\tt in}  & {\em n} & Length of array to create.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Return value. 
\end{DoxyReturn}


Definition at line 511 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a1d5f058ff11d51e9083950422757e8b7}\label{namespacepmc__util_a1d5f058ff11d51e9083950422757e8b7}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!linspace\+\_\+find@{linspace\+\_\+find}}
\index{linspace\+\_\+find@{linspace\+\_\+find}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{linspace\+\_\+find()}{linspace\_find()}}
{\footnotesize\ttfamily integer function pmc\+\_\+util\+::linspace\+\_\+find (\begin{DoxyParamCaption}\item[{real(kind=dp), intent(in)}]{min\+\_\+x,  }\item[{real(kind=dp), intent(in)}]{max\+\_\+x,  }\item[{integer, intent(in)}]{n,  }\item[{real(kind=dp), intent(in)}]{x }\end{DoxyParamCaption})}



Find the position of a real number in a 1D linear array. 

If xa is the array allocated by linspace(min\+\_\+x, max\+\_\+x, xa) then i = linspace\+\_\+find(min\+\_\+x, max\+\_\+x, n, x) returns the index i satisfying xa(i) $<$= x $<$ xa(i+1) for min\+\_\+x $<$= x $<$ max\+\_\+x. If x == max\+\_\+x then i = n -\/ 1. If x $>$ max\+\_\+x then i = n. If x $<$ min\+\_\+x then i = 0. Thus 0 $<$= i $<$= n. Here n is the length of xa.

This is equivalent to using \mbox{\hyperlink{namespacepmc__util_ac91afc829f34ff168c29ebd00f560cb2}{find\+\_\+1d()}} but much faster if the array is linear.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em min\+\_\+x} & Minimum array value.\\
\hline
\mbox{\tt in}  & {\em max\+\_\+x} & Maximum array value.\\
\hline
\mbox{\tt in}  & {\em n} & Number of entries.\\
\hline
\mbox{\tt in}  & {\em x} & Value. \\
\hline
\end{DoxyParams}


Definition at line 583 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a89e25708a94945ec739408bceef13762}\label{namespacepmc__util_a89e25708a94945ec739408bceef13762}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!loadtxt@{loadtxt}}
\index{loadtxt@{loadtxt}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{loadtxt()}{loadtxt()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+util\+::loadtxt (\begin{DoxyParamCaption}\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{real(kind=dp), dimension(\+:,\+:), intent(inout), allocatable}]{data }\end{DoxyParamCaption})}



Load a real array from a text file. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em filename} & Filename to read from.\\
\hline
\mbox{\tt in,out}  & {\em data} & Array to store data in. \\
\hline
\end{DoxyParams}


Definition at line 1386 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a92e778281860ee189704e0f1f2c19e86}\label{namespacepmc__util_a92e778281860ee189704e0f1f2c19e86}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!logical\+\_\+to\+\_\+string@{logical\+\_\+to\+\_\+string}}
\index{logical\+\_\+to\+\_\+string@{logical\+\_\+to\+\_\+string}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{logical\+\_\+to\+\_\+string()}{logical\_to\_string()}}
{\footnotesize\ttfamily character(len=\mbox{\hyperlink{namespacepmc__util_afd468d26aef28509c08087ba8e59089a}{pmc\+\_\+util\+\_\+convert\+\_\+string\+\_\+len}}) function pmc\+\_\+util\+::logical\+\_\+to\+\_\+string (\begin{DoxyParamCaption}\item[{logical, intent(in)}]{val }\end{DoxyParamCaption})}



Convert a logical to a string format. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em val} & Value to convert. \\
\hline
\end{DoxyParams}


Definition at line 849 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_aaa2f79250374df571d379d895ceb7a71}\label{namespacepmc__util_aaa2f79250374df571d379d895ceb7a71}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!logspace@{logspace}}
\index{logspace@{logspace}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{logspace()}{logspace()}}
{\footnotesize\ttfamily real(kind=dp) function, dimension(\+:), allocatable pmc\+\_\+util\+::logspace (\begin{DoxyParamCaption}\item[{real(kind=dp), intent(in)}]{min\+\_\+x,  }\item[{real(kind=dp), intent(in)}]{max\+\_\+x,  }\item[{integer, intent(in)}]{n }\end{DoxyParamCaption})}



Makes a logarithmically spaced array of length n from min to max. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em min\+\_\+x} & Minimum array value.\\
\hline
\mbox{\tt in}  & {\em max\+\_\+x} & Maximum array value.\\
\hline
\mbox{\tt in}  & {\em n} & Length of array to create.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Return value. 
\end{DoxyReturn}


Definition at line 543 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a8679b1591949031ddac4234e457fe048}\label{namespacepmc__util_a8679b1591949031ddac4234e457fe048}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!logspace\+\_\+find@{logspace\+\_\+find}}
\index{logspace\+\_\+find@{logspace\+\_\+find}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{logspace\+\_\+find()}{logspace\_find()}}
{\footnotesize\ttfamily integer function pmc\+\_\+util\+::logspace\+\_\+find (\begin{DoxyParamCaption}\item[{real(kind=dp), intent(in)}]{min\+\_\+x,  }\item[{real(kind=dp), intent(in)}]{max\+\_\+x,  }\item[{integer, intent(in)}]{n,  }\item[{real(kind=dp), intent(in)}]{x }\end{DoxyParamCaption})}



Find the position of a real number in a 1D logarithmic array. 

If xa is the array allocated by logspace(min\+\_\+x, max\+\_\+x, xa) then i = logspace\+\_\+find(min\+\_\+x, max\+\_\+x, n, x) returns the index i satisfying xa(i) $<$= x $<$ xa(i+1) for min\+\_\+x $<$= x $<$ max\+\_\+x. If x $>$= max\+\_\+x then i = n. If x $<$ min\+\_\+x then i = 0. Thus 0 $<$= i $<$= n. Here n is the length of xa.

This is equivalent to using \mbox{\hyperlink{namespacepmc__util_ac91afc829f34ff168c29ebd00f560cb2}{find\+\_\+1d()}} but much faster if the array is logarithmic.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em min\+\_\+x} & Minimum array value.\\
\hline
\mbox{\tt in}  & {\em max\+\_\+x} & Maximum array value.\\
\hline
\mbox{\tt in}  & {\em n} & Number of entries.\\
\hline
\mbox{\tt in}  & {\em x} & Value. \\
\hline
\end{DoxyParams}


Definition at line 617 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a95ad9c9ce574477325505b3e913917cb}\label{namespacepmc__util_a95ad9c9ce574477325505b3e913917cb}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!nplogp@{nplogp}}
\index{nplogp@{nplogp}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{nplogp()}{nplogp()}}
{\footnotesize\ttfamily elemental real(kind=dp) function pmc\+\_\+util\+::nplogp (\begin{DoxyParamCaption}\item[{real(kind=dp), intent(in)}]{p }\end{DoxyParamCaption})}



Compute $ - p \ln p$ for computing entropy. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em p} & Probability $p$. \\
\hline
\end{DoxyParams}


Definition at line 1666 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_aee3183d5ad7cf9bf38f966a4aecee252}\label{namespacepmc__util_aee3183d5ad7cf9bf38f966a4aecee252}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!open\+\_\+file\+\_\+read@{open\+\_\+file\+\_\+read}}
\index{open\+\_\+file\+\_\+read@{open\+\_\+file\+\_\+read}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{open\+\_\+file\+\_\+read()}{open\_file\_read()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+util\+::open\+\_\+file\+\_\+read (\begin{DoxyParamCaption}\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{integer, intent(out)}]{unit }\end{DoxyParamCaption})}



Open a file for reading with an automatically assigned unit and test that it succeeds. The file should be closed with \mbox{\hyperlink{namespacepmc__util_ac91736b4f44a1623208ebe7f161e84ad}{close\+\_\+file()}}. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em filename} & Filename to open.\\
\hline
\mbox{\tt out}  & {\em unit} & Unit assigned to file. \\
\hline
\end{DoxyParams}


Definition at line 232 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_ab49e2a7d4958cc13e35bb5982d378da5}\label{namespacepmc__util_ab49e2a7d4958cc13e35bb5982d378da5}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!open\+\_\+file\+\_\+write@{open\+\_\+file\+\_\+write}}
\index{open\+\_\+file\+\_\+write@{open\+\_\+file\+\_\+write}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{open\+\_\+file\+\_\+write()}{open\_file\_write()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+util\+::open\+\_\+file\+\_\+write (\begin{DoxyParamCaption}\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{integer, intent(out)}]{unit }\end{DoxyParamCaption})}



Open a file for writing with an automatically assigned unit and test that it succeeds. The file should be closed with \mbox{\hyperlink{namespacepmc__util_ac91736b4f44a1623208ebe7f161e84ad}{close\+\_\+file()}}. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em filename} & Filename to open.\\
\hline
\mbox{\tt out}  & {\em unit} & Unit assigned to file. \\
\hline
\end{DoxyParams}


Definition at line 253 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a1da5df278262d67cfd7576fedea5e9aa}\label{namespacepmc__util_a1da5df278262d67cfd7576fedea5e9aa}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!pow2\+\_\+above@{pow2\+\_\+above}}
\index{pow2\+\_\+above@{pow2\+\_\+above}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{pow2\+\_\+above()}{pow2\_above()}}
{\footnotesize\ttfamily integer function pmc\+\_\+util\+::pow2\+\_\+above (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{n }\end{DoxyParamCaption})}



Return the least power-\/of-\/2 that is at least equal to n. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em n} & Lower bound on the power of 2. \\
\hline
\end{DoxyParams}


Definition at line 1695 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_aee025b9d181017a7c928195ae1148b27}\label{namespacepmc__util_aee025b9d181017a7c928195ae1148b27}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!rad2deg@{rad2deg}}
\index{rad2deg@{rad2deg}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{rad2deg()}{rad2deg()}}
{\footnotesize\ttfamily real(kind=dp) function pmc\+\_\+util\+::rad2deg (\begin{DoxyParamCaption}\item[{real(kind=dp), intent(in)}]{rad }\end{DoxyParamCaption})}



Convert radians to degrees. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em rad} & Input radians. \\
\hline
\end{DoxyParams}


Definition at line 1330 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a69ab911167fab93d371e42476e9aac73}\label{namespacepmc__util_a69ab911167fab93d371e42476e9aac73}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!rad2diam@{rad2diam}}
\index{rad2diam@{rad2diam}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{rad2diam()}{rad2diam()}}
{\footnotesize\ttfamily real(kind=dp) elemental function pmc\+\_\+util\+::rad2diam (\begin{DoxyParamCaption}\item[{real(kind=dp), intent(in)}]{r }\end{DoxyParamCaption})}



Convert radius (m) to diameter (m). 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em r} & Radius (m). \\
\hline
\end{DoxyParams}


Definition at line 299 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_ad88e1503acea1e8e33d13275f37b9755}\label{namespacepmc__util_ad88e1503acea1e8e33d13275f37b9755}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!read\+\_\+char\+\_\+raw@{read\+\_\+char\+\_\+raw}}
\index{read\+\_\+char\+\_\+raw@{read\+\_\+char\+\_\+raw}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{read\+\_\+char\+\_\+raw()}{read\_char\_raw()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+util\+::read\+\_\+char\+\_\+raw (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{unit,  }\item[{character, intent(out)}]{char,  }\item[{logical, intent(out)}]{eol,  }\item[{logical, intent(out)}]{eof }\end{DoxyParamCaption})}



Read a single character from a file, signaling if we have hit end-\/of-\/line (E\+OL) or end-\/of-\/file (E\+OF). If E\+OL or E\+OF are true then the character value should be ignored. 

Testing with gfortran 4.\+5.\+3 and different length files shows\+:

Empty file (total file length 0)\+:
\begin{DoxyItemize}
\item eol = .false., eof = .true.
\item subsequent calls error
\end{DoxyItemize}

File containing a single \textquotesingle{}A\textquotesingle{} character (total file length 1)\+:
\begin{DoxyItemize}
\item char = \textquotesingle{}A\textquotesingle{}, eol = .false., eof = .false.
\item eol = .false., eof = .true.
\item subsequent calls error
\end{DoxyItemize}

File containing a single newline \textquotesingle{}~\newline
\textquotesingle{} (total file length 1)\+:
\begin{DoxyItemize}
\item eol = .true., eof = .false.
\item eol = .false., eof = .true.
\item subsequent calls error
\end{DoxyItemize}

File containing a character and newline \textquotesingle{}A~\newline
\textquotesingle{} (total file length 2)\+:
\begin{DoxyItemize}
\item char = \textquotesingle{}A\textquotesingle{}, eol = .false., eof = .false.
\item eol = .true., eof = .false.
\item eol = .false., eof = .true.
\item subsequent calls error
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em unit} & Unit number to read from.\\
\hline
\mbox{\tt out}  & {\em char} & Character read.\\
\hline
\mbox{\tt out}  & {\em eol} & True if at E\+OL (end of line).\\
\hline
\mbox{\tt out}  & {\em eof} & True if at E\+OF (end of file). \\
\hline
\end{DoxyParams}


Definition at line 1541 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_aa8ba2bc88e899084afec8b5d7f3a8b92}\label{namespacepmc__util_aa8ba2bc88e899084afec8b5d7f3a8b92}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!read\+\_\+word\+\_\+raw@{read\+\_\+word\+\_\+raw}}
\index{read\+\_\+word\+\_\+raw@{read\+\_\+word\+\_\+raw}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{read\+\_\+word\+\_\+raw()}{read\_word\_raw()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+util\+::read\+\_\+word\+\_\+raw (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{unit,  }\item[{character(len=$\ast$), intent(out)}]{word,  }\item[{logical, intent(out)}]{eol,  }\item[{logical, intent(out)}]{eof }\end{DoxyParamCaption})}



Read a white-\/space delimited word from a file, signaling if we have E\+OL or E\+OF. If E\+OL or E\+OF are true then the word will still be meaningful data. If there was no data to be read then len(word) will be 0. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em unit} & Unit number to read from.\\
\hline
\mbox{\tt out}  & {\em word} & Word read.\\
\hline
\mbox{\tt out}  & {\em eol} & True if at E\+OL (end of line).\\
\hline
\mbox{\tt out}  & {\em eof} & True if at E\+OF (end of file). \\
\hline
\end{DoxyParams}


Definition at line 1585 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a5f80ccbbb2709c6f8458a1f7742aa549}\label{namespacepmc__util_a5f80ccbbb2709c6f8458a1f7742aa549}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!real\+\_\+to\+\_\+string@{real\+\_\+to\+\_\+string}}
\index{real\+\_\+to\+\_\+string@{real\+\_\+to\+\_\+string}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{real\+\_\+to\+\_\+string()}{real\_to\_string()}}
{\footnotesize\ttfamily character(len=\mbox{\hyperlink{namespacepmc__util_afd468d26aef28509c08087ba8e59089a}{pmc\+\_\+util\+\_\+convert\+\_\+string\+\_\+len}}) function pmc\+\_\+util\+::real\+\_\+to\+\_\+string (\begin{DoxyParamCaption}\item[{real(kind=dp), intent(in)}]{val }\end{DoxyParamCaption})}



Convert a real to a string format. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em val} & Value to convert. \\
\hline
\end{DoxyParams}


Definition at line 833 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a25918c31f5ac5a5497993883e1206308}\label{namespacepmc__util_a25918c31f5ac5a5497993883e1206308}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!real\+\_\+to\+\_\+string\+\_\+max\+\_\+len@{real\+\_\+to\+\_\+string\+\_\+max\+\_\+len}}
\index{real\+\_\+to\+\_\+string\+\_\+max\+\_\+len@{real\+\_\+to\+\_\+string\+\_\+max\+\_\+len}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{real\+\_\+to\+\_\+string\+\_\+max\+\_\+len()}{real\_to\_string\_max\_len()}}
{\footnotesize\ttfamily character(len=\mbox{\hyperlink{namespacepmc__util_afd468d26aef28509c08087ba8e59089a}{pmc\+\_\+util\+\_\+convert\+\_\+string\+\_\+len}}) function pmc\+\_\+util\+::real\+\_\+to\+\_\+string\+\_\+max\+\_\+len (\begin{DoxyParamCaption}\item[{real(kind=dp), intent(in)}]{val,  }\item[{integer, intent(in)}]{max\+\_\+len }\end{DoxyParamCaption})}



Convert a real to a string format of maximum length. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em val} & Value to convert.\\
\hline
\mbox{\tt in}  & {\em max\+\_\+len} & Maximum length of resulting string. \\
\hline
\end{DoxyParams}


Definition at line 908 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_ae3535489875ec1ba14b921bd43cff11c}\label{namespacepmc__util_ae3535489875ec1ba14b921bd43cff11c}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!reallocate\+\_\+real\+\_\+array2d@{reallocate\+\_\+real\+\_\+array2d}}
\index{reallocate\+\_\+real\+\_\+array2d@{reallocate\+\_\+real\+\_\+array2d}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{reallocate\+\_\+real\+\_\+array2d()}{reallocate\_real\_array2d()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+util\+::reallocate\+\_\+real\+\_\+array2d (\begin{DoxyParamCaption}\item[{real(kind=dp), dimension(\+:,\+:), intent(inout), allocatable}]{data,  }\item[{integer, intent(in)}]{rows,  }\item[{integer, intent(in)}]{cols }\end{DoxyParamCaption})}



Reallocate a 2D real array to the given size, preserving the contents. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em data} & Array to reallocate.\\
\hline
\mbox{\tt in}  & {\em rows} & New leading dimension.\\
\hline
\mbox{\tt in}  & {\em cols} & New trailing dimension. \\
\hline
\end{DoxyParams}


Definition at line 1493 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a22ca26ff282a9278ae95f877cb999786}\label{namespacepmc__util_a22ca26ff282a9278ae95f877cb999786}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!savetxt\+\_\+1d@{savetxt\+\_\+1d}}
\index{savetxt\+\_\+1d@{savetxt\+\_\+1d}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{savetxt\+\_\+1d()}{savetxt\_1d()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+util\+::savetxt\+\_\+1d (\begin{DoxyParamCaption}\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{real(kind=dp), dimension(\+:), intent(in)}]{data }\end{DoxyParamCaption})}



Write a real 1D array to a text file. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em filename} & Filename to write to.\\
\hline
\mbox{\tt in}  & {\em data} & Array of data to write. \\
\hline
\end{DoxyParams}


Definition at line 1450 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a136a49845a94549788f385e2c0f625a6}\label{namespacepmc__util_a136a49845a94549788f385e2c0f625a6}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!savetxt\+\_\+2d@{savetxt\+\_\+2d}}
\index{savetxt\+\_\+2d@{savetxt\+\_\+2d}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{savetxt\+\_\+2d()}{savetxt\_2d()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+util\+::savetxt\+\_\+2d (\begin{DoxyParamCaption}\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{real(kind=dp), dimension(\+:,\+:), intent(in)}]{data }\end{DoxyParamCaption})}



Write a real 2D array to a text file. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em filename} & Filename to write to.\\
\hline
\mbox{\tt in}  & {\em data} & Array of data to write. \\
\hline
\end{DoxyParams}


Definition at line 1470 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a30ef7112d68a812b3022046e0f3a40be}\label{namespacepmc__util_a30ef7112d68a812b3022046e0f3a40be}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!sphere\+\_\+rad2vol@{sphere\+\_\+rad2vol}}
\index{sphere\+\_\+rad2vol@{sphere\+\_\+rad2vol}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{sphere\+\_\+rad2vol()}{sphere\_rad2vol()}}
{\footnotesize\ttfamily real(kind=dp) elemental function pmc\+\_\+util\+::sphere\+\_\+rad2vol (\begin{DoxyParamCaption}\item[{real(kind=dp), intent(in)}]{r }\end{DoxyParamCaption})}



Convert geometric radius $R_{\rm geo}$ (m) to mass-\/equivalent volume $V$ (m$^\wedge$3) for spherical particles. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em r} & Geometric radius (m). \\
\hline
\end{DoxyParams}


Definition at line 312 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_af905c1127f64dd471808b872022ed632}\label{namespacepmc__util_af905c1127f64dd471808b872022ed632}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!sphere\+\_\+vol2rad@{sphere\+\_\+vol2rad}}
\index{sphere\+\_\+vol2rad@{sphere\+\_\+vol2rad}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{sphere\+\_\+vol2rad()}{sphere\_vol2rad()}}
{\footnotesize\ttfamily real(kind=dp) elemental function pmc\+\_\+util\+::sphere\+\_\+vol2rad (\begin{DoxyParamCaption}\item[{real(kind=dp), intent(in)}]{v }\end{DoxyParamCaption})}



Convert mass-\/equivalent volume $V$ (m$^\wedge$3) to geometric radius $R_{\rm geo}$ (m) for spherical particles. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em v} & Particle mass-\/equivalent volume (m$^\wedge$3). \\
\hline
\end{DoxyParams}


Definition at line 287 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a397fa3e495a78638d8abfdb798d632f0}\label{namespacepmc__util_a397fa3e495a78638d8abfdb798d632f0}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!starts\+\_\+with@{starts\+\_\+with}}
\index{starts\+\_\+with@{starts\+\_\+with}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{starts\+\_\+with()}{starts\_with()}}
{\footnotesize\ttfamily logical function pmc\+\_\+util\+::starts\+\_\+with (\begin{DoxyParamCaption}\item[{character(len=$\ast$), intent(in)}]{string,  }\item[{character(len=$\ast$), intent(in)}]{start\+\_\+string }\end{DoxyParamCaption})}



Checks whether a string starts with a given other string. 

{\ttfamily starts\+\_\+with(\+A, B)} returns {\ttfamily true} if string {\ttfamily A} starts with string {\ttfamily B}.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em string} & String to test.\\
\hline
\mbox{\tt in}  & {\em start\+\_\+string} & Starting string. \\
\hline
\end{DoxyParams}


Definition at line 1630 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a20346c4da2a25e5b8a3215240e851e5f}\label{namespacepmc__util_a20346c4da2a25e5b8a3215240e851e5f}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!string\+\_\+array\+\_\+find@{string\+\_\+array\+\_\+find}}
\index{string\+\_\+array\+\_\+find@{string\+\_\+array\+\_\+find}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{string\+\_\+array\+\_\+find()}{string\_array\_find()}}
{\footnotesize\ttfamily integer function pmc\+\_\+util\+::string\+\_\+array\+\_\+find (\begin{DoxyParamCaption}\item[{character(len=$\ast$), dimension(\+:), intent(in)}]{array,  }\item[{character(len=$\ast$), intent(in)}]{val }\end{DoxyParamCaption})}



Return the index of the first occurance of the given value in the array, or 0 if it is not present. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em array} & Array of values.\\
\hline
\mbox{\tt in}  & {\em val} & Value to find. \\
\hline
\end{DoxyParams}


Definition at line 1074 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a8fc2639b0e044d6e575027b5394061aa}\label{namespacepmc__util_a8fc2639b0e044d6e575027b5394061aa}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!string\+\_\+t\+\_\+constructor@{string\+\_\+t\+\_\+constructor}}
\index{string\+\_\+t\+\_\+constructor@{string\+\_\+t\+\_\+constructor}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{string\+\_\+t\+\_\+constructor()}{string\_t\_constructor()}}
{\footnotesize\ttfamily type(\mbox{\hyperlink{structpmc__util_1_1string__t}{string\+\_\+t}}) function, pointer pmc\+\_\+util\+::string\+\_\+t\+\_\+constructor (\begin{DoxyParamCaption}\item[{character(len=\+:), intent(in), allocatable}]{val }\end{DoxyParamCaption})}



Constructor for \mbox{\hyperlink{structpmc__util_1_1string__t}{string\+\_\+t}}. 

\begin{DoxyReturn}{Returns}
A new string
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em val} & String value \\
\hline
\end{DoxyParams}


Definition at line 57 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a25291e39623c22ba97600388d04ef7a0}\label{namespacepmc__util_a25291e39623c22ba97600388d04ef7a0}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!string\+\_\+t\+\_\+finalize@{string\+\_\+t\+\_\+finalize}}
\index{string\+\_\+t\+\_\+finalize@{string\+\_\+t\+\_\+finalize}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{string\+\_\+t\+\_\+finalize()}{string\_t\_finalize()}}
{\footnotesize\ttfamily elemental subroutine pmc\+\_\+util\+::string\+\_\+t\+\_\+finalize (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structpmc__util_1_1string__t}{string\+\_\+t}}), intent(inout)}]{this }\end{DoxyParamCaption})}



Finalize a string object. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em this} & String \\
\hline
\end{DoxyParams}


Definition at line 72 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_aa4e6c3a50b7def19b9ce4cf85a0816ca}\label{namespacepmc__util_aa4e6c3a50b7def19b9ce4cf85a0816ca}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!string\+\_\+to\+\_\+integer@{string\+\_\+to\+\_\+integer}}
\index{string\+\_\+to\+\_\+integer@{string\+\_\+to\+\_\+integer}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{string\+\_\+to\+\_\+integer()}{string\_to\_integer()}}
{\footnotesize\ttfamily integer function pmc\+\_\+util\+::string\+\_\+to\+\_\+integer (\begin{DoxyParamCaption}\item[{character(len=$\ast$), intent(in)}]{string }\end{DoxyParamCaption})}



Convert a string to an integer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em string} & String to convert. \\
\hline
\end{DoxyParams}


Definition at line 739 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_addbacdfdd34c9190924403097f717ab4}\label{namespacepmc__util_addbacdfdd34c9190924403097f717ab4}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!string\+\_\+to\+\_\+logical@{string\+\_\+to\+\_\+logical}}
\index{string\+\_\+to\+\_\+logical@{string\+\_\+to\+\_\+logical}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{string\+\_\+to\+\_\+logical()}{string\_to\_logical()}}
{\footnotesize\ttfamily logical function pmc\+\_\+util\+::string\+\_\+to\+\_\+logical (\begin{DoxyParamCaption}\item[{character(len=$\ast$), intent(in)}]{string }\end{DoxyParamCaption})}



Convert a string to a logical. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em string} & String to convert. \\
\hline
\end{DoxyParams}


Definition at line 784 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a1d18d4c7adea4978d104517da57995ef}\label{namespacepmc__util_a1d18d4c7adea4978d104517da57995ef}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!string\+\_\+to\+\_\+real@{string\+\_\+to\+\_\+real}}
\index{string\+\_\+to\+\_\+real@{string\+\_\+to\+\_\+real}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{string\+\_\+to\+\_\+real()}{string\_to\_real()}}
{\footnotesize\ttfamily real(kind=dp) function pmc\+\_\+util\+::string\+\_\+to\+\_\+real (\begin{DoxyParamCaption}\item[{character(len=$\ast$), intent(in)}]{string }\end{DoxyParamCaption})}



Convert a string to a real. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em string} & String to convert. \\
\hline
\end{DoxyParams}


Definition at line 762 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_aa8c823006029e4a59872cb3f1e14bc70}\label{namespacepmc__util_aa8c823006029e4a59872cb3f1e14bc70}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!time\+\_\+to\+\_\+string\+\_\+max\+\_\+len@{time\+\_\+to\+\_\+string\+\_\+max\+\_\+len}}
\index{time\+\_\+to\+\_\+string\+\_\+max\+\_\+len@{time\+\_\+to\+\_\+string\+\_\+max\+\_\+len}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{time\+\_\+to\+\_\+string\+\_\+max\+\_\+len()}{time\_to\_string\_max\_len()}}
{\footnotesize\ttfamily character(len=\mbox{\hyperlink{namespacepmc__util_afd468d26aef28509c08087ba8e59089a}{pmc\+\_\+util\+\_\+convert\+\_\+string\+\_\+len}}) function pmc\+\_\+util\+::time\+\_\+to\+\_\+string\+\_\+max\+\_\+len (\begin{DoxyParamCaption}\item[{real(kind=dp), intent(in)}]{time,  }\item[{integer, intent(in)}]{max\+\_\+len }\end{DoxyParamCaption})}



Convert a time to a string format of maximum length. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em time} & Time to convert (s).\\
\hline
\mbox{\tt in}  & {\em max\+\_\+len} & Maximum length of resulting string. \\
\hline
\end{DoxyParams}


Definition at line 963 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a90ce2db27a1927738cbef385c5f6decb}\label{namespacepmc__util_a90ce2db27a1927738cbef385c5f6decb}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!vec\+\_\+cts\+\_\+to\+\_\+disc@{vec\+\_\+cts\+\_\+to\+\_\+disc}}
\index{vec\+\_\+cts\+\_\+to\+\_\+disc@{vec\+\_\+cts\+\_\+to\+\_\+disc}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{vec\+\_\+cts\+\_\+to\+\_\+disc()}{vec\_cts\_to\_disc()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+util\+::vec\+\_\+cts\+\_\+to\+\_\+disc (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{n,  }\item[{real(kind=dp), dimension(n), intent(in)}]{vec\+\_\+cts,  }\item[{integer, intent(in)}]{n\+\_\+samp,  }\item[{integer, dimension(n), intent(out)}]{vec\+\_\+disc }\end{DoxyParamCaption})}



Convert a real-\/valued vector into an integer-\/valued vector. 

Use n\+\_\+samp samples. Returns discrete vector whose relative entry sizes are $ \ell_1 $ closest to the continuous vector.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em n} & Number of entries in vectors.\\
\hline
\mbox{\tt in}  & {\em vec\+\_\+cts} & Continuous vector.\\
\hline
\mbox{\tt in}  & {\em n\+\_\+samp} & Number of discrete samples to use.\\
\hline
\mbox{\tt out}  & {\em vec\+\_\+disc} & Discretized vector. \\
\hline
\end{DoxyParams}


Definition at line 1004 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_aca11f4bf2897a638ee7035dcc39e7524}\label{namespacepmc__util_aca11f4bf2897a638ee7035dcc39e7524}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!warn\+\_\+assert\+\_\+msg@{warn\+\_\+assert\+\_\+msg}}
\index{warn\+\_\+assert\+\_\+msg@{warn\+\_\+assert\+\_\+msg}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{warn\+\_\+assert\+\_\+msg()}{warn\_assert\_msg()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+util\+::warn\+\_\+assert\+\_\+msg (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{code,  }\item[{logical, intent(in)}]{condition\+\_\+ok,  }\item[{character(len=$\ast$), intent(in)}]{warning\+\_\+msg }\end{DoxyParamCaption})}



Prints a warning message if condition\+\_\+ok is false. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em code} & Status code to use.\\
\hline
\mbox{\tt in}  & {\em condition\+\_\+ok} & Whether the assertion is ok.\\
\hline
\mbox{\tt in}  & {\em warning\+\_\+msg} & Message to display. \\
\hline
\end{DoxyParams}


Definition at line 106 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a249b73ad660e5e17ec4e4ad2ff743546}\label{namespacepmc__util_a249b73ad660e5e17ec4e4ad2ff743546}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!warn\+\_\+msg@{warn\+\_\+msg}}
\index{warn\+\_\+msg@{warn\+\_\+msg}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{warn\+\_\+msg()}{warn\_msg()}}
{\footnotesize\ttfamily subroutine pmc\+\_\+util\+::warn\+\_\+msg (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{code,  }\item[{character(len=$\ast$), intent(in)}]{warning\+\_\+msg,  }\item[{logical, intent(inout), optional}]{already\+\_\+warned }\end{DoxyParamCaption})}



Prints a warning message. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em code} & Status code to use.\\
\hline
\mbox{\tt in}  & {\em warning\+\_\+msg} & Message to display.\\
\hline
\mbox{\tt in,out}  & {\em already\+\_\+warned} & Flag to control warning only once (should be a save variable). \\
\hline
\end{DoxyParams}


Definition at line 84 of file util.\+F90.



\subsection{Variable Documentation}
\mbox{\Hypertarget{namespacepmc__util_a0bc01a46ad6e7b0d503c9181b1101ce0}\label{namespacepmc__util_a0bc01a46ad6e7b0d503c9181b1101ce0}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!max\+\_\+units@{max\+\_\+units}}
\index{max\+\_\+units@{max\+\_\+units}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{max\+\_\+units}{max\_units}}
{\footnotesize\ttfamily integer, parameter pmc\+\_\+util\+::max\+\_\+units = 200}



Maximum number of IO units usable simultaneously. 



Definition at line 20 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_aca52c78318a6a444ebb5477b532ffeec}\label{namespacepmc__util_aca52c78318a6a444ebb5477b532ffeec}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!pmc\+\_\+max\+\_\+filename\+\_\+len@{pmc\+\_\+max\+\_\+filename\+\_\+len}}
\index{pmc\+\_\+max\+\_\+filename\+\_\+len@{pmc\+\_\+max\+\_\+filename\+\_\+len}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{pmc\+\_\+max\+\_\+filename\+\_\+len}{pmc\_max\_filename\_len}}
{\footnotesize\ttfamily integer, parameter pmc\+\_\+util\+::pmc\+\_\+max\+\_\+filename\+\_\+len = 300}



Maximum length of filenames. 



Definition at line 29 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_afd468d26aef28509c08087ba8e59089a}\label{namespacepmc__util_afd468d26aef28509c08087ba8e59089a}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!pmc\+\_\+util\+\_\+convert\+\_\+string\+\_\+len@{pmc\+\_\+util\+\_\+convert\+\_\+string\+\_\+len}}
\index{pmc\+\_\+util\+\_\+convert\+\_\+string\+\_\+len@{pmc\+\_\+util\+\_\+convert\+\_\+string\+\_\+len}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{pmc\+\_\+util\+\_\+convert\+\_\+string\+\_\+len}{pmc\_util\_convert\_string\_len}}
{\footnotesize\ttfamily integer, parameter pmc\+\_\+util\+::pmc\+\_\+util\+\_\+convert\+\_\+string\+\_\+len = 100}



Length of string for converting numbers. 



Definition at line 27 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_abd64d09b01c7009bc014bd03950e3318}\label{namespacepmc__util_abd64d09b01c7009bc014bd03950e3318}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!unit\+\_\+offset@{unit\+\_\+offset}}
\index{unit\+\_\+offset@{unit\+\_\+offset}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{unit\+\_\+offset}{unit\_offset}}
{\footnotesize\ttfamily integer, parameter pmc\+\_\+util\+::unit\+\_\+offset = 10}



Minimum unit number to allocate. 



Definition at line 22 of file util.\+F90.

\mbox{\Hypertarget{namespacepmc__util_a172ec1eea3cead7645401a0b8c55fcb0}\label{namespacepmc__util_a172ec1eea3cead7645401a0b8c55fcb0}} 
\index{pmc\+\_\+util@{pmc\+\_\+util}!unit\+\_\+used@{unit\+\_\+used}}
\index{unit\+\_\+used@{unit\+\_\+used}!pmc\+\_\+util@{pmc\+\_\+util}}
\subsubsection{\texorpdfstring{unit\+\_\+used}{unit\_used}}
{\footnotesize\ttfamily logical, dimension(\mbox{\hyperlink{namespacepmc__util_a0bc01a46ad6e7b0d503c9181b1101ce0}{max\+\_\+units}}), save pmc\+\_\+util\+::unit\+\_\+used = .false.}



Table of unit numbers storing allocation status. 



Definition at line 24 of file util.\+F90.

