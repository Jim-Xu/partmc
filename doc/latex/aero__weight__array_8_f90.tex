\hypertarget{aero__weight__array_8_f90}{}\section{aero\+\_\+weight\+\_\+array.\+F90 File Reference}
\label{aero__weight__array_8_f90}\index{aero\+\_\+weight\+\_\+array.\+F90@{aero\+\_\+weight\+\_\+array.\+F90}}


The \mbox{\hyperlink{namespacepmc__aero__weight__array}{pmc\+\_\+aero\+\_\+weight\+\_\+array}} module.  


\subsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
type \mbox{\hyperlink{structpmc__aero__weight__array_1_1aero__weight__array__t}{pmc\+\_\+aero\+\_\+weight\+\_\+array\+::aero\+\_\+weight\+\_\+array\+\_\+t}}
\begin{DoxyCompactList}\small\item\em An array of aerosol size distribution weighting functions. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Modules}
\begin{DoxyCompactItemize}
\item 
module \mbox{\hyperlink{namespacepmc__aero__weight__array}{pmc\+\_\+aero\+\_\+weight\+\_\+array}}
\begin{DoxyCompactList}\small\item\em The \mbox{\hyperlink{structpmc__aero__weight__array_1_1aero__weight__array__t}{aero\+\_\+weight\+\_\+array\+\_\+t}} structure and associated subroutines. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__weight__array_ae550d4421da58c4fa79291f274881c13}{pmc\+\_\+aero\+\_\+weight\+\_\+array\+::aero\+\_\+weight\+\_\+array\+\_\+set\+\_\+sizes}} (aero\+\_\+weight\+\_\+array, n\+\_\+group, n\+\_\+class)
\begin{DoxyCompactList}\small\item\em Sets the number of weight groups and classes. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__weight__array_a4886dd503446783dd264db9c8986d38f}{pmc\+\_\+aero\+\_\+weight\+\_\+array\+::aero\+\_\+weight\+\_\+array\+\_\+set\+\_\+flat}} (aero\+\_\+weight\+\_\+array, n\+\_\+class)
\begin{DoxyCompactList}\small\item\em Allocates an {\ttfamily aero\+\_\+weight\+\_\+array} as flat weightings. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__weight__array_acee7592ccd5029f699596be244cbef2e}{pmc\+\_\+aero\+\_\+weight\+\_\+array\+::aero\+\_\+weight\+\_\+array\+\_\+set\+\_\+power}} (aero\+\_\+weight\+\_\+array, n\+\_\+class, exponent)
\begin{DoxyCompactList}\small\item\em Allocates an {\ttfamily aero\+\_\+weight\+\_\+array} as power weightings. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__weight__array_a98611587acf3064873a39d6cd128d4c8}{pmc\+\_\+aero\+\_\+weight\+\_\+array\+::aero\+\_\+weight\+\_\+array\+\_\+set\+\_\+nummass}} (aero\+\_\+weight\+\_\+array, n\+\_\+class)
\begin{DoxyCompactList}\small\item\em Allocates an {\ttfamily aero\+\_\+weight\+\_\+array} as joint flat/power-\/3 weightings.. \end{DoxyCompactList}\item 
elemental subroutine \mbox{\hyperlink{namespacepmc__aero__weight__array_a4faf647ac7900cdcac273e4167e8e088}{pmc\+\_\+aero\+\_\+weight\+\_\+array\+::aero\+\_\+weight\+\_\+array\+\_\+normalize}} (aero\+\_\+weight\+\_\+array)
\begin{DoxyCompactList}\small\item\em Normalizes the {\ttfamily aero\+\_\+weight\+\_\+array} to a non-\/zero value. \end{DoxyCompactList}\item 
integer function \mbox{\hyperlink{namespacepmc__aero__weight__array_ac03a66965bebb2e5b699f16acc021962}{pmc\+\_\+aero\+\_\+weight\+\_\+array\+::aero\+\_\+weight\+\_\+array\+\_\+n\+\_\+group}} (aero\+\_\+weight\+\_\+array)
\begin{DoxyCompactList}\small\item\em Return the number of weight groups. \end{DoxyCompactList}\item 
integer function \mbox{\hyperlink{namespacepmc__aero__weight__array_a51061757ff964272d7375d50a99d07a7}{pmc\+\_\+aero\+\_\+weight\+\_\+array\+::aero\+\_\+weight\+\_\+array\+\_\+n\+\_\+class}} (aero\+\_\+weight\+\_\+array)
\begin{DoxyCompactList}\small\item\em Return the number of weight classes. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__weight__array_a5ecd5778c018848c999ef89b28f5940f}{pmc\+\_\+aero\+\_\+weight\+\_\+array\+::aero\+\_\+weight\+\_\+array\+\_\+scale}} (aero\+\_\+weight\+\_\+array, factor)
\begin{DoxyCompactList}\small\item\em Scale the weights by the given factor, so {\ttfamily new\+\_\+weight = old\+\_\+weight $\ast$ factor}. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__weight__array_ac29cb102e3495fadc37eca9347b519b5}{pmc\+\_\+aero\+\_\+weight\+\_\+array\+::aero\+\_\+weight\+\_\+array\+\_\+combine}} (aero\+\_\+weight\+\_\+array, aero\+\_\+weight\+\_\+array\+\_\+delta)
\begin{DoxyCompactList}\small\item\em Combine {\ttfamily aero\+\_\+weight\+\_\+array\+\_\+delta} into {\ttfamily aero\+\_\+weight\+\_\+array} with a harmonic mean. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__weight__array_ab91ec24f000d4b6503e6817a84f2da11}{pmc\+\_\+aero\+\_\+weight\+\_\+array\+::aero\+\_\+weight\+\_\+array\+\_\+shift}} (aero\+\_\+weight\+\_\+array\+\_\+from, aero\+\_\+weight\+\_\+array\+\_\+to, sample\+\_\+prop, overwrite\+\_\+to)
\begin{DoxyCompactList}\small\item\em Adjust source and destination weights to reflect moving {\ttfamily sample\+\_\+prop} proportion of particles from {\ttfamily aero\+\_\+weight\+\_\+array\+\_\+from} to {\ttfamily aero\+\_\+weight\+\_\+array\+\_\+to}. \end{DoxyCompactList}\item 
real(kind=dp) function \mbox{\hyperlink{namespacepmc__aero__weight__array_adb38b8169574f5d8e3fa131ccdf1dcb4}{pmc\+\_\+aero\+\_\+weight\+\_\+array\+::aero\+\_\+weight\+\_\+array\+\_\+single\+\_\+num\+\_\+conc}} (aero\+\_\+weight\+\_\+array, aero\+\_\+particle, aero\+\_\+data)
\begin{DoxyCompactList}\small\item\em Compute the number concentration for a particle (m$^\wedge$\{-\/3\}). \end{DoxyCompactList}\item 
real(kind=dp) function \mbox{\hyperlink{namespacepmc__aero__weight__array_a8a39b084f2952ba5f1068eadac2c48ed}{pmc\+\_\+aero\+\_\+weight\+\_\+array\+::aero\+\_\+weight\+\_\+array\+\_\+num\+\_\+conc\+\_\+at\+\_\+radius}} (aero\+\_\+weight\+\_\+array, i\+\_\+class, radius)
\begin{DoxyCompactList}\small\item\em Compute the total number concentration at a given radius (m$^\wedge$3). \end{DoxyCompactList}\item 
real(kind=dp) function \mbox{\hyperlink{namespacepmc__aero__weight__array_a58a8646015dbbed5447fe415353b8e29}{pmc\+\_\+aero\+\_\+weight\+\_\+array\+::aero\+\_\+weight\+\_\+array\+\_\+num\+\_\+conc}} (aero\+\_\+weight\+\_\+array, aero\+\_\+particle, aero\+\_\+data)
\begin{DoxyCompactList}\small\item\em Compute the number concentration for a particle (m$^\wedge$\{-\/3\}). \end{DoxyCompactList}\item 
logical function \mbox{\hyperlink{namespacepmc__aero__weight__array_ad145b87a8e1a71fda62dadb01b4cff39}{pmc\+\_\+aero\+\_\+weight\+\_\+array\+::aero\+\_\+weight\+\_\+array\+\_\+check\+\_\+flat}} (aero\+\_\+weight\+\_\+array)
\begin{DoxyCompactList}\small\item\em Check whether a given aero\+\_\+weight array is flat in total. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__weight__array_aad4535065f56a39ce8da5717f0c334fd}{pmc\+\_\+aero\+\_\+weight\+\_\+array\+::aero\+\_\+weight\+\_\+array\+\_\+check\+\_\+monotonicity}} (aero\+\_\+weight\+\_\+array, monotone\+\_\+increasing, monotone\+\_\+decreasing)
\begin{DoxyCompactList}\small\item\em Determine whether all weight functions in an array are monotone increasing, monotone decreasing, or neither. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__weight__array_a3a1055fc4a1be729c0b32fc114ddffd2}{pmc\+\_\+aero\+\_\+weight\+\_\+array\+::aero\+\_\+weight\+\_\+array\+\_\+minmax\+\_\+num\+\_\+conc}} (aero\+\_\+weight\+\_\+array, i\+\_\+class, radius\+\_\+1, radius\+\_\+2, num\+\_\+conc\+\_\+min, num\+\_\+conc\+\_\+max)
\begin{DoxyCompactList}\small\item\em Compute the maximum and minimum number concentrations between the given radii. \end{DoxyCompactList}\item 
integer function \mbox{\hyperlink{namespacepmc__aero__weight__array_a0a5faf6c66a3b2e8bddd70ac19db2927}{pmc\+\_\+aero\+\_\+weight\+\_\+array\+::aero\+\_\+weight\+\_\+array\+\_\+rand\+\_\+group}} (aero\+\_\+weight\+\_\+array, i\+\_\+class, radius)
\begin{DoxyCompactList}\small\item\em Choose a random group at the given radius, with probability inversely proportional to group weight at that radius. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__weight__array_a9bc50db61d65311b62b7bae73bf7c917}{pmc\+\_\+aero\+\_\+weight\+\_\+array\+::spec\+\_\+file\+\_\+read\+\_\+aero\+\_\+weight\+\_\+array}} (file, aero\+\_\+weight\+\_\+array)
\begin{DoxyCompactList}\small\item\em Read an aero\+\_\+weight\+\_\+array from a spec file. \end{DoxyCompactList}\item 
integer function \mbox{\hyperlink{namespacepmc__aero__weight__array_a1fe03c483b391b7fa2d7201b3868f9b8}{pmc\+\_\+aero\+\_\+weight\+\_\+array\+::pmc\+\_\+mpi\+\_\+pack\+\_\+size\+\_\+aero\+\_\+weight\+\_\+array}} (val)
\begin{DoxyCompactList}\small\item\em Determines the number of bytes required to pack the given value. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__weight__array_a0e7bdd9d7cf073e1d57c331a46a90d3a}{pmc\+\_\+aero\+\_\+weight\+\_\+array\+::pmc\+\_\+mpi\+\_\+pack\+\_\+aero\+\_\+weight\+\_\+array}} (buffer, position, val)
\begin{DoxyCompactList}\small\item\em Packs the given value into the buffer, advancing position. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__weight__array_a8f07bda93e7ef86eb3f39034f8b8e5f2}{pmc\+\_\+aero\+\_\+weight\+\_\+array\+::pmc\+\_\+mpi\+\_\+unpack\+\_\+aero\+\_\+weight\+\_\+array}} (buffer, position, val)
\begin{DoxyCompactList}\small\item\em Unpacks the given value from the buffer, advancing position. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__weight__array_a7b61181ea630c3bf41cf13124c206226}{pmc\+\_\+aero\+\_\+weight\+\_\+array\+::aero\+\_\+weight\+\_\+netcdf\+\_\+dim\+\_\+aero\+\_\+weight\+\_\+group}} (aero\+\_\+weight\+\_\+array, \mbox{\hyperlink{fractal_8_f90_a4e89f3f850921ff84a6dfce8b166ad50}{ncid}}, dimid\+\_\+aero\+\_\+weight\+\_\+group)
\begin{DoxyCompactList}\small\item\em Write the {\ttfamily aero\+\_\+weight\+\_\+group} dimension to the given Net\+C\+DF file if it is not already present and in any case return the associated dimid. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__weight__array_a2a35954eccffa6d2706b58fe27dde736}{pmc\+\_\+aero\+\_\+weight\+\_\+array\+::aero\+\_\+weight\+\_\+netcdf\+\_\+dim\+\_\+aero\+\_\+weight\+\_\+class}} (aero\+\_\+weight\+\_\+array, \mbox{\hyperlink{fractal_8_f90_a4e89f3f850921ff84a6dfce8b166ad50}{ncid}}, dimid\+\_\+aero\+\_\+weight\+\_\+class)
\begin{DoxyCompactList}\small\item\em Write the {\ttfamily aero\+\_\+weight\+\_\+class} dimension to the given Net\+C\+DF file if it is not already present and in any case return the associated dimid. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacepmc__aero__weight__array_a11210bfed165f0953131f08759fca5a0}{pmc\+\_\+aero\+\_\+weight\+\_\+array\+::aero\+\_\+weight\+\_\+array\+\_\+input\+\_\+netcdf}} (aero\+\_\+weight\+\_\+array, \mbox{\hyperlink{fractal_8_f90_a4e89f3f850921ff84a6dfce8b166ad50}{ncid}})
\begin{DoxyCompactList}\small\item\em Read full aero\+\_\+weight\+\_\+array. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
The \mbox{\hyperlink{namespacepmc__aero__weight__array}{pmc\+\_\+aero\+\_\+weight\+\_\+array}} module. 

